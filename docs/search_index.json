[["index.html", "公共经济学中的计量方法及应用 序言", " 公共经济学中的计量方法及应用 叶兵 2023年夏 序言 本书的写作动机 国内本科计量经济学教学和研究严重脱节。这不是说研究高深莫测，超出了本科生的理解范围。实际上，计量经济学研究用到的主流的方法并不难理解。 市面上不乏好的计量经济学教材，如伍德里奇（2015）、斯托克和沃森（2012）、安格里斯特和皮施克（2012）。但这些书内容芜杂，涉及到过多的数学，侧重理论，涉及应用较少。 实有必要写这样一本书：内容可控，数学尽量简单，本科生容易理解，学习后能读懂大部分应用计量文章，并能开展简单的研究。这是本书的写作目的。 本书最贴合的目标对象是公共经济学的本科生，因为书中举的大部分例子属于公共经济学领域。但由于经济学各子学科所用计量方法实无太大的差异，本书也能满足经济学大类本科生的要求。 前置知识 本书的前置知识包括《概率论与数理统计》《统计学》《财政学》《公共支出管理》等课程的知识。本书也会对涉及到的知识做简要回顾。 本书的内容 各章目次如下： 章序号 章名 第1章 导论 第2章 二元线性回归 第3章 多元线性回归：估计 第4章 多元线性回归：统计推断 第5章 定性信息 第6章 清晰断点回归 第7章 机制和异质性分析 第8章 一致性 第9章 模型误设 第10章 面板数据模型：计量方法及应用 第11章 基于面板数据的双重差分法：计量方法及应用 第12章 工具变量法：计量方法及应用 第13章 专题：政府支出 第14章 专题：政府收入 第15章 专题：政府间关系（并模糊断点回归） 第16章 其他公共经济学问题 本书分为两部分。第一部分讲当前公共经济学领域应用计量研究中最流行的几种方法。在讲方法的时候穿插应用。在这部分，作者大量采取拿来主义的做法，凡在文献中已经有很好的表述的，只提供一个指向该文献的指针，以示对原作者知识产权的尊重。只有那些在文献中找不到表述，或文献中表述不适合本科生的，才提供完整的文本。 第二部分以专题的形式讲这些计量方法在公共经济学中的应用。 两部分所涉及应用，作者通过讲解一流（中）英文杂志上公共经济学领域的文章说明。 软件实现 本书既名《公共经济学中的计量方法及应用》，就强调应用，要求学生能够利用专业的计量软件Stata估计各计量模型。为此，我们录制了配套视频（见“配套资源”部分），循序渐进地教读者使用Stata进行相关操作。 读者还可以通过以下渠道学习Stata： 利用Stata帮助文档 翻阅：陈强. 计量经济学及Stata应用[M]. 高等教育出版社, 2015 向AI提问 参考教材 伍德里奇. 计量经济学导论(第五版)[M]. 中国人民大学出版社, 2015. 斯托克, 沃森. 计量经济学(第三版)[J]. 格致出版社, 2012. 安格里斯特, 皮施克. 基本无害的计量经济学：实证研究者指南[M]. 格致出版社, 2012. 配套资源 历年授课资料 叶兵 2023年夏于紫东 "],["intro.html", "第 1 章 导论 1.1 相关和因果关系 1.2 估计总体均值 1.3 计量经济学的性质与经济数据 1.4 数学知识复习", " 第 1 章 导论 1.1 相关和因果关系 （1）相关关系和因果关系的定义与对比 What is Correlation? Ansari（2022）： Correlation is a relationship or connection between two or more objects. If X and Y, two variables, tend to be observed at the same time, there’s a correlation between them. You cannot say X caused Y, you will simply say that when X and Y are observed together. Positive Correlation: When variable X increases, variable Y also increases. Similarly, if X decreases, Y correspondingly decreases. Negative Correlation: When variable X increases, variable Y decreases, or vice versa. No Correlation: Any change in X leads to no change in Y, or vice versa. Analytica（2019）： A correlation is a statistical measure that we use to describe the linear relationship between two continuous variables. What is Causation? Ansari（2022）： Unlike Correlation, the relationship is not because of a coincidence. We are saying that X causes Y, or vice versa. It means that the existence of one variable causes the manifestation of another. “cause”是什么意思？这里所谓导致是指其他条件不变的情况下，如果X变化，Y也随之变化，那么我们就说X导致了Y，X和Y具有因果关系（X-&gt;Y的因果关系）。在微观经济学中，需求函数就是说价格和需求之间存在负向因果关系：如果价格提高，需求会减少。隐含的假设是，价格提高的时候，其他因素（包括偏好、其他商品的价格和收入等）一概不变，这时需求才会减少。如果价格提高的时候，收入也提高，需求不一定减少。 What’s the difference between correlation and causation? Madhavan（2019）： Causation explicitly applies to cases where action A causes outcome B. On the other hand, correlation is simply a relationship. Action A relates to Action B—but one event doesn’t necessarily cause the other event to happen. However, we cannot simply assume causation (注：A-&gt;B) even if we see two events happening, seemingly together, before our eyes. One, our observations are purely anecdotal. Two, there are so many other possibilities for an association, including but not limited to: 反过来：B导致A。反向因果。 A和B相关，但它们均由C所致。例：图 1.1。在该图中，溺死数和冰淇淋消费量是相关关系，而非因果关系。实际上，是天热导致溺死数和冰淇淋消费量同时增加=&gt;遗漏变量 另一种情形：A-&gt;B, C-&gt;B，A和C相关。 A和B之间的相关关系在部分程度上由C导致。例：A是受教育程度，B是毕业后的收入。通常，我们观测到，受教育程度更高的人的平均收入也更高。但是，其高收入并不完全由教育导致，还可能有别的因素起作用：如受教育程度更高的人的平均IQ更高，高的IQ也会导致高收入=&gt;遗漏变量。 图 1.1: Drowning deaths and ice-cream consumption 资料来源：Ansai（2022）。 判断正误 Correlation =&gt; Causation. False. Causation =&gt; Correlation. False: think of nonlinear causation. 测试题 题目1: 在美国金融危机后，我国推出了“四万亿”投资，经济随之企稳，如图 1.2 所示： 图 1.2: Economic growth rate: 2008-2009 Q: “四万亿”投资与GDP增长率(2019Q1-&gt;2019Q4)提高5.5%是（前者-&gt;后者的）因果关系吗? 题目2: 相比西部地区，东部地区基础设施存量多1万亿（假设值）, 人均GDP高2万元（假设值）。Q: 前者与后者是（前者-&gt;后者的）因果关系吗? （2）识别因果关系 何为识别因果关系？把确定两个变量之间是否具有因果关系的过程叫做识别因果关系，在英文里面叫做”identification”。 识别因果关系的经典方法:随机实验法 识别因果关系的经典方法：随机实验法，在英文里面叫做random experiment。借鉴自自然科学，核心是随机分组。比如，研究肥料对作物收成的影响。这里指因果关系含义上的影响。隐含的假设是，只肥料这一个因素改变——肥料增加1单位，其他影响作物收成的因素（包括土地质量、降雨量、寄生物等）均保持不变，大豆的产出增加多少？用随机实验处理这个问题的思路：找到若干块土地，如100块，每块土地的大小都是一样的，如1亩。将这些土地随机分成两组。因为是随机分组，所以这两组土地的情况平均来说是相同的。然后对其中一组不施肥，对另外一组施1单位的肥料。用施肥组的平均作物收成减去不施肥组的平均作物收成，看它为正还是为负，藉此判断肥料对作物收成的影响。 这一差值反映了因果关系。为何？回忆：因果关系是说其他因素不变，只肥料变化作物产出如何变化。这里，因为分组是随机的，两组的情况平均而言是相同的，仅肥料使用量有异。所以，作物收成的差异平均而言反映了施肥量的影响。 于社会科学而言随机实验法的局限 局限其一。试看下例。教育回报率指受教育程度提高，比如说受教育程度从高中提高到大学，会使得收入如何变化？这是一个因果关系含义上的概念。隐含的假设是，受教育程度提高时其他影响收入的因素（IQ、家庭环境等）都保持不变。如果用随机实验法，做法是：找一些小孩，随机地给他们不同年限的教育，继而比较他们成年后的收入。因为他们的受教育年限是随机的，所以他们成年后的收入差异（平均而言）反映了受教育年限的差异。但是，这里存在道德伦理方面的问题：为什么给一些小孩更高的教育年限，而给另外一个小孩更低的教育年限。对此很多人不会认同。一般地，从伦理道德的角度，很多时候随机实验法在社会科学中不可行。 局限其二。仍看一例。研究交通基础设施对经济增长的影响。用随机实验法处理这一问题：去落后地区找一些不通路的村子，如找100个村子。将其随机分成两组，一些给修路，一些不给修路。然后看那些给修路的村子在路通之后经济发展是否更好。问题在于，修路贵。给50个村修路，即使不花几千万也得花几百万。哪个研究者有这么多钱搞这个研究？随机实验法成本高，故需开发具备经济性的计量方法识别因果关系。 总之，本书的核心就是介绍多种计量方法，以识别因果关系。 1.2 估计总体均值 问题：如何估计一个随机变量Y的总体均值\\(\\mu\\)？ 随机抽样，用样本均值估计总体均值: \\(\\bar{y} = \\frac{ \\sum_{i=1}^N y_i }{N}\\)。例：掷硬币，掷到正面记1，掷到反面记-1，易知总体均值是0。假设我们不知道总体均值，可以随机抽取30个观测值（掷30次硬币），计算样本均值，作为总体均值的一个估计。 样本均值具有一个良好的性质：样本均值使下面的函数达到最小值: \\[\\begin{align} f(m) = \\sum_{i=1}^N (y_i-m)^2 \\tag{1.1} \\end{align}\\] 假设随机抽取了3个观测值：\\(y_1\\)，\\(y_2\\)，\\(y_3\\)，如图1.3所示： 图 1.3: 通过随机抽样估计总体均值 纵轴就表示观测值大小；横轴1表示第一个观测值，以此类推。给定一个数m，可以画出水平线，将图中最左边垂线的平方定义为m到第一个观测值（点）的距离，即\\((y_1-m)^2\\)。类似地，m到第2和3个观测值的距离分别为\\((y_2-m)^2\\)和\\((y_3-m)^2\\)。三者相加，就是\\(f(m)\\)，反映数m（水平线）到这三个观测值（点）的总距离。不同的m，到这些观测值的总距离不一样。m取什么值时总距离最小？答案就是样本均值（请自行证明）。 样本均值是一个随机变量：今天随机掷30次硬币，计算得出一个样本均值。明天再掷30次硬币，也计算出一个样本均值。如此下去10000天。往往各天的样本均值不一样，亦有别于总体均值。 样本均值作为一个随机变量具有统计性质：有期望，也有方差。\\(E[ \\bar{y} ] = \\mu\\)。虽然往往各天的样本均值不同，但如果对这10000个样本均值给求平均，那么它大概等于总体均值。平均而言，估计是准确的（简单来说，期望就是平均的意思）。 Y的方差多大？假设\\(Y\\sim N(\\mu,1)\\),\\(Var[\\bar{y}]=\\frac{1}{N}\\),\\(\\bar{y}\\sim N(\\mu,\\frac{1}{N})\\)。 给定其分布，可以构建置信区间： \\[\\begin{align} Prob\\left( \\lvert \\frac{ \\bar{y}-\\mu }{ 1 / \\sqrt{N} } \\rvert \\leq 1.96\\right) = 0.95 \\Rightarrow Prob\\left( \\bar{y} - \\frac{1.96}{\\sqrt{N}} \\leq \\mu \\leq \\bar{y} + \\frac{1.96}{\\sqrt{N}} \\right) = 0.95 \\tag{1.2} \\end{align}\\] 基于置信区间，可做假设检验。原假设\\(H_0:\\mu=0\\)。如果置信区间包含0，那么我们不能拒绝原假设；否则，我们就要拒绝原假设。（以上数学公式如不明白，请翻阅前置课程统计学、概率论与数理统计的相关内容） 还是同样一个过程，换一个顺序说明，分为5个步骤： 第一步, 建立（计量）模型：\\(\\epsilon_{(i)}=Y_{(i)}-\\mu\\)。\\(\\epsilon_i\\)表示抽到的第i个值对总体均值的偏离。为了简便，在不引起混淆的时候把下标i省略掉。Y是一个随机变量, \\(\\mu\\)是一个确定值，尽管未知待估。因此，\\(\\epsilon\\)是一个随机变量，E[\\(\\epsilon\\)]=0。模型转换：Y=\\(\\mu\\)+\\(\\epsilon\\),E(\\(\\epsilon\\))=0。这就是Y的统计模型，或者叫计量模型。 第二步，随机抽样。有了计量模型我们需要数据。假设抽到N个观测值。 第三步, 估计总体参数\\(\\mu\\)：\\(Min_m f(m) = \\sum_{i=1}^N (y_i -m)^2 \\Rightarrow m^*=\\bar{y}\\)。直观的理解：进行随机抽样，抽到多个观测值。这些观测观测值应该围绕着总体均值上下波动。有时抽到的观测值比总体均值大，而有时抽到的观测值比总体均值小。观测数很多时，大于总体均值和小于总体均值的个数大致相当。反过来说，总体均值处于抽到的观测值的中间，总的来说离观测值近。因此，一个自然的想法是，选择距观测值最近的数作为总体均值的估计。上式最小化平方和，因此称称作最小二乘法。由数学推导得，样本均值是总体均值的一个估计量。 第四步, 推导估计量的期望和方差, 公式已在上面给出。 第五步, 构建置信区间, 进行假设检验。 这5步其实就是计量经济学里面最核心的5步。后续的计量分析基本照此展开。 1.3 计量经济学的性质与经济数据 见伍德里奇（2015）《计量经济学导论：现代观点》第五版第1章。 1.4 数学知识复习 见斯托克和沃森（2012）《计量经济学》第二版第2章如下内容： 2.1 随机变量与概率分布 2.2 期望值、均值与方差 2.3 二维随机变量。Q：用数学形式表述：平均而言，受教育程度为本科的人的IQ高于受教育程度为高中的人的IQ？ 2.5 随机抽样和样本均值的分布 2.6.1 大数定理和一致性 参考文献 伍德里奇. 计量经济学导论(第五版)[M]. 中国人民大学出版社, 2015. 斯托克, 沃森. 计量经济学(第三版)[J]. 格致出版社, 2012. Ansai（2022）：https://www.troopmessenger.com/blogs/correlation-vs-causation Analytica（2019）：https://statanalytica.com/blog/correlation-vs-causation/ Madhavan（2019）：https://amplitude.com/blog/causation-correlation "],["blr.html", "第 2 章 二元线性回归 2.1 二元线性回归模型的定义 2.2 普通最小二乘法的推导 2.3 OLS估计量的期望和方差 2.4 函数形式 2.5 最小二乘法：再考察 2.6 零条件均值假设：成立吗？", " 第 2 章 二元线性回归 2.1 二元线性回归模型的定义 二元线性回归模型具有如下的形式： \\[\\begin{align} y_i=\\beta_0+\\beta_1x_i+u \\tag{2.1} \\end{align}\\] i表示观测值； y：dependent variable, explained variable, response variable； x：independent variables, explanatory variables, regressors； u：error term, disturbance, unobservables； \\(\\beta_0\\)：intercept； \\(\\beta_1\\)：slope parameters。 我们是y、x和u为随机变量。 在不引起混淆的时候，也可略去下标，将模型写作\\(y=\\beta_0+\\beta_1x+u\\)。 系数的含义：若\\(\\bigtriangleup u=0\\)（所有其他因素保持不变）时，\\(\\bigtriangleup y=\\beta_1\\bigtriangleup x\\)（自变量增加1单位，因变量变化多少？）。故\\(\\beta_1\\)其反映x对y的因果影响。 例：教育回报率众所关心。考虑如下的计量模型： \\[\\begin{align} wage=\\beta_0+\\beta_1educ+u \\tag{2.2} \\end{align}\\] 其中，u包括Labor force experience、tenure with current employer、work ethic和intelligence等。\\(\\beta_1\\)度量的是，保持所有其他因素不变，受教育年限增加1年导致的小时工资的变化，反映教育回报率。 “线性”指关于参数是线性的。 2.2 普通最小二乘法的推导 最小二乘（OLS）法的直观理解 从总体中随机抽取N个观测值。记号：{\\(((x_i,y_i):i=1,...,N)\\)}。画散点图，如图2.1所示。 设计量模型为式(2.1)。 问题：基于这些数据，如何估计总体参数？之前，我们估计的总体参数只有总体均值一个；这里，有两个待估计的总体参数：\\(\\beta_0\\)和\\(\\beta_1\\)。怎么估计\\(\\beta_0\\)和\\(\\beta_1\\)？ 记\\(\\beta_0\\)的估计量为\\(\\hat{\\beta_0}\\)，\\(\\beta_1\\)的估计量记为\\(\\hat{\\beta_1}\\)。如果确定了\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)，就可以确定一条直线：\\(y=\\hat{\\beta_0}+\\hat{\\beta_1}x\\)。\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)变化，直线也跟着变化。反过来，直线确定了，\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)也确定了。即：\\({\\hat{\\beta_0},\\hat{\\beta_1}}\\)与直线是一一对应的关系。那么，确定\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)，等价于找直线为\\(y=\\hat{\\beta_0}+\\hat{\\beta_1}x\\)。 问题：直线有无限条，需要我们找出其中一条，它在某种意义上是最优的。直观上，该怎么去找？ 图 2.1: wage and education 回忆：估计总体均值时，我们选择距观测值m（对应观测点）最近的数（对应一条水平线y=m），或者说选择距观测点最近的水平线。 类比：找一条离观测点最近的直线。这里不必是一条水平线，可以是任意走向的直线。 严格地，定义一条给定的直线到各观测点的距离。一种（不是唯一的）定义距离的方法：如图2.2，三个观测点\\((x_1,y_1),(x_2,y_2),(x_3,y_3)\\)，一条给定的直线\\(y =\\hat{\\beta_0}+\\hat{\\beta_1}x\\)，做一条从点1出发的垂线，至该直线而止，定义该线段的平方为点1到该直线的距离。数学表达：\\((y_1- \\hat{\\beta_0}-\\hat{\\beta_1}x_1)^2\\)。注意，\\(y_1-\\hat{\\beta_0}-\\hat{\\beta_1}x\\)可能为负，求其平方，保证得到一个正数。类似可求其他点到该直线的距离。总距离为： \\[\\begin{align} (y_1 - \\hat{\\beta_0} - \\hat{\\beta_1}x_1)^2 + (y_2 - \\hat{\\beta_0} - \\hat{\\beta_1}x_2)^2 +(y_3 - \\hat{\\beta_0} - \\hat{\\beta_1}x_3)^2 \\tag{2.3} \\end{align}\\] 选择直线与观测点的总距离最小，或者说选择\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)使得总距离最小： \\[\\begin{align} Min_{\\hat{\\beta_0},\\hat{\\beta_1}} (y_1 - \\hat{\\beta_0} - \\hat{\\beta_1}x_1)^2 +(y_3 - \\hat{\\beta_0} - \\hat{\\beta_1}x_2)^2 + (y_2 - \\hat{\\beta_0} - \\hat{\\beta_1}x_3)^2 \\tag{2.4} \\end{align}\\] 图 2.2: Illustration of the OLS method 定义： \\[\\begin{align} \\hat{y} \\equiv \\hat{\\beta_0} + \\hat{\\beta_1}x \\\\ \\hat{u} \\equiv y - \\hat{y} = y - \\hat{\\beta_0} - \\hat{\\beta_1}x \\tag{2.5} \\end{align}\\] \\(\\hat{y}\\)就是直线的纵坐标，称为拟合值。\\(\\hat{u}\\)是图2.2 中线段，在直线上方记为正，在直线下方记为负，称为残差。可以把最小化问题表述为： \\[\\begin{align} Min_{\\hat{\\beta_0},\\hat{\\beta_1}} (y_1 - \\hat{y_1})^2 +(y_2 - \\hat{y_2})^2 + (y_3 - \\hat{y_3})^2 = \\hat{u_1}^2 +\\hat{u_2}^2 + \\hat{u_3}^2 \\tag{2.6} \\end{align}\\] OLS估计量的推导 一般地，有N个观测值，优化问题为： \\[\\begin{align} Min_{\\hat{\\beta_0},\\hat{\\beta_1}} \\sum_{i=1}^N (y_i - \\hat{\\beta_0} - \\hat{\\beta_1}x_i)^2 \\tag{2.7} \\end{align}\\] 对择\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)求偏导，得到一阶条件： \\[\\begin{align} \\sum_{i=1}^N (y_i - \\hat{\\beta_0} - \\hat{\\beta_1}x_i) = 0 \\\\ \\sum_{i=1}^N (y_i - \\hat{\\beta_0} - \\hat{\\beta_1}x_i) x_i = 0 \\tag{2.8} \\end{align}\\] 可以推出： \\[\\begin{align} \\hat{\\beta_1} = \\frac{\\sum_{i=1}^N (x_i-\\overline{x})(y_i-\\overline{y})}{(x_i-\\overline{x})^2} \\\\ \\hat{\\beta_0} = \\overline{y} - \\hat{\\beta_1}\\overline{x} \\tag{2.9} \\end{align}\\] 推导见伍德里奇（2015）《计量经济学导论：现代观点》第五版式(2.16)-(2.19)。 \\(\\hat{\\beta_1}\\)和\\(\\hat{\\beta_1}\\)的计算公式已经给出来了。两个估计量均是观测值{\\(((x_i,y_i):i=1,...,N)\\)}的函数。由于我们把x和y视作随机变量，随机变量的函数依然是随机变量。 程序模拟 写了一个Fortran小程序。它从总体中随机抽取一个样本，包含30个观测值，每个观测值包含x和y两个取值（可以将y理解成wage，x理解成education）。 一次随机抽样的结果如图2.3。抽到的第一个观测值的y是0.4187，x是0.1616。第二个观测值的y是0.2976，x是1.3366。因为是随机抽样，第二个观测值y和x的取值不同于第一个观测值的y和x的取值。其他观测值取值如图。基于这些观测值，计算了\\(\\hat{\\beta_1}\\)，计算结果和详细的计算过程如图2.3。 图 2.3: Calculation based on a random sample 把这个过程重复500遍，即进行500次抽样。在每一次抽样中，都随机抽取30个观测值，基于这些观测值重新计算\\(\\hat{\\beta_1}\\)。 为便于理解，列出前两次抽样的观测值：图2.4左边是第一次抽样的观测值，右边是第二次抽样的观测值。左右两边的观测值不一样，因是随机抽取的。既如此，基于各样本计算的\\(\\hat{\\beta_1}\\)也就不一样。 图 2.4: Two random samples 图2.5列出了由500次抽样计算出来的500个\\(\\hat{\\beta_1}\\)（图为局部图）。图中第一列表示抽样次数，第二列表示\\(\\hat{\\beta_1}\\)。可以看到，各次抽样的\\(\\hat{\\beta_1}\\)均不一样，这就是为什么我们说\\(\\hat{\\beta_1}\\)是一个随机变量。 图 2.5: 500 estimates (only first 40 estimates displayed) 总结：因为x和y是随机的，每次抽样得到的x和y不一样，基于这些x和y计算出来的\\(\\hat{\\beta_1}\\)不一样，故\\(\\hat{\\beta_1}\\)是一个随机变量。 估计教育回报率 伍德里奇（2015）《计量经济学导论：现代观点》第五版例2.4基于数据“WAGE1.dta”估计了计量模型：\\(wage=\\beta_0+\\beta_1educ+u\\)。结果显示，\\(\\hat{\\beta_0}=-0.90,\\hat{\\beta_1}=0.54\\)。\\(\\hat{\\beta_1}\\)的含义：in the sample, one more year of education was associated with an increase in hourly wage by 0.54 dollar。注意，这里没有其他条件不变这个限定条件。一般而言，\\(\\hat{\\beta_1}\\)和\\(\\beta_1\\)的含义是不一样的。 一阶条件的含义 一阶条件也可写成： \\[\\begin{align} \\sum_{i=1}^N \\hat{u_i} = 0 \\\\ \\sum_{i=1}^N \\hat{u_i}x_i = 0 \\tag{2.10} \\end{align}\\] 含义：（1）正负偏离相抵；（2）残差与自变量不相关。Q：为什么？[提示：想想相关系数的公式]。 一阶条件的直观展示如图2.6。仍然使用伍德里奇（2015）《计量经济学导论：现代观点》第五版例2.4的数据，绘制散点图，\\(\\hat{u_i}\\)作为纵轴，education作为横轴。 首先看第一个一阶条件：残差有正的也有负的，图2.6中正负偏差相抵。再看第二个一阶条件。图2.6中\\(\\hat{u_i}\\)和education之间没有明显的正的线性关系的或负的线性关系，二者的相关系数为0。 图 2.6: Calculation based on a random sample 拟合优度 见伍德里奇（2015）《计量经济学导论：现代观点》第五版第35-37页。 2.3 OLS估计量的期望和方差 问题：反过来用educ对wage做回归，可不可以？有没有意义？ 数学上没有问题。Stata演示结果略。经济学上没有意义。一般的结论：用变量1对变量2回归，不能保证变量2的估计系数有意义。 为了使估计系数有意义，需要施加约束。什么是有意义？通常，满足下式，称有意义： \\[\\begin{align} E[\\hat{\\beta_1}] = \\beta_1 \\tag{2.11} \\end{align}\\] 含义：\\(\\hat{\\beta_1}\\)是一个随机变量。我们不能保证每一次抽样得到的\\(\\hat{\\beta_1}\\)都等于\\(\\beta_1\\)；通常前者不等于后者。我们希望至少保证当把这个事情重复很多遍，比如说我们刚才抽样500次，得到的500个\\(\\hat{\\beta_1}\\)的平均值等于\\(\\beta_1\\)。或者说，上式成立。期望表示的就是“平均而言”。上式是说，平均而言，\\(\\hat{\\beta_1}\\)反映/识别了因果关系。 问题：施加什么条件才能使上式成立？ 直接思考这个问题有一定难度。可以从考虑一个简单的问题开始。如果E[IQ|受教育程度=本科]&gt;E[IQ|受教育程度=高中]（受教育程度等于本科的人的IQ平均来说大于受教育程度等于高中的人的IQ），那么E[收入|受教育程度=本科]-E[收入|受教育程度=高中]（本科生的收入的均值减去高中生的收入的均值）是否反映受教育程度和收入之间的因果关系？即该差值是否完全由受教育程度的差异所致？如果不能的话，将这一前提条件替换成什么条件可使这一差分反映因果关系？ 考虑第一小问：本科生平均收入比高中生平均收入高，既因接受了更多的教育，又因本科生IQ平均来说比高中生高。故给定该前提条件，该差值不能反映受教育程度和收入之间的因果关系。 考虑第二小问：换成E[IQ|受教育程度=本科]=E[IQ|受教育程度=高中]。我们之前担心存在遗漏变量问题：本科生和高中生的IQ不相同，因此，不知道收入差异到底是受教育程度不同还是IQ不同所致。改成这一前提条件，回避了这一问题。 即使如此，本科生和高中生在别的方面存在差异。如，一般来说，家庭收入越高，对小孩的教育投入越多，小孩上大学的概率越高。又如，本科生和高中生的道德品质可能有差异。等等。为此，按照上面的逻辑，我们还需要增加如下的前提条件： \\[\\begin{align} E[家庭收入|受教育程度=本科]=E[家庭收入|受教育程度=高中] \\\\ E[道德品质|受教育程度=本科]=E[道德品质|受教育程度=高中] \\\\ ... \\tag{2.12} \\end{align}\\] 问题在于，可以列出成百上千个前提条件，因为影响收入的因素众多。思考：可不可以化繁为简，用一个简单的式子概括一系列前提条件？这个简单的式子是什么？ 下式符合要求： \\[\\begin{align} E[u|受教育程度=本科]=E[u|受教育程度=高中] \\tag{2.13} \\end{align}\\] 干扰项的定义就是除了我们纳入模型的因素以外，未纳入模型的因素的综合影响。数学上，可以将u写成IQ、家庭收入、道德品质等一众未纳入模型的因素的函数。上式表示，本科生和高中生除受教育程度以外各因素的综合影响平均而言相等，或者说给定受教育程度，受教育程度以外各因素的综合影响的期望为一个常数。 在这个前提条件满足的情况下，E[收入|受教育程度=本科]-[收入|受教育程度=高中]能够反映受教育程度和收入之间的因果关系。注意这只是一个假设，成不成立是另外一回事。这里只是说如果假设成立，那么我们可以继续进行数学推导。 一般地，受教育程度可以取多个值，如小学、初中、高中、本科、研究生等。将前提条件换成： \\[\\begin{align} E[u|educ] = Constant \\tag{2.14} \\end{align}\\] 表示，不管受教育程度取何值，除受教育程度以外各因素的综合影响平均而言均相等。 这是保证OLS估计量有意义的核心假设。此外，我们还需要其他一些假设。 三个假设 （1）假设1（随机抽样）：我们有一个服从总体模型(2.1)的随机样本； （2）假设2（样本中解释变量有波动）：样本中x取不尽相同的值。如不然，则无法研究x变化如何影响y； （3）假设3（零条件均值）：\\(E[u|x]=0\\)。零条件均值假设与前述条件均值为常数本质上是一回事（想想为什么）。零条件均值假设的含义：x变化时，所有其他因素对y的综合影响平均意义上保持不变。。或者说，x对于预测其他因素对y的综合影响的均值无帮助。在教育回报率的例子中，这意味着，不管受教育程度怎么变化，所有其他因素对收入的综合影响平均意义上保持不变（合理吗？） 零条件均值假设是假设，未必是事实。如果它成立，我们可以在它基础上进行推导。但我们需要检查它在现实中是否成立。 OLS估计量的无偏性 若计量模型(2.1)满足假设1-3，可推出：\\(E[\\hat{\\beta_0}]=\\beta_0,\\ E[\\hat{\\beta_1}]=\\beta_1\\)，称OLS估计量是无偏的。证明见伍德里奇（2015）《计量经济学导论：现代观点》第五版第2.5节定理2.1。 程序模拟（续） 接2.2中的程序模拟。疑问：500次抽样怎么抽的？这里予以明确。假设真实的模型为： \\[\\begin{align} y=x+u, x\\ and\\ u \\sim N(0,1), x\\ and\\ u\\ are\\ independent. \\tag{2.15} \\end{align}\\] 这里，\\(\\beta_0=0,\\beta_1=1\\)。 抽样：以抽取第一个观测值为例，我们从一个标准正态分布里随机抽取一个\\(x_1\\)，从另一个独立的标准正态分布里随机抽取一个\\(u_1\\)，把它们加起来，就得到\\(y_1\\)。由此得到第一个观测值\\((x_1,y_1)\\)。如此，我们抽第2至30个观测值，组成一个样本。这是一次抽样。基于这一次抽样，计算一个\\(\\hat{\\beta_1}\\)。重复这一过程，进行第2至500次抽样。每次抽样均包含30个观测值，计算得到一个\\(\\hat{\\beta_1}\\)。共得到500个\\(\\hat{\\beta_1}\\)。 这一过程满足假设1-3，包括\\(E(u|x)=0\\)。为什么？因此： \\[\\begin{align} E[\\hat{\\beta_1}]=1 \\tag{2.16} \\end{align}\\] 这是理论结果。是否500次抽样的\\(\\hat{\\beta_1}\\)的均值约等于1？绘制500个\\(\\hat{\\beta_1}\\)的直方图如图2.7。由图，\\(\\hat{\\beta_1}\\)不尽相同，有的时候比较小，甚至达到0.3，而有的时候比较大，甚至达到1.7。就是说由一个随机抽取的样本计算的\\(\\hat{\\beta_1}\\)可能离总体参数很远。但\\(\\hat{\\beta_1}\\)出现在总体参数1附近的频率最大。总体上，\\(\\hat{\\beta_1}\\)围绕着1分布，取到极端值的频率小。 图 2.7: Histogram of 500 estimates 图2.8展示了前若干个\\(\\hat{\\beta_1}\\)的均值。如最右端横轴是500，纵轴表示前500次抽样的\\(\\hat{\\beta_1}\\)的均值，它约等于1。 图 2.8: Mean of estimates 这个形象的例子说明在满足假设1-3的情况下，基于一个样本计算的\\(\\hat{\\beta_1}\\)通常不等于\\(\\beta_1\\)，还可能离\\(\\beta_1\\)比较远，但\\(\\hat{\\beta_1}\\)的均值等于\\(\\beta_1\\)。 零条件均值、无偏性与因果关系 我们很多次把最小二乘回归跟因果关系联系在一起。并非牵强附会。 因果关系的定义：x变化时其他因素不变，y怎么变化？反映从x到y的因果关系。 零条件均值假设：x变化的时候，平均而言其他因素不变。零条件均值假设跟因果关系定义的前半句非常相似,唯一的区别是多了一个“平均而言”。社会科学不同于自然科学，一般来说我们没办法进行实验，保持其他因素完全不变。比如，我们抽到若干个本科生和若干个高中生，除了受教育程度不一样，本科生和高中生在别的各方面也不一样。每一个人都是独特的，没有办法保持IQ严格不变，我们尽可能做到保持本科生和高中生的IQ的均值一样。故我们不得不加上“平均而言”，在数学上用期望表示。 如果零条件均值假设成立，可以推出无偏性：平均而言，\\(\\hat{\\beta_1}\\)等于\\(\\beta_1\\)，即平均而言\\(\\hat{\\beta_1}\\)反映因果关系，跟因果关系的定义的后半句非常相似，唯一的区别依然是多了一个“平均而言”。因为零件均值假设中有一个“平均而言”，这里也得有一个。 OLS估计量的方差 见伍德里奇（2015）《计量经济学导论：现代观点》第五版第46-51页。 2.4 函数形式 前已述及，“二元线性回归中”的“线性”指关于参数是线性的。至于自变量，可以是绝对值，也可以取对数。下面两个模型都是二元线性回归模型： 收入和受教育程度的另一个计量模型：\\(log(wage)=\\beta_0+\\beta_1educ+u\\)； CEO薪水和公司销售额的一个计量模型：\\(log(salary)=\\beta_0+\\beta_1log(sales)+u\\)。 Q：以上两个模型中系数\\(\\beta_1\\)作何解释？例如，第一个模型中，\\(\\beta_1=0.05\\)，是什么含义？[如无头绪，请先阅读伍德里奇（2015）《计量经济学导论：现代观点》第五版第38-41页，再回答问题] 2.5 最小二乘法：再考察 最小二乘法到底在干什么？之前我们给出了一种理解（称为理解1）：把观测值画在二维图中，找离这些观测值最近的直线。这是一种直观的理解，但不是唯一的理解。下面我们给出另外两种理解。 理解2 \\[\\begin{align} y_i=\\hat{\\beta_0}+\\hat{\\beta_1}x_i+\\hat{u_i}=\\hat{y_i}+\\hat{u_i} \\tag{2.17} \\end{align}\\] 也就是说我可以把y分解成两部分：拟合值\\(\\hat{y}\\)和残差\\(\\hat{u}\\)。这两部分有什么关系？ \\(\\sum_{i}(\\hat{\\beta_0}+\\hat{\\beta_1}x_i)\\hat{u_i}=0\\)。为什么？[提示：使用一阶条件]。意味着\\(\\hat{y}\\)和\\(\\hat{u}\\)不相关。为什么？[提示：使用相关系数的公式] 直观上，可以绘制\\(\\hat{u_i}\\)和\\(\\hat{y_i}\\)的散点图。仍利用教育回报率的例子，绘制\\(\\hat{y_i}\\)（横轴，怎么计算？）和\\(\\hat{u_i}\\)（纵轴）的散点图如图2.9。可见，两者不存在线性关系，它们的相关系数为0。 图 2.9: What does OLS method do? 总之，最小二乘法是做分解：将因变量分解成拟合值和残差这两个不相关的项。 理解3 换一个角度，利用线性代数的知识。考虑过原点的回归模型： \\[\\begin{align} y=\\beta_1x+u \\tag{2.18} \\end{align}\\] 也就是说，\\(\\beta_0=0\\)。 OLS估计量为（推导见伍德里奇（2015）《计量经济学导论：现代观点》第五版第51页）： \\[\\begin{align} \\hat{\\beta_1}=\\frac{\\sum_{i}x_iy_i}{\\sum_{i}x_i^2} \\tag{2.19} \\end{align}\\] 有两个观测值：\\((x_1=2,y_1=1)，(x_2=0,y_2=2)\\)。代入上面的公式，得：\\(\\hat{\\beta_1}=0.5\\)。 将两个观测值的回归方程用线性代数表示： \\[\\begin{align} \\left( \\begin{array}{c} 1 \\\\ 2 \\end{array} \\right) = \\left( \\begin{array}{c} 2 \\\\ 0 \\end{array} \\right) \\times0.5 +\\left( \\begin{array}{c} 0 \\\\ 2 \\end{array} \\right) = \\left( \\begin{array}{c} 1 \\\\ 0 \\end{array} \\right) +\\left( \\begin{array}{c} 0 \\\\ 2 \\end{array} \\right) \\tag{2.20} \\end{align}\\] 记向量\\(\\vec{y}=(1,2)&#39;,\\vec{x}=(2,0)&#39;,\\vec{u}=(0,2)&#39;\\)。把这些向量画在二维图中： 图 2.10: What does OLS method do? (continued) 由图可见，OLS法是做线性投影：将向量\\(\\vec{y}\\)在向量\\(\\vec{x}\\)确定的平面上做线性投影，线性投影为拟合值，投影剩下的部分就是残差。 2.6 零条件均值假设：成立吗？ 一个物理学家，一个化学家和一个经济学家落难孤岛，正值饥肠辘辘，海上漂来一盒罐头。物理学家提议用岩石砸开罐头，化学家主张生火加热使其膨胀破裂，此时，经济学家慢条斯理地说：“你们的方法太复杂了，假设有一个开瓶器，我们就可以轻松撬开它。” 资料来源：https://www.douban.com/group/topic/252843954/?_i=7975810BnpGaYU 当零条件假设成立时，OLS估计量无偏，平均而言能够反映因果关系。问题是，什么情况下零条件均值假设成立？ 随机实验 如果x是随机分配的，那么零条件均值假设成立。比如，一个农学家研究施肥量（记为x）对作物收成（记为y）的影响。他可以做自然实验：找100块1亩大小的土地，随机分成10组，分别施以0、1、2……、9单位的肥料。某块地获施肥量多寡，纯系运气，与别的信息无关。也就是说，知道该块地的施肥量对于推测该块地的别的信息了无帮助。用数学术语讲： 对于任一施肥量，别的信息对此的条件期望是一个常数，即零条件均值假设成立。 问题在于，在经济学里，很难开展随机实验，原因有二：其一，经济学领域的随机实验的成本可能较高，如为了解基础设施对经济增长的影响，随机实验的思路选择100个村子，随机分成2组，给一组修路，对另一组不做处理。修路成本高昂显而易见。其二，为估计教育回报率，随机实验的思路是随机地给不同小孩不同的受教育程度。但为什么有的小孩就能得到高学历，而有的小孩初中毕业就不得不进入电子厂？这是伦理压力。 检验零条件均值假设是否成立 定理：\\(E[u|x]=0=&gt;Cov(x,u)=0,Corr(x,u)=0\\)。证明见斯托克和沃森（2012）《计量经济学》第二版第27页。 反过来，如果相关，零条件均值假设不成立。这为我们提供了一个判断零条件均值假设成不成立的思路：一般来说，很难直接判断零条件均值假设是否成立，因其抽象。但容易判断x和u是不是相关的。如果有理由认为x和u相关，则有理由认为零条件均值假设不成立。 例1：\\(y=\\beta_0+\\beta_1educ+u\\)。干扰项包含除教育以外其他影响收入的因素，包括IQ。IQ和受教育程度x应是正相关的。而IQ是u的一个组成部分，因此我们有理由认为u和educ也是相关的。进而有理由认为零条件均值假设不成立。这里存在所谓的遗漏变量问题：遗漏掉IQ，它与educ相关。既如此，OLS估计量不满足无偏性，平均而言不能反映因果关系。 例2：\\(cons=\\beta_0+\\beta_1transfer+u\\)(消费&lt;-转移支付)。Q：u是哪些因素的综合影响？这些因素各自与transfer相关吗？如果相关, 是正相关还是负相关？0条件均值假设成立吗？ 另外一种情况是不仅x会影响y，反过来y也会影响x。 例3：基础设施和经济发展水平的关系。良好的基础设施促进经济发展。反过来，经济发达，政府税收多，基础设施多。也就是说，基础设施和经济发展水平双向影响。 例4：国民总收入和总消费的关系。 如果x和y双向影响，那么x和u相关。证明如下： 图 2.11: reverse causilty and biased estimator 这就是反向因果问题。当其存在的情况下，零条件均值假设不成立，OLS估计量有偏, 平均而言不能反映因果关系。 遗漏变量或反向因果问题在实践中非常常见，以致于很多时候，简单做最小二乘回归没有什么意义。处理遗漏变量或反向因果问题至关重要。如何处理？本讲义后述各种方法，皆旨在处理这两个问题。 参考文献 伍德里奇. 计量经济学导论(第五版)[M]. 中国人民大学出版社, 2015. 斯托克, 沃森. 计量经济学(第三版)[J]. 格致出版社, 2012. "],["mlr.html", "第 3 章 多元线性回归：估计 3.1 使用多元线性回归模型的动因 3.2 多元线性回归模型的定义 3.3 OLS法的操作和解释 3.4 OLS估计量的期望 3.5 OLS估计量的方差 3.6 OLS估计量的有效性", " 第 3 章 多元线性回归：估计 3.1 使用多元线性回归模型的动因 二线线性回归模型： \\[\\begin{align} wage=\\beta_0+\\beta_1educ+u(IQ,...)，Cov(educ, IQ)&gt;0 \\tag{3.1} \\end{align}\\] 问题是，受教育程度更高的人平均而言IQ也更高，零条件均值假设不成立，估计量有偏。怎么解决这个问题？ 造成困扰的原因是干扰项中包含IQ。既如此，直接把IQ放到自变量里面就行了： \\[\\begin{align} wage=\\beta_0+\\beta_1educ+\\beta_2IQ+u \\tag{3.2} \\end{align}\\] 这是多元线性回归模型，具体来说是三元线性回归模型，三元是educ、IQ和常数1（\\(\\beta_0\\times1\\)）。一般地，可以把认为可能会干扰结果的遗漏变量加到自变量中。这样，它们不再被遗漏掉，以此处理遗漏变量问题。 3.2 多元线性回归模型的定义 多元线性回归模型具有如下的形式： \\[\\begin{align} y=\\beta_0+\\beta_1x_1+\\beta_2x_2+...+\\beta_kx_k+u \\tag{3.3} \\end{align}\\] y：dependent variable, explained variable, response variable； \\(x_1,x_2,...,x_k\\)：independent variables, explanatory variables, regressors； u：error term, disturbance, unobservables； \\(\\beta_0\\)：intercept； \\(\\beta_1,\\beta_2,...,\\beta_k\\)：slope parameters。 尽管存在多个解释变量，并不是说我们对所有解释变量的系数都同等程度地关心。很多时候，我们只关心其中一个解释变量如\\(x_1\\)的系数。如在上面的例子中，我们仅关心educ的系数，表示教育回报率。至于IQ的系数是多少，我们不关心。把IQ加进来唯一的理由是，若不加进来，它就是遗漏变量，会导致估计结果有偏。我们把\\(x_1\\)叫做核心解释变量，其他解释变量叫做控制变量。 \\(x_1\\)的系数\\(\\beta_1\\)的含义：当\\(\\bigtriangleup x_1=1, \\bigtriangleup x_2=0, …, \\bigtriangleup x_k=0, \\bigtriangleup u=0\\)时，\\(\\bigtriangleup y=\\beta_1\\)。故其反映\\(x_1\\)对y的因果影响。 函数形式 变量可以取对数，也可以取平方。如政府债务对经济增长的影响可能是倒U型的：适当规模的政府债务于经济发展有利，但过犹不及。相应地，计量模型为：\\(GDPG_i=\\beta_0+\\beta_1Debt_i+\\beta_2(Debt_i)^2+u_i\\)。其中，i表示省，\\(GDPG_i\\)表示i省的经济增长率，\\(Debt_i\\)表示i省的债务。预期\\(\\beta_1&gt;0,\\ \\beta_2&lt;0\\)。Q：计算\\(\\frac{ d_{GDPG_i} } { d_{Debt_i} }\\)。最优的债务水平是多少？ 3.3 OLS法的操作和解释 如何得到OLS估计值 定义拟合值：\\(\\hat{y_i}\\equiv \\hat{\\beta_0}+\\hat{\\beta_1}x_{i1}+\\hat{\\beta_2}x_{i2}+...+\\hat{\\beta_k}x_{ik}\\)。 定义残差：\\(\\hat{u_i}\\equiv y_i-\\hat{y_i}\\)。 求解优化问题：\\(min\\ \\sum_{i=1}^n(\\hat{u_i})^2\\)。一阶条件为： \\[\\begin{align} \\sum_i\\hat{u_i}=0 \\tag{3.4} \\end{align}\\] \\[\\begin{align} \\sum_ix_{ij}\\hat{u_i}=0\\ for\\ j=1,2,...,k \\tag{3.5} \\end{align}\\] =&gt; \\[\\begin{align} \\sum_i\\hat{y_i}\\hat{u_i}=0 \\tag{3.6} \\end{align}\\] 式(3.3)的含义：Deviations from regression line sum up to zero。也就是说，正负残差抵消掉了。 式(3.4)的含义：Correlations between deviations and regressors are zero，即所有解释变量和残差不相关。 式(3.5)的含义：因变量分解成拟合值和残差这两个不相关的部分。 求解一阶条件组成的联立方程组可得\\(\\hat{\\beta_0},\\hat{\\beta_1},\\hat{\\beta_2},...,\\hat{\\beta_k}\\)的OLS估计量。 理解多元回归估计系数 欲求\\(x_1\\)的估计系数，可采取两步法如下: Step 1：\\(x_1\\)对\\(x_2\\)，…，\\(x_k\\)做OLS回归（可不可以这样做？），生成残差\\(\\hat{r}\\)，即将\\(x_1\\)分解为其他解释变量解释的部分（拟合值）和与其他解释变量无关的部分（\\(\\hat{r}\\)）； Step 2：y对\\(\\hat{r}\\)回归。 Step 2估计的\\(x_1\\)的系数等于用OLS法估计的\\(x_1\\)的系数（证明见伍德里奇3-2f）。 在Step 1中，\\(\\hat{r}\\)是\\(x_1\\)与其他自变量（\\(x_2,…,x_k\\)）不相关的部分。另一种说法：\\(\\hat{r}\\)是\\(x_1\\)排除了或净化掉其他自变量的影响之后的部分。于是，\\(\\hat{\\beta_1}\\)度量的是在排除其他自变量的影响之后y与\\(x_1\\)之间的关系。 多元回归分析的作用在于，尽管不能在其他自变量不变的情况下收集数据，但它提供的系数仍可作其他自变量不变的解释。 例：\\(wage=\\beta_0+\\beta_1educ+\\beta_2IQ+u\\)。\\(\\hat{\\beta_1}\\)表示保持IQ不变时受教育程度与工资的关系，相当于比较具有相同IQ但不同受教育程度和收入的人。看起来就好像我们在具有相同IQ但educ可能不同的人群中抽样。尽管保持IQ不变，道德品质等仍可能变化，educ与wage之间的关系不完全反映educ-&gt;wage的因果关系。一般地，不能保证估计系数有意义。 另见伍德里奇（2015）《计量经济学导论：现代观点》第五版第3.2节“对多元回归‘排除其他变量影响’的解释”。 3.4 OLS估计量的期望 三个假设 （1）假设1（随机抽样）：我们有一个服从总体模型(3.3)的随机样本； （2）假设2（不存在完全多重共线性）：解释变量（含常数）间不存在准确的线性关系，即不存在如下的关系： \\[\\begin{align} a_0+a_1x_1+a_2x_2+…+a_kx_k=0 \\tag{3.6} \\end{align}\\] 完全多重共线性的例子：某乡村自20世纪80年代举行村长选举多次，每次在两名候选人之间选举村长，其中一名是张姓候选人，另一名是非张姓候选人。考虑到村民倾向于支持同姓候选人，建立如下的计量模型：\\(voteZ=\\beta_0+\\beta_1shareZ+\\beta_2sharenZ+u\\)。其中，voteZ是张姓候选人得票率，shareZ是张姓村民占比，sharenZ是非张姓村民占比。显然，shareZ+sharenZ=1。故这一模型存在多重共线性。 这一假设排除了某解释变量为常数的情况。 这一假设仅排除了解释变量之间的完全相关（|r|=1）; 允许不完全相关。 （3）假设3（零条件均值假设）：\\(E[u|x_1,x_2,...,x_k]=0\\)，表示自变量\\(x_1,x_2,…,x_k\\)对于预测干扰项的均值没有帮助。也就是说，任一自变量变大或变小，干扰项的均值保持不变。 如果零条件均值假设成立，有下面的推论：\\(Cov(x_j,u)=0,Corr(x_j,u)=0\\ for\\ j=1,2,…,k\\)。把与干扰项不相关的变量就称为外生解释变量，与干扰项相关的解释变量称为内生解释变量。零条件均值假设成立意味着所有解释变量都是外生解释变量。 OLS估计量的期望 若计量模型(3.3)满足假设1-3，可推出：\\(E(\\hat{\\beta_j})=\\beta_j,\\ j=0,1,2,...,k\\)，即OLS估计量是无偏的。 注意，无偏性是多轮抽样的平均性质。对于一个样本，估计值可能小于或大于总体参数，甚至可能离总体参数很远。 3.5 OLS估计量的方差 见伍德里奇（2015）《计量经济学导论：现代观点》第五版第3.4节除“误设模型中的方差”以外的内容。 3.6 OLS估计量的有效性 见伍德里奇（2015）《计量经济学导论：现代观点》第五版第3.5节。 参考文献 伍德里奇. 计量经济学导论(第五版)[M]. 中国人民大学出版社, 2015. "],["mlrinf.html", "第 4 章 多元线性回归：统计推断 4.1 引例 4.2 OLS估计量的抽样分布 4.3 检验对单个总体参数的假设 4.4 多元回归能解决遗漏变量问题吗？", " 第 4 章 多元线性回归：统计推断 4.1 引例 在电影《肖申克的救赎》的一开始，男主人公被控杀害妻子，“铁证如山”，锒铛入狱。但，男主人公是被冤枉的。 审判的程序： 提出原假设（无罪）； 提供证据； 若证据不足，维持原假设（无罪释放）；若证据足够充分，拒绝原假设（投入监狱）。 可能存在的问题： 释放了真正的罪犯（错误地维持原假设）； 将无辜的人关进监狱（错误地拒绝原假设）。 统计推断的程序和存在的问题亦如是。 4.2 OLS估计量的抽样分布 见伍德里奇（2015）《计量经济学导论：现代观点》第五版第4.1节。 4.3 检验对单个总体参数的假设 见伍德里奇（2015）《计量经济学导论：现代观点》第五版第4.2节。 多元线性回归可借助软件Stata估计并做统计推断。Stata命令如下（假设有三个自变量）： regress y x1 x2 x3 4.4 多元回归能解决遗漏变量问题吗？ 相比简单回归，多元回归考虑了更多的影响因素，能不能彻底解决遗漏变量问题？问题在于，影响因素有很多，能把所有的因素都包含进来吗？有两个难点： 第一个难点是，甚至不可能列出所有的影响因素。例：20世纪90年代，美国犯罪率大幅降低，什么原因导致？列维特和都伯纳（2016）提出并验证了，70年代允许堕胎法案的通过在一定程度上导致90年代犯罪率降低！多数人想不到这个影响因素。 第二个难点是，即使列出来一些影响因素，一定能找到这些影响因素的数据吗？收集数据最原始的方式是发问卷。如果想度量更多的影响因素，就要在问卷上设置更多的问题。问题一多，做一份问卷的时间就长了，时间或人工成本增加，未必是时间或经费有限的研究者能够承受的。在有限的时间或经费预算内，理性的做法是，测度重要的因素，舍弃次要的因素。 总之，不可能把所有的影响因素都加入自变量。未纳入的影响因素进入干扰项。不能保证所有未纳入的因素都和核心解释变量不相关。一旦有一个未纳入的因素与核心解释变量相关，零条件均值假设就不成立了，OLS估计量有偏，平均而言不能识别因果关系。 结论：相比二元线性回归，多元线性回归使得遗漏变量问题有所缓解，但不能保证彻底解决遗漏变量问题，且通常不能彻底解决遗漏变量问题。 但，有一种特殊的情况，多元线性回归能识别因果关系，这就是满足一定前提条件的清晰断点回归（可以把它看作多元线性回归的一个特例）。为能理解清晰断点回归，需要先学习定性信息的知识。 参考文献 列维特、都伯纳. 魔鬼经济学01[M]. 中信出版社会, 2016. 伍德里奇. 计量经济学导论(第五版)[M]. 中国人民大学出版社, 2015. "],["dummy.html", "第 5 章 定性信息 5.1 二值变量 5.2 虚拟变量陷阱 5.3 分类、基准和虚拟变量 5.4 多个虚拟变量 5.5 更多例子", " 第 5 章 定性信息 5.1 二值变量 回忆OLS估计量的计算公式，不要求变量是连续的，可以是离散的，如只取两个值——1或0。称之为二值变量，或指示变量，或虚拟变量。考虑如下的二元线性回归模型： \\[\\begin{align} y=\\beta_0+\\beta_1D+u \\tag{5.1} \\end{align}\\] \\(\\beta_1\\)表示其他因素不变，D从0增加到1，y的变化。 利用OLS估计量的计算公式推出，\\(\\hat{\\beta_1}=\\bar{y}|_{D=1}-\\bar{y}|_{D=0}\\)。 如果零条件均值假设成立，\\(\\hat{\\beta_1}\\)是无偏的。 一个例子 中国改革的一个典型做法是先在一些地方试点，如果试点效果好，再把成功的经验推向全国。假设在中国部分地级市开展某项财税改革试点。考虑如下的计量模型： \\[\\begin{align} y=\\beta_0+\\beta_1Pilot+u \\tag{5.2} \\end{align}\\] 其中，y表示的是人均GDP的对数，度量经济发展水平。Pilot是一个虚拟变量，定义如下： \\[ Pilot= \\begin{cases} 1&amp; \\text{进行了试点} \\\\ 0&amp; \\text{未进行试点} \\end{cases} \\] 通常把它称为政策虚拟变量（有政策为1，没政策为0，所以叫政策虚拟变量）。\\(\\beta_1\\)表示D从0（无试点）增加到1（无试点）导致的y的变化，即试点的效果。\\(\\beta_1\\)的OLS估计值等于试点市y的平均值减去未试点市y的平均值。如果零条件均值假设成立，OLS估计量是无偏的。零条件均值假设成立的一种情形是试点城市的选定是随机的。 5.2 虚拟变量陷阱 定义虚拟变量NoPilot如下： \\[ NoPilot= \\begin{cases} 1&amp; \\text{未进行试点} \\\\ 0&amp; \\text{进行了试点} \\end{cases} \\] Q：可以在计量模型中同时加入Pilot和NoPilot吗？即可以设置如下的计量模型吗？ \\[\\begin{align} y=\\beta_0+\\beta_1Pilot+\\beta_2NoPilot+u \\tag{5.3} \\end{align}\\] \\(Pilot+NoPilot=1\\)。存在多重共线性。因此，不能这样做。 5.3 分类、基准和虚拟变量 从分类的角度理解虚拟变量。将地级市分成两类：试点和未试点。以未试点的地级市为基准，给试点的地级市一个虚拟变量Pilot（如图5.1）。回归中Pilot的系数表示相对基准，试点地级市因变量的平均增幅. 图 5.1: Classification 基准的选择是任意的。也可以选择试点的地级市作为基准，给未试点的地级市一个虚拟变量NoPilot，估计\\(y=\\beta_0+\\beta_1NoPilot+u\\)。从数学上讲，这样做没有问题，但NoPilot的系数的含义不那么自然。 5.4 多个虚拟变量 考虑另外一种试点情形：有两套试点方案，一套试点方案在一些地区实施，另一套试点方案在另一些地区实施，还有一些地区未实施任一方案。由于有两套试点方案，需要定义两个虚拟变量。记第一种试点方案的虚拟变量为Pilot1（试点此方案记为1，否则记为0），第二种试点方案的虚拟变量为Pilot2。计量模型： \\[\\begin{align} y=\\beta_0+\\beta_1Pilot1+\\beta_2Pilot2+u \\tag{5.4} \\end{align}\\] \\(\\beta_1\\)和\\(\\beta_2\\)分别表示试点方案1和2的效果。 \\(\\beta_1\\)的OLS估计量：推行第一种试点方案的地级市y的均值-未试点的地级市y的均值。\\(\\beta_2\\)的OLS估计量：推行第二种试点方案的地级市y的均值-未试点的地级市y的均值。 也可以从分类的角度理解，如图5.2。 图 5.2: Classification (continued) 把地级市分成三类：没有进行试点的地级市，试点方案一的地级市，试点方案二的地级市。把未进行试点的地级市作为基准。给试点方案一的地级市一个虚拟变量Pilot1，其系数表示相对基准试点方案二的地级市因变量的平均增或减幅。 给试点方案二的地级市一个虚拟变量Pilot2，其系数表示相对基准试点方案二的地级市因变量的平均增或减幅。 5.5 更多例子 用虚拟变量可以做很多事。比如，定义一个虚拟变量Male。顾名思义，它是男性的虚拟变量，赋值如下： \\[ Male= \\begin{cases} 1&amp; \\text{男} \\\\ 0&amp; \\text{女} \\end{cases} \\] 计量模型： \\[\\begin{align} wage=\\beta_0+\\beta_1Male+u \\tag{5.5} \\end{align}\\] Q：\\(\\hat{\\beta_1}=?\\) 还可以用虚拟变量研究种族（汉族还是少数民族）；行业（重工业或轻工业，或三大产业）；地区（东中西）。 伍德里奇《计量经济学导论：现代观点》第五版第7.1-7.3节对定性信息做了更详尽的介绍。 参考文献 伍德里奇. 计量经济学导论(第五版)[M]. 中国人民大学出版社, 2015. "],["srdd.html", "第 6 章 清晰断点回归 6.1 思路 6.2 估计 6.3 应用", " 第 6 章 清晰断点回归 本章是对清晰断点回归的极简介绍。 6.1 思路 以下是学者最开始用清晰断点回归处理的例子。假设依据GPA（x）确定授予/不授予奖学金，具体方案如下： GPA≥3.9，授予奖学金; GPA&lt;3.9，不授予奖学金。 问题：获得奖学金会改变学习计划（y）吗？这是可能的，比如大三面临考研，如果有足够的预算，理性的选择是采取一些有效率但费钱的方式，如报考研班（假设报班是有效率的）。得到奖学金，扩大了预算，提高了报考研班的概率——奖学金改变了学习计划。 怎么估计奖学金对学习计划的影响？一个简单的想法是比较得到和未得到奖学金的同学，将他们在学习计划方面的差异认定为奖学金对学习计划的影响。这样做有问题。想想为什么有的同学总能得到奖学金。因其学习计划性本来就比较好：看手机少看书多，有计划，遵守计划等。即使没有奖学金这个事，也会观测到两类学生在学习计划方面的差异。 但可以比较GPA刚好超过临界值3.9（3.9+ε，ε为任意小的正数）一点点的同学张三和刚好低于3.9（3.9-ε）一点点的同学李四。两人GPA微小的差距很可能是偶然因素造成的，如张三的跪舔得到了回应使其考试时状态好，而李四考试时感冒了。本身来讲，两人学习计划性差距甚微。但张三就是得到了奖学金，而李四未得。是否得到奖学金这件事这可能影响到学习计划性。因此，如果发现两人在学习计划方面存在明显的差异，那么这一差异几乎就是奖学金造成的。 严格地讲，两人学习计划性的差异包含两部分：第一，本身学习计划性的差异，由基因等决定。第二，奖学金对学习计划性的影响。当ε趋近于0时，两人GPA的差异趋近于0，第一部分趋近于0，两人学习计划性的差异趋近于奖学金对学习计划性的影响。 有无获得奖学金在3.9处有一个从无到有的跳跃。将3.9称为（清晰）断点。将比较（清晰）断点两侧一点点的观测值的方法称为（清晰）断点回归。 6.2 估计 图6.1是若干同学的散点图。 横轴是GPA。纵轴是学习计划性的指标y。竖线x=3.9右边的同学得到奖学金，左边未得。 竖线以右，基于这部分散点绘制拟合曲线，它是线性、连续的，当GPA从左侧趋近于3.9时，拟合值趋近于\\(y_r\\)，对应前例中ε趋近于0时的张三。竖线以左，基于这部分散点绘制拟合曲线，它是线性、连续的，当GPA从左侧趋近于3.9时，y趋近于\\(y_l\\)，对应前例中ε趋近于0时的李四。在断点处，拟合值有一个跳跃，幅度为\\(y_r-y_l\\equiv\\rho\\)，反映奖学金对y的影响。 图 6.1: Sharp RDD: estimation 怎么用数学表示这个跳跃？竖线左边观测值的拟合曲线和右边观测值的拟合曲线斜率相同、截距不同。截距差就是\\(y_r-y_l\\)，正是我们要找的奖学金对y的影响。 断点左边的拟合曲线： \\[\\begin{align} \\hat{\\alpha}+\\hat{\\beta}x \\tag{6.1} \\end{align}\\] 断点右边的拟合曲线： \\[\\begin{align} \\hat{\\alpha}+\\hat{\\rho}+\\hat{\\beta}x \\tag{6.2} \\end{align}\\] 涵盖所有观测值的总的拟合曲线怎么写？ 如下： \\[\\begin{align} \\hat{\\alpha}+\\hat{\\rho}D+\\hat{\\beta}x,\\ D=1\\ iff\\ x\\ge3.9 \\tag{6.3} \\end{align}\\] 其中，D是奖学金的虚拟变量。 对应的计量模型为： \\[\\begin{align} y=\\alpha+\\rho D+\\beta x+u \\tag{6.4} \\end{align}\\] 这是一个多元线性回归！D和x是两个自变量。D的系数表示奖学金的作用。Q：D由x构造而来，D和x之间是否存在多重共线性？ 满足以下两个条件时，D的系数的OLS估计量无偏： x不能被操纵。在本例中，这意味着学生不能通过不正当手段左右成绩，不正当手段包括跟老师说，我GPA就差一点点就到3.9，老师您给我加2分我就可以拿奖学金了； 遗漏变量在断点处不存在跳跃。在例子中，这排除了下面的情况：父母宣称，子女GPA超过3.9，奖励1万元。若这样，奖学金的作用和父母奖励的作用混合在一起了，无法区分。 这两个条件比零条件均值假设弱，且可以用统计方法验证（思考验证思路）。 6.3 应用 中国冬日（城市）集中供暖以淮河为界，以北政府集中供暖，以南政府不集中供暖（见图6.2）。冬日集中供暖在人世最寒凉的时候予人温暖。同时产生空气污染物，危害人的健康，最终导致人的预期寿命减少。 如何估计冬日集中供暖对预期寿命的影响？思路是比较淮河两侧一点点的城市，淮河构成断点。数学上，只需将式(6.4)中的变量重新定义即可。定义x为城市距淮河多少纬度，在淮河以北为正，以南为负。如一个城市在淮河以北2个纬度，则其x为2；另一个城市在淮河以南1.5个纬度，则其x为-1.5。定义\\(D=1\\ iff\\ x\\ge0\\)。 估计结果显示，冬日集中供暖使得预期寿命降低了约5年（Chen et al., 2013）！ 图 6.2: Map of China mainland 注：沿海诸岛略。 资料来源：Chen et al (2013)。 参考文献 安格里斯特, 皮施克. 基本无害的计量经济学：实证研究者指南[M]. 格致出版社, 2012, 第2.1节和6.1节. Chen Y, Ebenstein A, Greenstone M, et al. Evidence on the impact of sustained exposure to air pollution on life expectancy from China’s Huai River policy[J]. Proceedings of the National Academy of Sciences, 2013, 110(32): 12936-12941. "],["mech.html", "第 7 章 机制和异质性分析 7.1 机制分析 7.2 异质性分析", " 第 7 章 机制和异质性分析 7.1 机制分析 回到5.5的计量模型： \\[\\begin{align} wage=\\beta_0+\\beta_1Male+u \\tag{7.1} \\end{align}\\] 很可能得到，\\(\\hat{\\beta_1}\\)为正，即样本中男性平均工资比女性平均工资高。进一步我们想问，为什么平均而言男性工资比女性工资高？猜想男性工资更高一个原因/机制是男性受教育程度更高。怎么检验这一猜想/机制？ （1）首先，检验男性受教育程度更高，这是前提。regress educ on Male: \\[\\begin{align} educ=\\gamma_0+\\gamma_1Male+\\epsilon \\tag{7.2} \\end{align}\\] 应满足：\\(\\hat{\\gamma_1}&gt;0\\)。 （2）然后，检验两性受教育程度的差异对于两性工资差异有解释力。举例来说，男性工资平均高10，其中3是男性受教育程度高造成的，7是其他因素造成的。也就是说，如比较受教育程度相同的男性和女性，前者平均工资比后者高7。即控制受教育程度，男性平均工资高7（相比不控制时的10减小）。因此，验证思路是：设法控制受教育程度（即剔除这一机制），看此时估计系数是否减小（至7）。 Q：怎么控制受教育程度？[提示：回忆多元线性回归中系数的含义] 方法是构建如下的计量模型： \\[\\begin{align} wage=\\alpha_0+\\alpha_1Male+\\alpha_2educ+v \\tag{7.3} \\end{align}\\] 式(7.1)中\\(\\beta_1\\)相当于例子中的10，式(7.3)中\\(\\alpha_1\\)相当于例子中的7。验证：\\(\\alpha_1&lt;\\beta_1\\)，即控制教育这一机制后，两性工资差距减小。还要验证这一推导背后隐含的假设：教育提高了工资，即\\(\\alpha_2&gt;0\\)。 进一步，在例子中，教育这一机制解释了\\(\\frac{10-7}{10}=30\\%\\)的两性工资差异。一般地，教育这一机制解释了\\(\\frac{\\beta_1-\\alpha_1}{\\beta_1}\\)的两性工资差异。 如果（1）和（2）同时的得到验证，则教育这一机制得证。 一般地怀疑x影响y的一个机制是z，即怀疑存在x-&gt;z-&gt;y的逻辑链条。检验该机制的步骤类此。Q：试举x-&gt;z-&gt;y的一个例子，说明x、z和y分别表示什么，解释x-&gt;z-&gt;y的逻辑链条，写出机制分析的步骤。 7.2 异质性分析 回到最初的计量模型： \\[\\begin{align} wage=\\beta_0+\\beta_1educ+u \\tag{7.4} \\end{align}\\] \\(\\beta_1\\)反映样本中受教育程度增加1单位工资平均增加多少，即反映平均的教育回报率。可能不同人的教育回报率不一样。如在古代，女性的教育回报率接近0，因其参加不了科举，做不了官。而男性的教育回报率为正。即教育回报率在两性间存在差异，呈现出异质性。用什么计量方法刻画不同个体差异化的教育回报率？ 一种方法：将样本分成两组，一组全是男，一组全是女，分组估计，看两组的\\(\\hat{\\beta_1}\\)是否存在明显的差异。 另一种方法：写出女性的回归方程如下： \\[\\begin{align} wage=\\beta_0+\\gamma_1educ+u \\tag{7.5} \\end{align}\\] 设男性的估计系数比女性的估计系数多\\(\\gamma_2\\in R\\)（男性的教育回报率大于女性的教育回报率 &lt;=&gt; \\(\\gamma_2&gt;0\\)）。则男性的回归方程为： \\[\\begin{align} wage=\\beta_0+(\\gamma_1+\\gamma_2)educ+u \\tag{7.6} \\end{align}\\] Q：试用一个统一的计量模型概括上述两式。 如下： \\[\\begin{align} wage=\\beta_0+(\\gamma_1+\\gamma_2Male)educ+u \\tag{7.7} \\end{align}\\] 或 \\[\\begin{align} wage=\\beta_0+\\gamma_1educ+\\gamma_2educ\\times Male+u \\tag{7.8} \\end{align}\\] 换一种表述：教育回报率的大小依赖于性别，为刻画这一点，在自变量已包含educ之外，再加入educ与性别指标Male的乘积。 一般地，怀疑x对y的影响依赖于z，为刻画这一异质性，在自变量中加入x与z的乘积，即使用如下的计量模型： \\[\\begin{align} y=\\beta_0+\\gamma_1x+\\gamma_2x\\times z+u \\tag{7.9} \\end{align}\\] \\(\\gamma_2\\)的含义：z增加1单位，将使x的系数增加\\(\\gamma_2\\)。如果\\(\\gamma_2&gt;0\\)，那么更大的z增大了x对y的因果影响。 Q：另举一式(7.9)适用的例子，说明y、x和z分别表示什么，解释x对y的影响依赖于z的逻辑。 "],["cons.html", "第 8 章 一致性", " 第 8 章 一致性 见伍德里奇（2015）《计量经济学导论：现代观点》第五版第136-139页。 补充说明 无偏性意味着估计量在平均意义上能够反映因果关系（无论n的大小），而一致性意味着估计量在n足够大时/渐进意义上能够反映因果关系。 参考文献 伍德里奇. 计量经济学导论(第五版)[M]. 中国人民大学出版社, 2015. "],["misspe.html", "第 9 章 模型误设 9.1 遗漏相关变量 9.2 包含无关变量", " 第 9 章 模型误设 本章在伍德里奇（2015）《计量经济学导论：现代观点》第五版第74-78页的基础上做了改写和拓展。 9.1 遗漏相关变量 仍然关注教育回报率。 假设真实的情况是受教育程度由高中提高到本科将使月收入提高1000元，如估计值为1500元则为高估，称产生正的偏误；估计值为800元则为低估，称产生负的偏误。 Q：如果E[IQ|受教育程度=本科]&gt;E[IQ|受教育程度=高中]，那么，E[收入|受教育程度=本科]-[收入|受教育程度=高中]将高估、还是低估受教育程度对收入的因果影响？ 本科生收入更高反映了两种影响：一个是教育的作用，另一个是本科生的IQ平均更高，而IQ高导致收入高，即收入差距一部分是由IQ差距导致的。简单求收入差值将高估受教育程度对收入的因果影响。 用数学语言讲，造成正的偏误的来源有两点：受教育程度与IQ正相关，而IQ对收入有正向的因果影响。 用计量语言概括此例：真实的模型是这样的：\\(wage=\\beta_0+\\beta_1educ+\\beta_2IQ+u,E[u|educ,IQ]=0\\)。但我们错误估计了如下模型：\\(wage=\\alpha_0+\\alpha_1educ+w\\)。这属于模型误设的一种情形：遗漏相关变量。OLS估计量存在正的偏误（高估）。 一般地，真实的模型为：\\(y=\\beta_0+\\beta_1x_1+\\beta_2x_2+u\\)。假设零条件均值假设成立。错误地估计模型：\\(y=\\alpha_0+\\alpha_1x_1+w\\)。\\(\\hat{\\alpha_1}\\)和\\(\\hat{\\beta_1}\\)有何联系？ 推导如下： 图 9.1: Derivation for omitted variables 对于真实的模型，零条件均值假设成立，故有：\\(\\hat{\\beta_1}\\stackrel{p}{\\longrightarrow}\\beta_1\\)。而\\(Cov(u,x_1)=0,Cov(v,x_1)=0\\) =&gt; \\(Cov(\\beta_2v+u,x_1)=0\\)。因此，\\(\\hat{\\alpha_1}\\stackrel{p}{\\longrightarrow}\\beta_1+\\beta_2\\delta_1\\)。多出来的部分\\(\\beta_2\\delta_1\\)就是偏误。其中，\\(\\delta_1\\)反映\\(x_1\\)和\\(x_2\\)的相关性。\\(\\beta_2\\)反映\\(x_2\\)对y的因果影响。对应上面提到的两点。在例子中，\\(\\beta_2\\)和\\(\\delta_1\\)都为正，正正得正，偏误为正（高估）。 例: cons&lt;-transfer+income, 遗漏income. Q: 偏误方向? 例: GDP&lt;-govt expenditure+money supply, 遗漏货币供给. Q: 偏误方向?。 9.2 包含无关变量 假设真实的模型是：\\(y=\\beta_0+\\beta_1x_1+\\beta_2x_2+u\\)。我们引入了无关变量\\(x_3\\)。 真实的模型又可写作：\\(y=\\beta_0+\\beta_1x_1+\\beta_2x_2+0\\times x_3+u\\)。通过这一改写，形式上将\\(x_3\\)纳入了真实模型，不再是无关变量。可推出：若零条件均值假设成立，\\(x_1,x_2,x_3\\)的系数的OLS估计量皆是无偏的，特别地，\\(x_3\\)的系数的OLS估计量的期望为0。 但要注意，包含无关变量可能使得标准误增大。 本章小结 遗漏相关变量导致偏误，包含无关变量影响方差。这两个都有问题，遗漏相关变量问题可能更大一点。所以，一般的建议是在不确定要不要加某个变量作为自变量的时候，把它加上，这可能使得标准误变大，但OLS估计量始终是无偏的，平均而言反映了因果关系。 参考文献 伍德里奇. 计量经济学导论(第五版)[M]. 中国人民大学出版社, 2015. "],["panel.html", "第 10 章 面板数据模型：计量方法及应用 10.1 面板数据的定义 10.2 差分法 10.3 去均值法 10.4 固定效应模型 10.5 LSDV法 10.6 时间固定效应 10.7 应用：财政联邦主义的文献", " 第 10 章 面板数据模型：计量方法及应用 再次考虑教育回报率的例子。如果我们有IQ的数据，直接把它放到回归模型中，作为一个额外的自变量就可以了。相当于比较具有相同IQ、不同受教育程度的人（回忆多元回归模型中系数的含义）。 问题是，我们可能没钱度量IQ。在没钱度量IQ的情况下，有什么别的思路控制IQ的影响以准确地估计教育回报率吗？ 世纪佳缘创始人龚海燕高二辍学到电子厂打工，收入微薄，后重拾学业，自复旦毕业后收入大幅提高。收入增加不是IQ引起的，因为同一个人（青少年之后）IQ不变，更可能是再教育之于她的回报。这里的关键在于，我们关注同一个人收入的变化，从而排除了其不变的IQ的影响。 总之，如果知道IQ，可比较具有相同IQ的不同个体的收入；如果不知道IQ，可比较同一个IQ不变的人再教育前后的收入。后者是我们接下来要学习的面板数据估计的关键。 斯托克和沃森（2012，第10章）结合例子对面板数据做了精彩的介绍。参考其文，本章做了精炼和拓展。 10.1 面板数据的定义 简单来说，n个个体在T个时期的数据构成面板数据。有两个维度：一个时间维度，一个空间维度。可以写成下面的形式： \\[ (X_{it},Y_{it})\\ \\ i=1,2,…,n\\ \\ t=1,2,…,T \\] X和Y是变量。两个下标中，i表示个体，t表示时间。因此，样本总量为\\(n\\times T\\)。 例：江苏省13个地级市2016-2018年的经济数据构成1个面板数据。这里共有13个个体，n=13；三年，T=3。观测值数量就是\\(13\\times 3=39\\)。 10.2 差分法 斯托克和沃森（2012，第10章）基于美国州面板数据，研究啤酒税对交通死亡率的影响。预期为负向影响，因为啤酒税提高，啤酒消费量降低，酒驾减少，交通事故减少，交通死亡率降低。 啤酒税的单位为dollars per case，记为X。交通死亡率定义为每万人中因交通事事故死亡的人数，记为Y。 如果像以前一样，使用一年的横截面数据，如1982年的数据，结果显示：啤酒税的估计系数为0.15，符号与预期不符；换用1988年的数据进行回归，啤酒税的估计系数为0.44，依然是正的，不太合理。 为什么会这样？一个可能的解释是，模型遗漏了重要的因素，导致高估。一个可能的遗漏因素是酒驾的社会接受度。各州对酒驾的接受程度不一样。酒驾的社会接受度（正向）影响交通死亡率。同时，有可能酒驾的社会接受度高的地方，政府缺钱，对啤酒征重税。因此，偏误为正（高估）。 如果能度量酒驾的社会接受度, 将之加入计量模型： \\[\\begin{align} Y_{i1982}=\\beta_0+\\beta_1X_{i1982}+\\beta_2Z_i+u_{i1982} \\tag{10.1} \\end{align}\\] \\[\\begin{align} Y_{i1988}=\\beta_0+\\beta_1X_{i1988}+\\beta_2Z_i+u_{i1988} \\tag{10.2} \\end{align}\\] \\(Z_i\\)表示酒驾的社会接受度，只有个体（州）下标，反映为在任一给定的州内它不随时间变化。它是啤酒税之外的另一个解释变量。社会态度变化缓慢，可能几十上百年才会有明显的转变。而研究者收集到的数据的时间段往往较短。在较短的时间段内，可以认为社会态度保持不变。注意，在样本时间段内，尽管同一个州的\\(Z_i\\)保持不变，不同州的\\(Z_i\\)一般不一样。 用交通死亡率对啤酒税和酒驾的社会接受度回归，可以解决原来由\\(Z_i\\)造成的遗漏变量问题。可惜问题在于，很难度量酒驾的社会接受度。Q：在观测不到\\(Z_i\\)但知它不随时间变化的情况下，如何估计\\(\\beta_1\\)？我们不知道\\(Z_i\\)，又希望控制\\(Z_i\\)的影响。注：我们不关心\\(\\beta_2\\)。[提示：回顾本章开头的例子] 在本章开头的例子中，我们关注同一个人收入的变化，排除了其不变的IQ的影响，用再教育之后的收入减去之前的收入作为教育回报率的估计。这里，无非是个体变了，不再是个人，而是州。我们想控制的变量从不变的IQ变成了不变的\\(Z_i\\)。类似地，我们关注同一个州交通死亡率的变化，排除了其不变的\\(Z_i\\)的影响，用后边1988年的交通死亡率减去前边1982年的交通死亡率： \\[\\begin{align} (Y_{i1988}-Y_{i1982})=\\beta_1(X_{i1988}-X_{i1982})+(u_{i1988}-u_{i1982}) \\tag{10.3} \\end{align}\\] 变成不含常数项的的简单回归模型。因变量是1982-1988年交通死亡率的变化。自变量是1982-1988年啤酒税的变化。应用2.5OLS估计量的计算公式，\\(\\beta_1\\)的估计系数为-1.04，变成负的，符号符合预期。 What if T&gt;2？计量模型写作： \\[\\begin{align} Y_{it}=\\beta_0+\\beta_1X_{it}+\\beta_2Z_i+u_{it} \\tag{10.4} \\end{align}\\] 或 \\[\\begin{align} Y_{it}=\\beta_1X_{it}+\\alpha_i+u_{it},\\ \\alpha_i\\equiv\\beta_0+\\beta_2Z_i \\tag{10.5} \\end{align}\\] 实际上，除了酒驾的社会接受度以外，地理（记为G）也会影响交通死亡率。山路十八弯更容易发生交通事故。地理也可能跟啤酒税相关。并且，地理不随时间变化。考虑地理等影响交通死亡率、可能和啤酒税相关又不随时间变化的因素，模型拓展为： \\[\\begin{align} Y_{it}=\\beta_1X_{it}+\\alpha_i+u_{it},\\ \\alpha_i\\equiv\\beta_0+\\beta_2Z_i+\\beta_3G_i+... \\tag{10.6} \\end{align}\\] 称\\(\\alpha_i\\)为个体固定效应，表示所有观测不到、不随时间变化的因素对因变量的综合影响。它只有一个下标i，没有时间下标，反映它不随时间变化（同一个体各期取值相同）、随个体变化（不同个体的值不一样）。 原则上来讲，我们可以关注同一个州各期相比前一期的变化： \\[\\begin{align} (Y_{it}-Y_{it-1})=\\beta_1(X_{it}-X_{it-1})+(u_{it}-u_{it-1}) \\tag{10.7} \\end{align}\\] 10.3 去均值法 除了关注同一个州各期相比前一期的变化，我们还可以关注同一个州各期相比该州平均值的变化。后一种处理应用更广。它将估计分成两步：第一步，每个变量减去个体均值；第二步，利用“个体中心化”的变量进行估计。具体操作如下： 图 10.1: 去均值法 最后，模型退化为一个不含常数项的简单回归，此情形下OLS估计量的计算公式见2.5，可据此估计参数。 Stata提供了一个命令来完成这一系列工作，是为： xtreg Y X, fe 应用于美国各州1982-1988年的数据，啤酒税的估计系数为-0.66，符号符合预期（斯托克和沃森，2012，第10章）。 10.4 固定效应模型 对于式(10.6)，无论是应用差分法还是去均值法均允许\\(\\alpha_i\\)与\\(X_{it}\\)相关——\\(\\alpha_i\\)最终被消掉了，它与\\(X_{it}\\)相关性不构成问题。 称允许\\(\\alpha_i\\)与\\(X_{it}\\)相关的式(10.6)为固定效应模型。需要强调的是，不是有个体固定效应就是固定效应模型，有个体固定效应且它可以和自变量相关才是。 10.5 LSDV法 式(10.6)中\\(\\alpha_i\\)可以写成： \\[\\begin{align} \\alpha_i=\\alpha_1D_1+\\alpha_2D_2+...+\\alpha_nD_n \\tag{10.8} \\end{align}\\] 其中，\\(D_1\\)是第一个州的虚拟变量： \\[ D_1= \\begin{cases} 1&amp; \\text{第一个州（所有时期）} \\\\ 0&amp; \\text{其他州（所有时期）} \\end{cases} \\] \\(D_2\\)是第二个州的虚拟变量。以此类推。请自行验证式(10.8)成立。 于是，式(10.6)可以写成: \\[\\begin{align} Y_{it}=\\beta_1X_{it}+\\alpha_1D_1+\\alpha_2D_2+...+\\alpha_nD_n+u_{it} \\tag{10.9} \\end{align}\\] 这是一个多元回归。自变量包括X和n个虚拟变量。可用如下的多元回归命令估计： regress Y X D2 … Dn 这一估计得到的\\(\\hat{\\beta_1}\\)与由去均值法算得的\\(\\hat{\\beta_1}\\)相同。 称该法为LSDV法。LS指最小二乘，DV指虚拟变量。该法有一个缺点：当n很大时，自变量的个数（在本例中为1+n）很大，会增大运算量。差分法和去均值法不存在这一问题。 10.6 时间固定效应 斯托克和沃森（2012，第10章）认为，除了上面提到的影响交通死亡率的因素外，汽车行业全国安全标准也会影响交通死亡率。随着时间推移，汽车行业全国安全标准提高（如从不要求配备安全气囊到要求配备安全气囊），有利于降低交通事故的死亡率。 汽车行业全国安全标准提高发生在全国范围内，能减少所有州的交通死亡率。假设汽车行业全国标准提高使所有州交通死亡率降低相同幅度是合理的。 记汽车行业全国安全标准为\\(S_t\\)。它只有一个时间下标t，没有个体下标，反映安全标准随时间变化，但在任一个时间点对所有州都是一样的。将其纳入计量模型： \\[\\begin{align} Y_{it}=\\beta_1X_{it}+\\beta_3S_t+\\alpha_i+u_{it} \\tag{10.10} \\end{align}\\] 汽车行业全国安全标准对所有州的影响都为\\(\\beta_3S_t\\)。预期\\(\\beta_3\\)的系数为负。注意如果\\(S_t\\)和\\(X_{it}\\)相关，不将\\(S_t\\)加入计量模型将导致OLS估计量出现偏误。 如果\\(S_t\\)可观测，无非就是增加一个解释变量。但，很可能\\(S_t\\)不可观测。Q：怎么处理？ 将计量模型写成： \\[\\begin{align} Y_{it}=\\beta_1X_{it}+\\alpha_i+\\lambda_t+u_{it},\\ \\lambda_t\\equiv\\beta_3S_t \\tag{10.11} \\end{align}\\] 除了汽车行业全国安全标准，全国石油价格也影响交通死亡率，因为油价贵了，大家开车少，事故少。等等。一般地，\\(\\lambda_t\\)包含所有随时间变化但不随个体变化的影响因素，称为时间固定效应。 Q：Y为经济增长率，个体固定效应包含哪些因素？时间固定效应又包含哪些因素？ 类似10.5，\\(\\lambda_t\\)可以写成： \\[\\begin{align} \\lambda_t=\\lambda_1E_1+\\lambda_2E_2+...+\\lambda_TE_T \\tag{10.12} \\end{align}\\] \\(E_1\\)是第1期的虚拟变量。\\(E_2\\)是第2期的虚拟变量。以此类推。 于是，式(10.11)可以写成: \\[\\begin{align} Y_{it}=\\beta_1X_{it}+\\alpha_i+\\lambda_1E_1+\\lambda_2E_2+...+\\lambda_TE_T+u_{it} \\tag{10.13} \\end{align}\\] 为估计该式，可使用如下的Stata命令： xtreg Y X E2 … ET, fe 如果在Stata数据中，有一个名为year的变量，记录年份，那么，更简便的Stata命令是 xtreg Y X i.year, fe “i.year”将为变量year中的每一年生成一个虚拟变量，即生成E2、…、ET。 估计结果显示，\\(\\beta_1\\)的估计系数是-0.64，符合预期。 控制变量 尚有其他因素影响交通死亡率。例如，斯托克和沃森（2012，第10章）指出，一个可能的影响因素是平均而言司机开车熟练程度，可用司机平均驾驶里程度量。把诸如此类的变量加进来能够尽可能地缓解遗漏变量问题。 注意：加入的控制变量须随时间变化，因为凡不随时间变化的因素都在差分或去均值时被减掉了。也就是说，固定效应模型无法估计不随时间变化的变量的作用。 10.7 应用：财政联邦主义的文献 第一代财政联邦主义 财政联邦主义研究财权和事权在各级政府之间如何分配。第一代财政联邦主义认为，全国性公共品，应作为中央政府的事权；而地方性公共品，应作为地方政府的事权，因为地方政府掌握更多信息，包括当地居民的偏好和公共品供给的成本。进一步引申提出，适度分权能提高效率，进而促进经济增长。 大量文献从经验层面检验财政分权与经济增长的关系。 Davoodi and Zou (1998) use a panel data set of 46 countries over the 1970-1989 period to investigate the relationship between fiscal decentralization and economic growth. 他们使用如下的固定效应模型： \\[ g_{it}=\\delta_1+\\delta_2\\theta_{it}+\\delta_3\\tau_{it}+\\delta_4^{&#39;}D_i+\\delta_5{&#39;}N_t+\\delta_6{&#39;}X_{it}+\\epsilon_{it} \\] i and t refer to country i at time t。i=1,2…,46。t=1对应1970-79年，=2对应1980-89年。注意一期是十年； g is the average growth of real per capita output over ten-year periods。注意作者关注长期（十年）经济增长。实际值=名义值/价格指数； \\(\\theta\\) is the measure of fiscal decentralization, defined as the subnational share of total government spending。这是核心解释变量。以一个例子说明其取值：如果一国各级政府支出为100，其中40由地方政府支出，则该变量等于0.4； \\(\\tau\\) is the tax rate, defined as the ratio of total tax revenues to GDP； \\(D_i\\)是个体（国）虚拟变量构成的一个向量，\\(\\delta_4^{&#39;}D_i\\)就等于个体固定效应； 与上一点类似，\\(\\delta_5{&#39;}N_t\\)等于时间固定效应； X是控制变量, 包括: the average growth rate of population；initial human capital；initial per capita GDP; and the average real investment share of GDP。这些常被认为是经济增长的决定因素。 作者区分发达国家和发展中国家进行了估计，即使用发达国家的数据做一次估计，同时使用发展中国家的数据做一次估计。这是异质性分析（见7.2）。 发达国家的估计结果见图10.2，发展中国家的估计结果见图10.3。两表中，首列是变量名，列（1）-（5）每一列是一个回归，区别在于控制变量逐渐增多。对估计结果总结如下：We find a negative relationship between fiscal decentralization and growth in developing countries, but none in developed countries。 图 10.2: Results for developed countries 资料来源：Davoodi and Zou（1998）表2。 图 10.3: Results for developing countries 资料来源：Davoodi and Zou（1998）表2。 除这篇文章以外，还有大量研究财政分权和经济增长关系的经验文献。这些文献的结果各异，有的发现财政分权促进了经济增长，有的则得出相反的结论。这些相悖的经验结果不支持上述理论。这引人反思：上述理论正确吗？ 第一代财政联邦主义隐含地假设：地方政府是良善的（最大化辖区居民的福利）。惟其如此，将地方公共品交由地方政府提供，才能期望它们利用信息优势，提高效率。现实中，地方政府可能扮演两种不同的角色：扶持之手（helping hand），如改革开放后中国地方政府不断改善营商环境；攫取之手（predatory hand），如索马里地方政府所做的那样。 地方政府的行为取决于地方政府面临的激励。在此认识的基础上发展出第二代财政联邦主义，它强调财政激励。 第二代财政联邦主义 第二代财政联邦主义强调财政激励，尤其是边际收入分成率（marginal revenue retention rate），它指政府收入在边际上增加1单位，地方能存留多大比例。如某省从某企业收上来1单位税收，其中0.3单位上缴中央国库，剩下的0.7存留几用，则该省的边际收入分成率为0.7。预期边际收入分成率越高，地方政府越有激励发展地方经济，扮演扶持之手的角色。 Jin et al.（2005）检验了中国财政包干制时期财政激励对经济发展的影响。该时期央地之间的财政包干制有多种安排，故不同省份有不尽相同的边际收入分成率。基于此，构建如下的固定效应模型： \\[ Y_{it}=\\alpha_i+\\gamma_t+\\delta^{&#39;}Z_{it}+\\sigma^{&#39;}W_{it-1}+u_{it} \\] i表示省份； t表示年份，从1982到1992年； \\(Y_{it}\\) is a vector of variables measuring the development of the non-state sector and reform in the state sector in a province \\(Z_{it}\\) 包括边际收入分成率和财政分权指标； \\(\\alpha_i\\)是省份固定效应； \\(\\gamma_t\\) are the year dummies, which are intended to capture the effects of nationwide macroeconomic fluctuation； \\(W_{it-1}\\) is the lagged per capita GDP； \\(u_{it}\\)是干扰项。 作者首先考察财政激励对非国有部门的影响，结果如图10.4所示。在Panel A中，因变量为growth of rural enterprise employment；在Panel B中，因变量为growth of non-state-non-agricultural employment。以列（2）为例，自变量包括边际收入分成率、滞后一期的人均GDP、省份固定效应和年份虚拟变量。结果表明，边际收入分成率越高，非国有部门就业增长越快。 图 10.4: Fiscal incentives and the development of the non-state sector 资料来源：Jin et al.（2005）表5。 非国有部门的发展是否倒逼国有企业改革？带着这个问题，作者进一步考察财政激励对国有部门改革的影响，结果如图10.5所示。在Panel A中，因变量为change in the share of contract workers in total state employment；在Panel B中，因变量为change in the share of bonuses in total employee wages。仍以列（2）为例，结果表明，边际收入分成率提高使得国有部门的合同工占比提高，奖金占比提高，即促进了国有部门的市场化改革。 图 10.5: Fiscal incentives and the reform of the state sector 资料来源：Jin et al.（2005）表6。 本章小结 固定效应模型控制了不可观测、但不随时间变化的影响因素（如酒驾的社会接受度）以及不可观测、但不随个体变化的影响因素（如汽车行业的全国安全标准），进一步缓解了遗漏变量问题。但是，它不能处理不可观测、既随时间变化又随个体变化的因素。比如，在交通死亡率的例子中，雨雪天气容易引发交通事故，出现频率高，交通死亡率就高。这未被纳入计量模型。诸如此类的遗漏因素可能与（核心）解释变量相关，导致OLS估计量有偏。 总之，固定效应模型缓解了遗漏变量问题，但不能保证彻底解决遗留变量问题，OLS估计量依然可能是有偏的。但存在一种特殊的情形，在满足一定可验证的条件时，可以确定OLS估计量能够识别因果关系，这就是接下来要讲的双重差分法，它是固定效应模型的一个特例。 参考文献 斯托克, 沃森. 计量经济学(第三版)[J]. 格致出版社, 2012, 第10章. Davoodi H, Zou H. Fiscal decentralization and economic growth: A cross-country study[J]. Journal of Urban economics, 1998, 43(2): 244-257. Jin H, Qian Y, Weingast B R. Regional decentralization and fiscal incentives: Federalism, Chinese style[J]. Journal of public economics, 2005, 89(9-10): 1719-1742. "],["did.html", "第 11 章 基于面板数据的双重差分法：计量方法及应用 11.1 双重差分法的思路 11.2 政策一次性实施 11.3 政策分多轮推进 11.4 外生事件 11.5 基于处理强度的双重差分法", " 第 11 章 基于面板数据的双重差分法：计量方法及应用 考虑一个扶贫项目：某县教育局定点扶贫县内一个贫困村，为期五年。五年间该村收入增长了30%，宣告脱贫。 Q：该村五年间收入增长30%是否由该扶贫项目导致？如果否，怎么估计该扶贫项目的收入增长效应？ 11.1 双重差分法的思路 根据安格里斯特和皮施克（2012，第5.2节），双重差分法的用可以追溯至一百多年前。本节以下是对该书该节的转述和解读。 19世纪中期，伦敦霍乱问题严重。当时流行的观点是，霍乱通过糟糕的空气传播。 John snow（1855）提出一个新的观点：霍乱通过受污染的水传播。他观察到如下事实。 1849年，有一个叫Lambeth的水厂从伦敦中部河流下游水质差的Thames地区汲水，处理后供给伦敦的一部分家庭。1852年，它将水厂迁址到该河流上游水质好的一个地方。尽管水厂搬了，它的供水区不变。搬厂后其供水区霍乱致死数大幅减少。Q：1949-1852年Lambeth供水区霍乱致死数的减少是不是全由供水质量改善导致？ 三年间Lambeth供水区霍乱致死数的减少（总效应）包含了两种效应。其一，水质改善的效应（净效应）。其二，这段时间医疗卫生条件改善的效应。例如，研发出一种对霍乱有效的新药。全国都可以用这个药，因此，包括Lambeth的供水区在内的全国各地的霍乱致死数都会减少。称这一全国各地霍乱致死数统一的减少为趋势性变化（减少）。由于我们只关心供水质量改善带来的霍乱致死数的变化，需要剔除霍乱致死数的趋势性变化。如何做？ John Snow同时观测到另一个名为S &amp; V的水厂，1849-1952年间始终从Thames地区汲水，处理后供给家庭使用。知悉S &amp; V供水区1849和1952年的霍乱致死数。 S &amp; V始终没有迁址，其供水区霍乱致死数在1849-1852年间的变化反映了医疗卫生条件变化带来的趋势性变化。用其作为医疗卫生条件导致的趋势性变化的估计。这种趋势性变化对所有地区都是一样的。用Lambeth供水区霍乱致死数在1849-1852年间的变化减去S &amp; V供水区霍乱致死数在1849-1852年间的变化，就得到供水质量的改善的净效应。这里做了两次差分。第一次差分，对Lambeth和S &amp; V的供水区，分别用一个1852年的霍乱致死数减去1849的霍乱致死数。第二个差分，用前面一个差分减去后面一个差分。故名双重差分法。 双重差分法的关键假设是： Lambeth供水区和S &amp; V供水区由医疗卫生条件改善导致的霍乱致死数的减少相同，即趋势性变化相同。该假设成立是该方法有效的前提。 John Snow在一百多年前使用双重差分法时计量经济学尚未诞生。如今，我们学习了计量经济学，希望在基础上更进一步，将之转化为计量模型，进而估计参数，并做统计推断。 11.2 政策一次性实施 怎么按以上思路构建计量模型？我们用一个例子说明。 中国自改革开放后，经济飞速发展。发展的代价是环境急速恶化，至20世纪90年代末，中国多个城市跻身世界空气污染最严重的城市。为改善空气质量，1998年国务院实施两控区政策，两控区指二氧化硫控制区和酸雨控制区。酸雨也是二氧化硫引起的，故此政策意在控制二氧化硫排放。两控区的范围见图11.1中灰色区域。在两控区内实施严格的环境规制，比如限制火电厂建设，要求煤脱硫后方可使用。图11.1中白色区域为非两控区，不做任何干预。两控区自然地成为处理组，非两控区成为对照组。 图 11.1: Locations of two control zones 资料来源：Cai et al.（2016）图1。 Tanaka（2015）研究两控区政策对婴儿死亡率的影响。预期两控区因为严格的环境管制，二氧化硫排放减少，空气质量改善，人们的健康状况改善。在人群中，婴儿对空气质量最为敏感。如空气质量不好，他们受害最大。反之，二氧化硫排放减少，空气质量改善，他们的健康改善也最明显。因此，预测随着两控区政策的实施，婴儿死亡率——这一集中反映婴儿健康状况的指标——会降低。 类前，我们不能简单地计算两控区在政策实施后的婴儿死亡率与政策实施前婴儿死亡率的差值，作为两控区政策效果的估计。这一差值一部分反映该政策的效果，另外还反映其他因素变化的作用如护理技术提高的作用。更好的护理技术，能降低婴儿死亡率。并且，护理技术在全国的传播是不需要太大成本，即如果一个新的护理技术出来，被证明行之有效，会很快在全国范围内推广，导致全国各地区婴儿死亡率降低。此所谓（对所有地区相同的）趋势性变化。 具体来分析两控区（TCZ）和非两控区（non-TCZ）在该政策实施前后的四种情况。考虑两控区城市i，将其在1995年的婴儿死亡率分解成两部分，一部分是由1995年的护理技术决定的婴儿死亡率，记为\\(\\lambda_{1995}\\)。该记号只有一个时间下标（1995），而无城市下标，因为我们假设护理技术可以在全国迅速推广，从而在同一年对所有地方都是一样的。另一部分是城市i自身的地形决定的婴儿死亡率。想想一个以山地为主的城市，农村居民到城区或县区耗时久，孕妇不知道生产的确切时间，及至临盆，很可能就近至乡镇医院生产。乡镇医院的医疗条件通常要差一些，婴儿死亡率也就高一些。这部分婴儿死亡率用\\(\\alpha_i\\)表示。该记号只有城市下标，没有年份下标。这意味着，它在不同地方是不一样的，但对同一个地方，由于地形长期不变，由其决定的婴儿死亡率也就不变。 来看两控区城市i在2000年的情况。此时，该政策在该城市已经实施两年了。故该城市此时的婴儿死亡率包含三项。第一项是我们关心的政策效果，用\\(\\rho\\)表示，预期它小于0，即两控区政策改善了空气质量，从而降低了婴儿死亡率。第二项是提高后的护理技术决定的婴儿死亡率，记为\\(\\lambda_{2000}\\)。第三项是地形决定的婴儿死亡率，由于地形在五年内保持不变，这一项也保持不变，还是\\(\\alpha_i\\)。如果我们简单地用2000年的取值减去1995年的取值，得到：\\(\\rho+(\\lambda_{2000}-\\lambda_{1995})\\)；这一差值包括政策效应\\(\\rho\\)和趋势性变化\\(\\lambda_{2000}-\\lambda_{1995}\\)。 再来看非两控区城市j。其在1995年的婴儿死亡率可以分解成两项，一项是由1995年的护理技术决定的婴儿死亡率\\(\\lambda_{1995}\\)。注意这一项与两控区城市i当年的取值是一样的。另一部分是由该城市的地形决定的婴儿死亡率\\(\\alpha_j\\)。等到2000年，其婴儿死亡率为\\(\\lambda_{2000}+\\alpha_j\\)。非两控区内并无相应环境规制，所以没有政策效果这一项。用非两控区城市j在2000年的取值减去其在1995年的取值，得到趋势性变化：\\(\\lambda_{2000}-\\lambda_{1995}\\)。 用以上两控区城市i在政策实施前后婴儿死亡率的差值减去非两控区城市j在政策实施前后婴儿死亡率的差值就得到政策效果\\(\\rho\\)。如图11.2所示。 这是一种理解。 还可以从另一个角度理解。刚才横着相减做第一次差分，也可以竖着相减做第一次差分。对1995年，用两控区的婴儿死亡率减去非两控区的婴儿死亡率，得到\\(\\alpha_i-\\alpha_i\\)。\\(\\lambda_{1995}\\)消掉了，因为护理技术在同一年之于全国各地是相同的。对2000年，重复这一操作，得到\\(\\rho+\\alpha_i-\\alpha_i\\)。再用后一个差分减去前一个差分，同样得到了政策效果\\(\\rho\\)。殊途同归，但该操作过程有不同的含义。1995年差分反映的是处理组和对照组之间的差异，由不同的地形所致。地形短期内保持不变，故我们将这一组间差异称为组间固有差异。2000年差分依然包括组间固有差异项，除此以外，还包括政策效果项。后者拉大或缩小了组间差异，这就是对政策效果的另一种理解。 图 11.2: Infant mortality rate in four cases 将以上结果直观展示于图11.3。图中横轴表示年份，纵轴表示婴儿死亡率。如图所示，1995-2000年间，非两控区的婴儿死亡率降低（暂假设如此）。两控区的婴儿死亡率也在降低，但降得更多。假想没有实施两控区政策，两控区婴儿死亡率的变化仅由护理技术提高驱动，由于护理技术之于全国各地相同，因此其导致的全国各地婴儿死亡率的变化幅度相同，即两控区婴儿死亡率的轨迹应与非两控区婴儿死亡率的轨迹平行，如图中虚线所示。其与反映两控区婴儿死亡率真实变化的轨迹在2000年尚有差距，这一差距（多出来的降幅）即为政策效果，如图中2000年的垂线段。换一个角度，1995年两控区与非两控区之间的差异为组间固有差异（假设1995年两控区的婴儿死亡率更高）。2000年，组间差异反向了。组间差异的变化等于图中2000年的垂线段，反映政策效果。 图 11.3: Illustration of infant mortality rate 接下来，我们尝试将上述思路转化为计量模型。 思考：怎么用一个统一的式子表达图11.2中的4种情况？ 答案：\\(\\rho D_{k,t}+\\lambda_t+\\alpha_k\\)。其中，k表示城市，t表示年份。\\(D_{k,t}\\)表示两控区政策的虚拟变量。赋值如下：某城市于某年实施了政策，记为1；否则，记为0。注意，取值为1的情形：是两控区城市，且在1998年政策实施后。不妨将之写为：\\(\\rho D_{i,t}+\\lambda_t+\\alpha_i\\)。 以上只考虑了两年，考虑更多的年份：1995-2000年。\\(D_{i,t}\\)赋值如图11.4： 图 11.4: Values of policy dummy from 1995 to 2000 在上式中加入干扰项就得到一个计量模型： \\[\\begin{align} y_{i,t}=\\rho D_{i,t}+\\lambda_t+\\alpha_i+u_{i,t} \\tag{11.1} \\end{align}\\] 其中，因变量\\(y_{i,t}\\)表示婴儿死亡率。这不就是一个固定效应模型吗？核心解释变量较为特殊，是一个虚拟变量。其系数表示政策效应。\\(\\lambda_t\\)是时间固定效应，一般地，反映随时间变化、但不随个体变化的因素的作用，这些因素包括但不必局限于护理技术决定的婴儿死亡率。\\(\\alpha_i\\)是个体固定效应，一般地，反映随个体变化、但不随时间变化的因素的作用，这些因素包括但不必局限于地形。\\(u_{i,t}\\)表示其他没有纳入模型的因素的作用。因此，双重差分法其实是固定效应模型的一个特例。 可以分解政策变量：\\(D_{i,t}=TCZ_iPost_t\\)。\\(TCZ_i\\)和\\(Post_t\\)分别是两控区城市的虚拟变量（两控区城市取1，非两控区城市取0）和政策实施后年份的虚拟变量（1998年及以后年份取1，1998年以前年份取0）。 练习：仿照图11.4，填写\\(TCZ_i\\)和\\(Post_t\\)的取值，验证：\\(D_{i,t}=TCZ_iPost_t\\)。 影响婴儿死亡率的因素尚有其他，如产妇年龄，大龄产妇生育相对困难。将此类可度量的因素（记为\\(X_{i,t}\\)）纳入计量模型能缓解遗漏变量问题。 \\[\\begin{align} y_{i,t}=\\rho D_{i,t}+\\delta X_{i,t}+\\lambda_t+\\alpha_i+u_{i,t} \\tag{11.2} \\end{align}\\] 或者写为： \\[\\begin{align} y_{i,t}=\\rho TCZ_iPost_t+\\delta X_{i,t}+\\lambda_t+\\alpha_i+u_{i,t} \\tag{11.3} \\end{align}\\] 这便是双重差分法的完整计量模型了。在Stata中估计(11.3)，就用固定效应模型的命令： xtreg y c.TCZ#c.Post X i.year, fe Tanaka（2015）一文中的计量模型写作：\\(y_{j,t} = \\alpha+ \\pi_1 T_jPost_t + \\delta_1X_{j,t} + \\kappa_t + \\mu_j + \\epsilon_{j,t}\\)。注意，其中\\(\\alpha\\)是多余的，因为可以把它加到个体固定效应中。该公式其余部分与式(11.3)只是记号变了，无实质区别。 估计结果（含稳健性检验） 回归的结果见图11.5。第一列是变量名。因变量为婴儿死亡率，单位为千分之一。\\(TCZ\\times Post\\)是我们关心的解释变量。Observations是观测值数。其余各列一列表示一个回归。 列（1）只纳入了时间固定效应和个体固定效应（Year fixed effects和District fixed effect为Y）。\\(TCZ\\times Post\\)的系数均显著为负。估计系数为-2.870，在5%的水平显著（如表下注，两颗星表示在5%的水平显著）。该估计值的经济学含义：两控区政策的实施使得两控区城市婴儿死亡率降低0.2870%。称这一结果为基准结果。列（2）在此基础上加入了家庭层面的控制变量，包括share of male, birth shares in respective month, birth order, mother’s age, mother with high school degree or more, Han（表中HH controls为Y）。列（3）继续加入了城市层面的控制变量，包括number of births, total population, rainfall（表中District controls为Y）。注意，表中未报告这些控制变量的估计系数，因为我们不关心。加入这些控制变量以后，\\(TCZ\\times Post\\)的系数依然显著为负。并且，值变化不大。我们称（基准）结果对加入这些控制变量保持稳健（符号、显著性、大小保持稳定）。这是稳健性检验的一种方法，后面我们还会介绍其他稳健性检验方法。 图 11.5: Effect of the TCZpolicy on IMR 资料来源：Tanaka(2015)表3。 共同趋势检验 图11.2隐含地假设两控区城市和非两控区城市具有共同时间趋势（common trend），如在1995年，两者的趋势项均为\\(\\lambda_{1995}\\)。如果两者不具有共同时间趋势，如非两控区城市j在1995和2000年的趋势项变为\\(\\lambda_{1995}^{’}\\)和\\(\\lambda_{2000}^{’}\\)。双重差分法不能无偏地估计政策效应（练习：在此情形下，更新图11.2中的表格，验证这一论断）。因此，共同趋势假设成立是双重差分法有效的前提。须验证这一假设是否成立。 在图11.2和11.3中，只有1995和2000两年。引入1993年。练习：补充图11.2中1993的年取值，据此更新11.3。 可以得到，在更新后的图中，两控区婴儿死亡率在1993-1995年间轨迹与非两控区婴儿死亡率在1993-1995年间轨迹平行。背后的原因是，由于两控区城市和非两控区城市具有共同时间趋势，计算组间差异时，趋势项消掉了，组间差异在政策实施前保持不变。反之，如果共同时间趋势假设不成立，即使政策实施前，组间差异在不同的时间也不同，处理组和对照组因变量的轨迹不再平行。因此，验证共同趋势假设的一个方法是：观察两控区城市和非两控区城市的婴儿死亡率的轨迹在政策实施前是否平行。 图11.6绘制了1991-2000年两控区城市和非两控区城市婴儿死亡率的轨迹。蓝线是两控区，每一年有一个点，表示当年两控区城市婴儿死亡率的平均值。红线是非两控区。从趋势上来看，期间两控区和非两控区城市婴儿死亡率是下降的。竖线以左是政策实施前。可以看到，排除1994年，两控区城市和非两控区城市的婴儿死亡率的轨迹大致是平行的，大致可以认为具有共同时间趋势。但是，1994年，很可能没有共同时间趋势。所以，如果只使用1995-2000年的数据，估计结果可能更有说服力。 图 11.6: IMR of the treatment and control groups 资料来源：Tanaka(2015)图2。 这一检验方法基于图形，也可利用计量方法检验共同趋势假设，见附录1。 双重差分法的估计量无偏吗？ 命题：如果共同时间趋势假设成立，那么，政策虚拟变量的系数的最小二乘估计量是无偏的。 从直觉上很好理解。已如上述，如果存在共同时间趋势，经过两次差分，能把趋势性变化剔除掉，得到政策效应。 数学证明见附录2。结论：如果存在共同时间趋势，政策虚拟变量的系数的最小二乘估计量是无偏的，在平均意义上能反映因果关系。 11.3 政策分多轮推进 两控区政策是一次性在全国部分地区（两控区城市）实施的。有的时候，政策分多轮推进。2003年以来推行的财政省直管县改革（PMC reform）就是这样的例子。所谓财政省直管县改革是指，改变之前省管市、市管县的财政体制，变为省直接管理市和县的财政体制。财政省直管县改革分多轮推进。例如，2004年，湖北在大部分县进行财政省直管县改革；2007年，江苏在全省辖县进行了财政省直管县改革；而有的县至今未实施该改革。 仍可使用上一节的计量模型：\\(y_{i,t}=\\rho D_{i,t}+\\delta X_{i,t}+\\lambda_t+\\alpha_i+u_{i,t}\\)。\\(D_{i,t}\\)的含义不变（i县t年实施了改革则记为1, 否则记为0）。赋值调整如下： 图 11.7: Values of policy dummy for the PMC reform Li et al.（2016）研究财政省直管县改革对经济发展的影响。思考：预期前者影响后者的方向及理由。 作者检验了共同趋势假设。由于财政省直管县改革分多批推进，不能照搬上一节的检验方法。作者将样本期间（1995-2012年）所有实施了财政省直管县改革的县称为省直管县（不论在何时实施该改革，记其为PMC counties），在样本期间未实施该改革的县称为非省直管县（记为non-PMC counties）。计算各年两类县人均GDP的对数的均值，绘图11.8。由图可见，在2003年以前（省直管县改革尚未启动），省直管县（蓝色）和非省直管县（绿色）几乎平行，可以认为共同趋势假设成立。 图 11.8: Common trend assuption test for the PMC reform 资料来源：Li et al.（2016）图3。 文中表3列（1）-（4）的估计结果显示，财政省直管县改革对人均GDP的对数的影响显著为负。该表列（7）将因变量替换为人均夜晚灯光亮度的对数。夜晚灯光亮度是从卫星上观测的。一般来说，一地经济越发达，卫星观测到该地夜晚灯光越亮。因此，夜晚灯光亮度被广泛用作经济发展的一个度量指标。结果显示，政策虚拟变量的系数依然显著为负。说明结果具有稳健性。更换因变量为替代指标，是另一种常见的稳健性检验方法。请自学。 想想为什么财政省直管县改革抑制了经济发展？作者在表8中进行了机制分析，方法同似7.1介绍的方法。请自行阅读。 11.4 外生事件 在以上两列中，我们用双重差分法估计政策的影响。双重差分法还可用于估计事件的影响。一般，我们关注外生事件。所谓外生事件，从数学上讲，是指度量该事件的指标与干扰项不相关。直观上，外生事件应满足：偶发，不受所研究的个人、企业或地区控制。比如，张三升任财政部部长对其来源地（如出生的城市）来说就是一个外生事件——城市难以干预中央的人事任免，张三高就对其来源地来说就如中了彩票一样。所谓一人飞升，仙及鸡犬，出任财政部部长的张三是否给其来源地带来更多的转移支付？范子英和李欣（2014）就此进行了研究。定义中央部委部长来源地虚拟变量：某中央部委部长任期内，其来源地赋值为1；否则，赋值为0。使用以上介绍的计量模型即可估计部长给其来源地带来的转移支付增量。详情请阅读此文。 11.5 基于处理强度的双重差分法 以上政策和事件，要么是有，要么是没有。是有与无的差异，或1与0的差异。有的时候，差异并非如此截然二分。1999年，中国大学开启了扩招。大学扩招促进了人力资本的积累，有利于提高各行业的生产率。也就是说，各行业都因此受益。但是，不同行业受益程度并不一致。想想大学扩招对富士康促进作用更大，还是对华为促进作用更大？应该是后者。华为需要招大量大学生，而富士康对大学生的需求不大。一般地，不同行业对人力资本的需求量是不一样的。一个行业如果对人力资本的需求大，那么它因大学扩招获益大。这里就不再是0和1的差异，而是均受益、但受益程度不一的差异，受益程度可由人力资本密集度反映，人力资本密集度可以取0.05、0.3等，故可以说是0.05、0.3等的差异。可以比较人力资本密集度高的城市（看作处理组）和人力资本密集度低的城市（看作对照组）在大学扩招前后的表现，这是双重差分法的变形，称作“基于处理强度的双重差分法”。 Che and Zhang（2018）研究大学扩招这一外生事件导致的人力资本积累对企业全要素生产率（TFP）的影响。其计量模型如下： \\[\\begin{align} y_{ijt}=\\alpha_i+\\gamma_t+\\beta\\times(IndustryHC_j\\times post_t)+\\phi\\times X_{ijt}+\\epsilon_{ijt} \\tag{11.4} \\end{align}\\] 其中，i表示企业，j表示行业，t表示年份。\\(y_{ijt}\\)是属于行业j的企业i在年t的TFP。\\(\\alpha_i\\)是企业固定效应。注意，控制了企业固定效应之后就不需要控制行业固定效应了，因为行业内的企业固定效应合在一起就是行业固定效应。\\(\\gamma_t\\)是年份固定效应。\\(IndustryHC_j\\) is the human capital (HC) intensity of industry j, measured by the percentage of workers with a four-year college education or more in industry j in the US in 1980。\\(post_t\\)是2003年及以后年份的虚拟变量。1999年大学扩招的大学生首次进入劳动力市场是2003年。因此，大学扩招的效果应在2003年及往后年份发挥出来。对不同行业的差异化作用通过\\(IndustryHC_j\\)反映：预期行业人力资本密集度越高，大学扩招在2003年及往后年份对行业内企业生产率的提高作用越大，即\\(\\beta&gt;0\\)。\\(X_{ijt}\\)和\\(\\epsilon_{ijt}\\)分别表示控制变量和干扰项。 比较式(11.4)与式(11.3)，根本性的区别仅在于将TCZ这一0或1变量替换为IndustryHC这一可在0-1之间连续取值的强度变量。另外一个小的差异是，式(11.4)有三个下标。我们自可以只使用行业-年份的面板数据，计算行业的生产率，这样就只有两个下标，与此前的情形类似。企业层面的数据提供了更多的变异，如果有企业的数据，利用企业数据是一个更好的选择。这并不会导致估计上太多的麻烦。如在此例中，只需注意数据中行业内企业共用同一个人力资本密集度，将个体设置为企业（而非行业），估计命令与此前给出的命令类似。 估计结果表明：Industries using more human-capital intensive technologies experienced a larger gain in TFP after 2003（见表3）。作用机制:These industries accelerated new technology adoption。异质性分析的结果：Productivity gains weaker for domestic private firms than for foreign-owned firms（见表9）。请自行阅读文中这些内容。 需要指出的是，该文汇入一个重要的讨论中。长期来看，生产率提高和经济增长大致可以划等号（短期经济增长可以来自资源再配置，如生产要素从低效率的农村流向高效率的城市）。经济增长的源泉是什么？有两种不同的理论观点：其一，良好的制度安排导致经济增长；其二，人力资本积累导致经济增长。Che and Zhang（2018）提供了支持后一种理论观点的经验证据。这不意味着前一种理论观点就不对，下一章将深入讨论前一种理论观点，并进行经验验证。 从这个例子中可以看出，双重差分法不必是分析具体政策或事件影响的雕虫小技，通过对精心挑选的政策或事件的分析，可能和重要的经济学理论关注联系在一起，回答学术界关注的问题。 该文的发现意味着，在中国人口红利已然消失的当前，增加政府教育支出，提高高等教育质量，以此增加人力资本，对促进未来中国经济增长至关重要。 参考文献 安格里斯特, 皮施克. 基本无害的计量经济学：实证研究者指南[M]. 格致出版社, 2012, 第5.2节. 范子英,李欣.部长的政治关联效应与财政转移支付分配[J].经济研究,2014,49(06):129-141. Cai, X., Lu, Y., Wu, M., &amp; Yu, L. (2016). Does environmental regulation drive away inbound foreign direct investment? Evidence from a quasi-natural experiment in China. Journal of Development Economics, 123, 73-85. Che Y, Zhang L. Human capital, technology adoption and firm performance: Impacts of China’s higher education expansion in the late 1990s[J]. The Economic Journal, 2018, 128(614): 2282-2320. Li P, Lu Y, Wang J. Does flattening government improve economic performance? Evidence from China[J]. Journal of Development Economics, 2016, 123: 18-37. Tanaka S. Environmental regulations on air pollution in China and their impact on infant mortality[J]. Journal of health economics, 2015, 42: 90-103. "],["iv.html", "第 12 章 工具变量法：计量方法及应用 12.1 何谓“剥离”？ 12.2 二元情形 12.3 多元情形 12.4 判断备选变量是否是合格的工具变量 12.5 寻找工具变量：利用内生变量变异的外生来源", " 第 12 章 工具变量法：计量方法及应用 在2.6中，我们说明了对于简单回归——\\(y=\\alpha+\\beta x\\)，遗漏变量和反向因果会导致：\\(Cov(x,u)\\neq0\\)，即x是内生变变量。这会导致\\(\\beta\\)的OLS估计量：（1）是有偏的，因为\\(Cov(x,u)\\neq0 \\Rightarrow E[u|x]\\neq0\\)；（2）是不一致的。 怎么办？如果我们遇到的是遗漏变量问题，我们可以尝试将可能的遗漏变量加入回归。比如，在估计教育回报率的例子中，我们尝试度量IQ并加入到回归中。这是多元回归模型。有的时候，可能造成问题的遗漏因素不好测量，但如果知道它不随时间变化的话，可以通过加入个体固定效应将其纳入回归模型。这是固定效应模型。比如，在研究啤酒税对交通事故死亡率的影响时，为处理不变的酒驾社会接受度的可能影响，我们在模型中加入州固定效应。这些操作的实质是在保持这些遗漏因素不变的前提下开展研究。如不确定，请回忆多元回归和固定效应模型中系数的含义。 这一办法的局限：（1）当一个遗漏因素难以度量且随时间变化时，这一办法不适用；（2）这一办法处理不了反向因果问题。这一章要介绍的工具变量回归能克服这些局限，处理遗漏变量问题和反向因果问题。其处理问题的思路是“剥离”。 12.1 何谓“剥离”？ 比如，你昨天买了一根香蕉，今早起来发现香蕉的顶部1/4变黑了，其余3/4色泽如初。你会怎么办？有钱的话，你可以把它扔了，再买一根。也有可能，你把变黑的1/4切下来扔掉，吃掉其余3/4。也就是说，你把香蕉分成两部分：变黑的1/4和其余3/4。你认为，前一部分是有问题的部分，故而切掉扔弃。经过这一剥离之后，余下3/4没有问题，可以放心食用。 另举一例，高考答卷的名字部分要密封起来。这一做法有很长的历史，至少宋代科举就这样做了，当时称作“糊名”。明代举子杨慎参加进士考试，通过糊名可以把他分成两部分：学识部分的杨慎（写出了：滚滚长江东逝水，浪花淘尽英雄…）和身份部分的杨慎（首辅大臣的儿子）；剥离掉可能引起问题的身份部分的杨慎，仅以学识部分的杨慎去应试。 由此可见，剥离的思路其实我们已经非常熟悉了。 12.2 二元情形 考虑如下的简单回归模型：\\(y=\\beta_0+\\beta_1x+u, Cov(x,u)\\neq 0\\)。从而x是一个内生变量。 x的分解已知 假设我们能对x做如下分解：\\(x=x_1+x_2\\)，满足： \\(Cov(x_1,u)=0\\)，即\\(x_1\\)与u不相关； \\(Cov(x_2,u)≠0\\)，即\\(x_2\\)与u相关； \\(Cov(x_1,x_2)=0\\)，即\\(x_1\\)与\\(x_2\\)相关。 对照上面的例子，\\(x_2\\)相当于香蕉变黑的1/4，是有问题的部分。\\(x_1\\)相当于其余3/4，是无问题的部分。参照上一节的思路，剥离有问题的\\(x_2\\)：\\(y=\\beta_0+\\beta_1x_1+(\\beta_1x_2+u)\\)。 这里，我们将\\(x_2\\)扔到干扰项中，\\(\\beta_1x_2+u\\)合在一起，视之为一个新的干扰项，记为\\(\\epsilon\\)。计量模型由此转化为：\\(y=\\beta_0+\\beta_1x_1+ε\\)。现在的问题是：在转化后的模型中，\\(x_1\\)和\\(\\epsilon\\)不相关吗？ \\[ Cov(x_1,\\epsilon)=Cov(x_1,\\beta_1x_2+u)=\\beta_1Cov(x_1,x_2)+Cov(x_1,u)=0+0=0 \\] 因此，在转化后的模型中，\\(x_1\\)是外生变量，其OLS估计量是一致的。用y对\\(x_1\\)回归即可得到\\(\\beta_1\\)的一个一致估计量。 x的分解未知 以上假设可以把x分解成\\(x_1+x_2\\)，且分解满足上述三个性质。但问题是，怎么分解？ 我们需要更多的信息。假设有一变量z, 满足: \\(Cov(z, x)\\neq 0\\)； \\(Cov(z, u)=0\\)。 即z与x相关，但与u无关——它是一个与x相关的外生变量。 Q：基于这一信息，该如何分解？[提示：回忆2的内容] A：用x对z进行回归：\\(x=(\\delta_0+\\delta_1z)+\\eta\\)。注意，回归不要求存在因果关系（见简单回归一章）。由于\\(Cov(z, x)\\neq 0\\)，因此，\\(\\delta_1≠0\\)。验证：\\(Cov(\\delta_0+\\delta_1z, u)=0,Cov(\\delta_0+\\delta_1z,\\eta)=0\\)（如不清楚第二个等式缘何成立，回顾2的内容）。因此，定义：\\(x_1\\equiv \\delta_0+\\delta_1z, x_2\\equiv \\eta\\)。这样的分解满足上述三个条件。 估计程序分为两阶段： 第一阶段，用x对z回归，得到\\(\\hat{\\delta_0}\\)和\\(\\hat{\\delta_1}\\)，进而构建\\(x_1\\)：\\(x_1\\equiv \\hat{\\delta_0}+\\hat{\\delta_1}z\\)，也就是拟合值； 第二阶段，用y对\\(x_1\\)回归。 经此程序，我们得到\\(\\beta_1\\)的一个一致估计量。在每一阶段，都使用最小二乘法，用了两次，故称为两阶段最小二乘法（2SLS method）。 理解：在第一阶段，利用z，剥离掉x中内生的部分（that is problematic），仅余x外生的部分（that is problem-free）。第二阶段，用y对x外生的部分回归。z是一个剥离用的工具，称之为工具变量（Instrument variable，简称IV）。 12.3 多元情形 一般，我们遇到的情形是，模型中有多个解释变量：\\(y = \\beta_0 + \\beta_1x + \\beta_2w_1 +... + \\beta_{k+1}w_k +u\\)。x是核心解释变量，\\(w_1,...,w_k\\)是控制变量。假设\\(Cov(x,u)≠0, Cov(w_1,u)=0, ..., Cov(w_k,u)=0\\)，即x是内生变量，控制变量是外生变量。 假设有一组变量\\(z_1, ..., z_m\\), 满足: Instrument exogeneity：\\(Cov(z_i,u)=0\\) for i=1, …, m，即\\(z_1, ..., z_m\\)是外生变量； Instrument relevance：在x对\\(w_1, ..., w_k, z_1, ..., z_m\\)的总体回归中, \\(z_1, ..., z_m\\)的系数不为0, 即保持\\(w_1, ..., w_k\\)不变, \\(z_1, ..., z_m\\)对预测x有帮助。 第一个性质是上一节变量z性质1的重复。第二个性质较上一节变量z性质2有所变化。回顾上一节变量z性质2：\\(Cov(z, x)\\neq 0 \\Leftrightarrow \\delta_1≠0\\ (x=\\delta_0+\\delta_1z+\\eta)\\)；即z对于预测x是有帮助的。这里的区别是在回归中加入了控制变量。保持\\(w_1, ..., w_k\\)不变，\\(z_1, ..., z_m\\)对预测x有帮助，用统计学的语言讲，就是说，\\(z_1, ..., z_m\\)与x偏相关。 称满足这两个条件的变量为工具变量。 利用这些工具变量，进行两阶段最小二乘回归： 第一阶段，用OLS法估计\\(x=\\delta_0+\\delta_1w_1+...+\\delta_kw_k+\\delta_{k+1}z_1+...+\\delta_{k+m}z_m+η\\), 记拟合值为\\(x_1\\)； 第二阶段，用OLS法估计\\(y=\\beta_0+\\beta_1x_1+\\beta_2w_1+...+\\beta_{k+1}w_k+ε\\)。 注意第一阶段中也加入了控制变量，第二阶段只是把原模型的x替换为\\(x_1\\)。 命题：\\(\\beta_1\\)的2SLS估计量依概率收敛于总体参数（一致性）。 证明：仿照上一节，证明第二阶段中所有自变量都是外生变量即可。试予验证。从中可以明了为什么第一阶段需要将控制变量加入回归。 在Stata中，可以使用regress命令先后进行第一阶段和第二阶段回归。Stata也提供了一个命令自动完成这一系列过程（假设m=1，k=3）： ivregress 2sls y (x1=z1) w1 w2 w3 12.4 判断备选变量是否是合格的工具变量 以上假定满足以上两个性质的\\(z_1, …, z_m\\)给定。在此前提下，我们可以利用2SLS法一致地估计总体参数\\(\\beta_1\\)。问题在于，这样的变量需要我们自己寻找。实际中的步骤是，我们提出一些备选变量，验证这些备选变量是否满足上述两个性质。若满足，它们就是合格的工具变量；反之，则须另觅变量。 假设找到一个备选变量v，下面说明如何判断此种情形下v是否满足工具变量的两个性质。 验证v满足Instrument relevance：（1）说明v与x相关的逻辑，即说明为什么你认为v应该与x相关；（2）进行统计检验，即按照这一性质的定义，估计以下回归模型：\\(x=\\delta_0+\\delta_1w_1+...+\\delta_kw_k+\\delta_{k+1}v+η\\)。v的系数应显著不等于0，且其符号与上述v与x相关的逻辑一致。 验证v满足Instrument exogeneity：列举原来回归（非第二阶段回归）模型中干扰项u包含的因素，要求这些因素不包含v（如包含v，意味着v直接影响因变量，自不能作为工具变量），且有理由相信这些因素与v无关（如果有理由相信某个因素与v相关，则v不是合格的工具变量）。 工具变量通常难找，因此，提出多个备选变量的情况少见，不予讨论。 具体如何做，我们通过一个例子说明，这个例子援引自斯托克和沃森（2012）第12.1.5节。 例：研究美国各州香烟的需求函数：\\(Ln(Q_i)=\\alpha+\\beta Ln(P_i)+u_i\\)。其中，i表示州，Q表示香烟销量，P表示香烟价格。该模型存在反向因果：一方面，价格影响需求量（需求函数）。另一方面，市场出清时需求量就等于供给量，供给量也会影响价格（供给函数）。存在反向因果意味着，\\(Ln(P_i)\\)是内生变量。需要寻找工具变量。现提出如下的备选变量：\\(SalesTax_i\\)，表示对每包香烟征收的销售税, 由州政府设定，各州不一。 检验Instrument relevance是否成立：（1）从逻辑上讲，供给方会把部分或全部销售税转嫁给消费者，导致香烟销售税和价格正相关；（2）用\\(Ln(P_i)\\)对\\(SalesTax_i\\)回归，\\(SalesTax_i\\)的估计系数为0.031（标准误为0.005），显著异于0，且符号与逻辑一致。 检验Instrument exogeneity是否成立：\\(u_i\\)中不包含\\(SalesTax_i\\)，即后者不直接影响价格。但\\(u_i\\)中包含人均收入。一般来说，人均收入越高，对健康生活方式的需求越大，对香烟的需求越小。同时，人均收入高的州政府可能更多地依靠个人所得税筹资，而非销售税筹资，故人均收入与销售税之间存在负相关。由于人均收入是u的组成部分，有理由认为u和销售税是相关的，Instrument exogeneity不成立。说明：只需要从u中找出任一个因素与销售税相关，即可否定Instrument exogeneity；而要说服他人相信Instrument exogeneity成立，则需要列出干扰项中包含的尽可能多的因素，说明这些因素与内生变量不相关的理由。 由于Instrument exogeneity不成立，\\(SalesTax_i\\)不是一个合格的工具变量。 这个例子透露出，寻找工具变量并不是一件容易的事。这并不是说工具变量无迹可寻。存在一些寻找工具变量的套路。接下来介绍一个常用的套路。 12.5 寻找工具变量：利用内生变量变异的外生来源 所谓内生变量变异是指不同的观测值的内生变量取不尽相同的值。为什么有的观测值的内生变量取值大，而有的观测值的内生变量取值小？有很多原因。我们尝试追踪内生变量变异的外生来源，即与未纳入模型的因变量的决定因素无关的来源。基于这样的外生来源，分离出内生变量变异中的外生部分。这样做的前提是，我们对内生变量变异的来源有充分的认知，这要求我们对相关的背景有充分的了解。以下介绍循此思路的两个范例。 Hoxby（2000） Hoxby（2000）基于美国横截面数据，研究：Does Competition among Public Schools Benefit Students and Taxpayers？ 美国业务教育阶段公立学校学额分配采取租售同权原则，即一个学区内的租户也有权上该学区的公立学校。租房的成本相对较低，因此，学生及其家庭能够以较低的成本在学区间流动，导致学区间面临着争夺生源的竞争。生源竞争的激烈程度依不同都市区而有不同。本文考虑的问题是，一个都市区内学区间的竞争能否提高效率，使得学生和纳税人受益？ 计量模型如下： 图 12.1: Econometric model in Hoxby (2000) 其中，i index individual students and their associated households. k index school districts, and let m index educational markets (i.e., metropolitan areas in this paper)。\\(C_m\\) measure how much Tiebout choice exists in educational market m (e.g., the number of districts per student in the metropolitan area)。简单说，它度量都市区内学区间竞争程度。最直接的一个度量指标是，生均学区数。因变量为反映公立学校绩效的指标。 由于担心可能遗漏了一些因素，这些因素与\\(C_m\\)相关，导致\\(C_m\\)为内生变量，作者使用了如下的工具变量：number of streams-that reflect the number of natural school district boundaries in a metropolitan area。作者陈述使用这一工具变量的理由如下： Instrument relevance： The logic is that in the eighteenth and nineteenth centuries, when school district boundaries were initially set in America, an important consideration was students’ travel time to school. Natural barriers could significantly increase travel time. With automobiles, buses, paved roads, bridges, and flood controls, many of the barriers that would have caused students to travel miles out of their way are now hardly noticed. Yet, the vestigial importance of natural barriers is preserved because they determined initial school-district boundaries, which are the key supply-side factor that determines today’s boundaries. Thus, the number of school districts in a given land area at a given time of settlement was an increasing function of the number of natural barriers. I focus on streams, because they are the most common and most easily quantified natural barriers. 文中这一段阐述了streams影响学区划分的逻辑。作者继续进行了第一阶段回归：因变量为\\(C_m\\)，自变量为number of larger streams in metropolitan area、number of smaller streams in metropolitan area和控制变量。结果显示，number of larger streams in metropolitan area和number of smaller streams in metropolitan area的系数均显著为正（见文中表2），与所述逻辑一致。 Instrument exogeneity： What about the second condition for valid instrumental variables-that streams are exogenous to school productivity? The condition is highly plausible. 对此作者未给出明确的解释。我们尝试把外生性的逻辑补全。首先，number of streams不会直接影响到公立学校的绩效如学生成绩，这一点当是合理的。然后，得说明number of streams跟其他影响学生成绩的指标不相关。想一想，有的同学家住在南京市区，从家驱车来校，途中你不会注意经过了多少条溪流？除非你喜欢钓鱼。也就是说，在你的观念里，溪流不会影响到我们的学习、工作以及商业活动等——溪流跟学习、工作以及商业活动不相关。既如此，它跟学生成绩也应不相关。 第二阶段回归的结果表明，学区间竞争越大，公立学校学生12年级阅读分数越高（见文中表3），per-pupil spending越小，share of students in private school越小（见文中表5），12年级阅读分数与log(per-pupil spending)的比值越大（见文中表7）。因此，学区间竞争提高了公立学校的效率。 在这篇文章中，学区间竞争程度的变异有很多来源。作者基于对学区制度的了解，追踪到地理信息这一学区间竞争程度变异的外生来源。基于这一外生来源分离学区间竞争程度的外生部分，从而识别其对公立学校绩效的因果影响。 Acemoglu et al.（2001） 11.5提供了人力资本积累促进经济增长的经验证据。Acemoglu et al.（2001）则研究制度对经济发展的影响。 其计量模型如下: \\[ logy_i=\\mu+\\alpha R_i+X_i^{&#39;}\\gamma+\\epsilon_i \\] 符号的含义: i指国家； \\(y_i\\)是人均收入指标，具体指log GDP per capita in 1995或log output per worker in 1988； \\(R_i\\) is the protection against expropriation measure，具体指average protection against expropriation risk during 1985-1995，即产权保护程度指标，反映制度水平； \\(X_i\\) is a vector of other covariates； \\(\\epsilon_i\\) is a random error term. 作者关注前被殖民的国家。这些国家的制度水平\\(R_i\\)可能是内生变量。作者用工具变量法处理内生性。国家制度水平由很多因素决定，作者尝试从历史中寻找制度水平差异的外生来源。作者提出使用如下的工具变量: Log European Mortality Settler，即19世纪初在殖民地定居的欧洲殖民者的死亡率的对数。 验证Instrument relevance：（1）逻辑上，“Europeans adopted very different colonization policies in different colonies, with different associated institutions. In places where Europeans faced high mortality rates, they could not settle and were more likely to set up extractive institutions. These institutions persisted to the present”；（2）如图12.2的Panel B所示，第一阶段回归的结果显示，此变量显著为负，与上述逻辑一致。 验证Instrument exogeneity：由于医疗卫生条件的飞速进步，两百年前致死的疟疾、黄热等病菌现在已不足为患，不会影响今日的经济绩效。 第二阶段回归的结果见图12.2的Panel A。前8列的因变量为log GDP per capita in 1995。第9列的因变量为log output per worker in 1988。在各列中，average protection against expropriation risk during 1985-1995的系数均显著为正，表明良好的产权保护促进了经济发展。 图 12.2: Effect of institutions on economic performance 资料来源：Acemoglu et al.（2001）表4。 斯托克和沃森（2012）第12章对工具变量有更为详尽的介绍，包括工具变量法的发明，请自行阅读。 参考文献 斯托克, 沃森. 计量经济学导论(第三版)[M]. 中国人民大学出版社, 2014, 第12章. Acemoglu D, Johnson S, Robinson J A. The colonial origins of comparative development: An empirical investigation[J]. American economic review, 2001, 91(5): 1369-1401. Hoxby C M. Does competition among public schools benefit students and taxpayers?[J]. American Economic Review, 2000, 90(5): 1209-1238. "],["exp.html", "第 13 章 专题：政府支出 13.1 Government multiplier 13.2 Social insurance 13.3 Benefit incidence", " 第 13 章 专题：政府支出 在学习本章之前，请先行自学附录1。 13.1 Government multiplier 政府支出乘数的定义 政府支出乘数（government multiplier）指政府支出（G）加1单位带动总产出（Y）增加多少单位： \\[ GM\\equiv \\frac{\\Delta Y_t}{\\Delta G_t} \\] 政府支出增加1单位，直接的作用是使得总需求增加1单位。但是，政府支出增加还可能会影响消费和投资，间接地影响总产出。 政府支出乘数多大：凯恩斯主义的观点 \\(Y_t=C_t+I_t+G_t\\)。假设\\(C_t=\\alpha Y_t\\)。可推出\\(\\frac{\\Delta Y_t}{\\Delta G_t}=\\frac{1}{1-\\alpha}&gt;1\\)。以美国为例，\\(\\alpha\\)约为0.67，根据公式算出其政府乘数为3.03。很多人怀疑美国的政府支出乘数能达到这么大。 政府支出乘数多大：现代观点 现代宏观经济学假设，消费者/⼚商的⽬标是最⼤化效⽤/利润。基于此确定（最优的）消费/投资。在这一框架下，政府⽀出增加影响消费者的消费决策和厂商的投资决策。 理论分析得出，\\(GM\\ \\in\\ (0,+\\infty)\\)。区间过⼤=&gt;需要通过经验分析，了解现实中GM究竟多⼤。 计量分析：利用一国时间序列数据 如利⽤中国90年代以来的数据（每年只有⼀个观测值）。基本的计量模型如下： \\[ \\frac{Y_t-Y_{t-1}}{Y_{t-1}}=\\alpha+\\beta \\frac{G_t-G_{t-1}}{Y_{t-1}}+u \\] 其中，\\(\\beta\\)的含义：\\(G_t-G_{t-1}\\)增加1单位，\\(\\frac{G_t-G_{t-1}}{Y_{t-1}}\\)增加\\(\\frac{1}{Y_{t-1}}\\)单位，\\(\\frac{Y_t-Y_{t-1}}{Y_{t-1}}\\)增加\\(\\frac{\\beta}{Y_{t-1}}\\)单位，\\(Y_t-Y_{t-1}\\)增加\\(\\beta\\)单位。因此，政府⽀出乘数等于\\(\\beta\\)。 这样做的问题1：内生性。遗漏变量问题：税收和货币政策等与财政政策相关；反向因果问题：总产出越多，税收越多，政府支出越多。问题2：观测值少。鉴于这些问题，研究逐渐转向利用地区面板数据估计政府支出乘数。 计量分析：利用地区面板数据 如利用中国县级2000年以来的数据。优点：寻找工具变量相对容易；观测值大幅增加。基本的计量模型如下： \\[ \\frac{Y_{i,t}-Y_{i,t-1}}{Y_{i,t-1}}=\\beta \\frac{G_{i,t}-G_{i,t-1}}{Y_{i,t-1}}+\\alpha_i+\\lambda_t+u_{i,t} \\] 其中，i表示地区（省、市、县等）。\\(\\alpha_i\\)表示个体固定效应，如制度等。\\(\\lambda_t\\)表示时间固定效应，如货币政策。\\(\\frac{G_{i,t}-G_{i,t-1}}{Y_{i,t-1}}\\)可能是内生的。解决方案是寻找工具变量。 文献：Acconcia et al.(2014)，Nakamura and Steinsson（2014）。 13.2 Social insurance 本章主要从支出角度考察社保。 文献：TBD。 13.3 Benefit incidence 文献：Hastings and Washington（2010）。 思考：文中表2“Benefit household \\(\\times\\) week 2”的系数的含义。 参考文献 Acconcia A, Corsetti G, Simonelli S. Mafia and public spending: Evidence on the fiscal multiplier from a quasi-experiment[J]. American Economic Review, 2014, 104(7): 2185-2209. Hastings J, Washington E. The first of the month effect: consumer behavior and store responses[J]. American economic Journal: economic policy, 2010, 2(2): 142-62. Nakamura E, Steinsson J. Fiscal stimulus in a monetary union: Evidence from US regions[J]. American Economic Review, 2014, 104(3): 753-92. "],["rev.html", "第 14 章 专题：政府收入 14.1 Short-term tax policy 14.2 Tax regime 14.3 Tax incidence", " 第 14 章 专题：政府收入 14.1 Short-term tax policy 消费券对消费的影响 文献：Xing et al.（2020）。 加速折旧对投资的影响 文献：Zwick and Mahon（2017）。 14.2 Tax regime 文献：Zhang et al.（2018）。 14.3 Tax incidence 文献：Benzarti and Carloni（2019）。 参考文献 Benzarti Y, Carloni D. Who really benefits from consumption tax cuts? Evidence from a large VAT reform in France[J]. American Economic Journal: Economic Policy, 2019, 11(1): 38-63. Xing J, Zou E, Yin Z, et al. ” Quick Response” Economic Stimulus: The Effect of Small-Value Digital Coupons on Spending[R]. National Bureau of Economic Research, 2020. Zhang L, Chen Y, He Z. The effect of investment tax incentives: evidence from China’s value-added tax reform[J]. International tax and public finance, 2018, 25(4): 913-945. Zwick E, Mahon J. Tax policy and heterogeneous investment behavior[J]. American Economic Review, 2017, 107(1): 217-48. "],["intgovt.html", "第 15 章 专题：政府间关系（并模糊断点回归） 15.1 Intergovernmental transfers 15.2 Place-based policy 15.3 Unfunded mandate", " 第 15 章 专题：政府间关系（并模糊断点回归） 15.1 Intergovernmental transfers Q：中央对地方的转移支付增加1单位，地方政府支出增加多少单位？ 考虑下面的例子：某大学生旧例每年从父母那里拿15000，支出15000。某年获得奖学金5000。当年支出多少？从父母那里拿多少钱？可能支出不是20000，而是16000，因为想着父母挣钱不易（父母的效用进入其效用函数），少拿一点他们少辛苦一分，只从父母处拿11000。 从财政学角度解读这个例子。父母：纳税人，子女：地方政府。纳税人给地方政府缴税，相应地，地方政府提供公共品，比如，在考试或社团活动中表现突出，给全家带来喜悦。现在，子女作为地方政府获得一笔来自中央政府的为数5000的转移支付，将其中的一部分用作消费，另一部分给作为纳税人的父母减税。具体来说，消费增加1000，给父母减税4000。 一般地，中央对地方的转移支付增加1单位，假设地方政府最大化社会福利，它会从社会最优的角度安排这多出来的1单位钱，如是考虑：这笔钱属于人民，人民希望如何花？人民将这笔钱分成两块，一块购买私人品，另一块购买公共品，后者即人民希望政府支出增加多少，前者反映人民希望政府减税多少。通常，人民希望更大的比例用于购买私人品，意味着中央对地方的转移支付增加1单位，地方政府支出增加少于0.5单位，减税多于0.5单位。这是理论预测，数据支持这一理论预测吗？ 文献：Lundqvist（2015）。 思考：该文的结果支持上述理论预测吗？如不支持，如何解释结果？ 15.2 Place-based policy Place-based policy，中文叫做区域政策，一般指中央在不同地区实施不同的政策。政策因地而异，即英文所谓place-based。区域政策在世界范围内普遍存在。支持区域政策的理由如big push theory。很多时候，中央扶持落后地区。但也有中央向发达地区倾斜资源的情况。 改革开放后，中国的区域政策包括（但不限于）：八七扶贫攻坚计划、西部大开发政策、支持粤港澳大湾区发展的政策等。前两个政策意在支持落后地区，最后一个政策意在支持发达地区。可以看到，中国的区域政策经历了一个从注重公平（缩小地区差距）到重视效率（发挥集聚效应）的转向。重视效率不必然损害公平，如果粤港澳大湾区经济集聚吸收了中西部的劳动力，有助于提高这些劳动力的工资，并提高其来源地劳动的边际产出。 Meng（2013）研究八七扶贫攻坚计划是否提高了农民人均纯收入。下面介绍这篇文章（做了简化）。我们也通过这个例子说明模糊断点回归的含义及处理方法。回顾：6介绍了清晰断点回归。在这一章的引例中，\\(GPA\\ge3.9\\)，授予奖学金；\\(GPA&lt;3.9\\)，不授予奖学金。断点指3.9，清晰是什么含义？ 政策背景 八七扶贫攻坚计划于1994年实施。其模式是，选取若干国家级贫困县（National Poor Counties），予以扶持。一个重要的选择标准：1992年的农民人均纯收入是不是低于700元。注意该政策酝酿于1993年，此时，1992年的农民人均纯收入已经给定，不能再被操纵。这不是绝对的标准，也就是说，并不是说，一个县农民人均纯收入低于700元，就一定能入选；或者一个县农民人均高于700元，就一定无法入选。除人均纯收入以外，还有其他因素影响入选，如政治关联，与中央有强政治关联的县可能说服中央让其加入八七计划，即便其农民人均纯收入较高。 图15.1展示了农民人均纯收入与入选国家级贫困县的概率之间的关系。横轴是（农民人均纯收入-700）。所以，横轴小于0表示农民人均纯收入低于700；大于0表示农民人均纯收入高于700。将横轴分成宽度为20元的区间若干，如(-40，-20]、(-20，0]、(0，20]等。对每一个区间，计算落入这个区间的县入选国家级贫困县的频率（如该区间内10个县有7个入选，则入选频率为70%），将这一频率画到图中，即为图中的一个圆圈，圆圈的大小反映该区间内县的数量。由图可见，农民人均纯收入高于700和低于700都有可能入选国家级贫困县。但从高于700一侧走向低于700一侧，入选概率陡然提高。 图 15.1: Farmer Income and national poor counties 资料来源：Meng（2013）图4。 最终确定了592个国家级贫困县，如图15.2中红色区域所示。 图 15.2: Illustration of national poor counties 资料来源：Meng（2013）图3。 The 8-7 Plan has three major interventions for poverty reduction： First, targeted counties received credit assistance，即信贷优惠； Second, the Ministry of Finance provided budgetary grants for investment in poor counties，主要是提供专项转移支付，支持这些县的基础设施建设； Third, public employed projects were established in designated areas，即安排以工代赈项目。 计量设置 计量模型如下： \\[ \\Delta logy_i=\\beta_0+\\beta_1NP94_i+\\phi(y_i^{92})+\\epsilon_i \\] 其中，i表示县。\\(NP94_i\\)是国家级贫困县的虚拟变量：是国家级贫困县记为1，否则记为0。\\(y_i\\)表示县i的农民人均纯收入。\\(\\Delta log(y_i)\\)近似等于县i的农民人均纯收入在一段时间内的增长率。\\(\\phi(y_i^{92})\\)是1992年农民人均纯收入的多项式。一次项就是\\(y_i^{92}\\)，二次项为\\(y_i^{92}+(y_i^{92})^2\\)，以此类推。一个县如果特别穷，其发展的空间也就大，增长率可能高。\\(\\epsilon_i\\)是干扰项。 问题在于，可能存在遗漏变量问题：刚提到，一个县与中央的政治关联强，有助于这个县成为国家级贫困县，即两者是正相关的；政治关联还可能为这些县带来其他有利于经济发展的资源，故其本身也会影响县域经济发展，构成干扰项的一部分。因此，有理由担心，u与\\(NP94_i\\)相关，故\\(NP94_i\\)是一个内生变量。 一个解决方法是寻找工具变量。怎么样寻找工具变量？12.5讲过寻找工具变量的一个思路：利用内生变量变异的外生来源。套用于此处，我们要思考哪些因素决定一个县能否入选国家级贫困县，从中找出外生的因素。一个显而易见的外生因素是中央的选择标准：1992年农民人均纯收入否低于700元。刻画这一标准的变量为：\\(Eligible_i≡1(y_i^{92}&lt;700)\\),如果一个县1992年农民人均纯收入低于700元，它记为1，否则它记为0。前已说明，这一变量与\\(NP94_i\\)正相关。这一标准是中央制定的标准，适用于全国，与干扰项——影响单个县农民人均纯收入增长的因素——很可能不相关。例如，没有理由认为一个县的政治关联在700元左右有一个跳跃式的变化。 估计结果 设因变量为\\(logy_i^{2000}-logy_i^{1994}\\)，近似等于1994-2000年农民人均纯收入的增长率。估计结果见图15.3。Panel A是第一阶段回归的估计结果，Panel C是第二阶段回归的估计结果。列（1）自变量只包含NP94，列（2）加入了1992年农民人均纯收入作为控制变量，列（3）继续加入1992年农民人均纯收入的二次方作为控制变量，列（4）继续加入了其他县层面的控制变量。以列（4）为列，结果表明：the program has increased per capita income by approximately 38% during the program period of 1994 to 2000。 图 15.3: Results for 94-00 change in log income per capita 资料来源：Meng（2013）表4。 图15.4设因变量为\\(logy_i^{2003}-logy_i^{1994}\\)。此表列（1）与上表列（4）自变量相同。此表列（1）的估计结果表明：the program has increased per capita income by approximately 28% during the program period of 1994 to 2003。入选国家级贫困县使得农民人均纯收入在1994-2000年间增长了38%，在1994-2003年间只增长了28%，说明：the programma have had only sizeable short-run effects that began to decay just a few years after its implementation。 图 15.4: Results for 94-03 change in log income per capita 资料来源：Meng（2013）表6。 兼论模糊断点回归 从另一个角度考虑上文。1992年的农民人均纯收入低于700元不一定被选为国家级贫困县，高于700元不一定落选国家级贫困县——满足这一标准（&lt;700）与是否入选之间的关联具有模糊性，此其一。从1992年的农民人均纯收入高于700元一点点走向低于700元一点点入选国家级贫困县的概率有一个跳跃式增加，这意味着，虽然这一标准（&lt;700）与是否入选之间的关联具有模糊性，但这一标准对于预测入选国家级贫困县的概率是有帮助的，此其二。称满足以上两点的为“模糊断点回归”。 如上所示，模糊断点回归（Fuzzy RDD）可用2SLS方法处理。从这个角度，可以将Fuzzy RDD视为2SLS的一个特例。而在6中，我们已说明，清晰断点回归可以用多元回归处理，从这个角度，可以把它看作是多元回归的一个特例。这是对断点回归的一些可能的处理方式。断点回归还可以用非参数的方法处理，这超出了本讲义的写作范围。 15.3 Unfunded mandate 文献：TBD。 注：财政联邦主义的文献已讲过，本章不再重复。 参考文献 Lundqvist, H. (2015). Granting public or private consumption? Effects of grants on local public spending and income taxes. International Tax and Public Finance, 22(1), 41-72. Meng L. Evaluating China’s poverty alleviation program: a regression discontinuity approach[J]. Journal of Public Economics, 2013, 101: 1-11. "],["oth.html", "第 16 章 其他公共经济学问题 16.1 Public choice 16.2 Environmental regulation", " 第 16 章 其他公共经济学问题 公共经济学涵盖主题甚广，难以一一讲解。本章选讲公共选择和环境规制的经验文章。 16.1 Public choice 文献：Wang and Yao（2007）。 16.2 Environmental regulation 文献：Gong et al.（2021）。 参考文献 Gong C, Zhang J, Liu H. Do industrial pollution activities in China respond to ecological fiscal transfers? Evidence from payments to national key ecological function zones[J]. Journal of Environmental Planning and Management, 2021, 64(7): 1184-1203. Wang S, Yao Y. Grassroots democracy and local governance: Evidence from rural China[J]. World Development, 2007, 35(10): 1635-1649. "],["附录.html", "附录 附录1：双重差分法：共同趋势假设检验及动态效应分析 附录2：双重差分法的估计量无偏吗？ 附录3：Stata操作指引 附录4：科学写作", " 附录 附录1：双重差分法：共同趋势假设检验及动态效应分析 基于11.2的例子进行说明。利用两控区政策实施前的数据检验共同趋势假设。为简化，只考虑1995和1996年。如下表所示。1995年的情况如图11.2对应列。这里假设当年两控区城市和非两控区城市具有相同的时间趋势项\\(\\lambda_{1995}\\)。这始终是可以做到的：若当年两者的时间趋势项不同，可以将二者的差异放到个体固定效应中，经此调整后，当年两者的时间趋势项相同。1996年，非两控区城市i的时间趋势项是\\(\\lambda_{1996}\\)，而两控区城市j的时间趋势项是\\(\\lambda_{1996}+\\Delta\\lambda\\)，\\(\\Delta\\lambda\\)为两者时间趋势变化的差异。共同趋势成立 \\(\\Leftrightarrow\\) \\(\\Delta\\lambda=0\\)。 表A1 1995 1996 TCZ \\(\\lambda_{1995}+\\alpha_i\\) \\(\\lambda_{1996}+\\Delta\\lambda+\\alpha_i\\) non-TCZ \\(\\lambda_{1995}+\\alpha_j\\) \\(\\lambda_{1996}+\\alpha_j\\) 因此，检验共同趋势假设是否成立的方法是估计如下的计量模型： \\[ y_{i,t}=\\Delta\\lambda\\times TCZ_i\\times Year_{1996}+\\delta X_{i,t}+\\lambda_t+\\alpha_i+u_{i,t},\\ t=1995, 1996 \\] 只使用1995和1996年的数据。如果\\(\\Delta\\lambda\\)的系数不显著异于0，则可认为共同趋势假设成立；反之，认为共同趋势假设不成立。 注意：模型中没有变量\\(TCZ_iYear_{1995}\\)。因为为了分析的简便，我们在表A1中强令1995年两控区城市和非两控区城市的时间趋势项相同，这就是说，我们强行施加了假设：\\(TCZ_iYear_{1995}\\)的系数为0。 现实中，政策实施后在各年的效果可能不一样，是为政策的动态效应。原因有很多，如政策力度在各年不一。回到上例。假设共同趋势假设成立。设两控区政策使婴儿死亡率降低的幅度在1998和2000年分别为\\(\\rho_{1998}\\)和\\(\\rho_{2000}\\)。制表如下： 表A2 1995 1998 2000 TCZ \\(\\lambda_{1995}+\\alpha_i\\) \\(\\rho_{1998}+\\lambda_{1998}+\\alpha_i\\) \\(\\rho_{2000}+\\lambda_{2000}+\\alpha_i\\) non-TCZ \\(\\lambda_{1995}+\\alpha_j\\) \\(\\lambda_{1998}+\\alpha_j\\) \\(\\lambda_{2000}+\\alpha_j\\) 估计下面的模型即可得到政策在1998和2000年的效应： \\[ y_{i,t}=\\rho_{1998}\\times TCZ_i\\times Year_{1998}+\\rho_{2000}\\times TCZ_i\\times Year_{2000}\\\\+\\delta X_{i,t}+\\lambda_t+\\alpha_i+u_{i,t},\\ t=1995, 1998, 2000 \\] 注意，只用到1995、1998和2000年的数据。 可以把共同趋势假设检验和政策动态效应估计放到一起进行。Tanaka（2015）使用了1991-2000年的数据，为达此目的，将计量模型设置为： \\[ y_{i,t}=\\rho_{1992}TCZ_iYear_{1992}+\\rho_{1993}TCZ_iYear_{1993}+\\rho_{1994}TCZ_iYear_{1994}\\\\+\\rho_{1995}TCZ_iYear_{1995}+\\rho_{1996}TCZ_iYear_{1996}+\\rho_{1997}TCZ_iYear_{1997}\\\\+\\rho_{1998}TCZ_iYear_{1998}+\\rho_{1999}TCZ_iYear_{1999}+\\rho_{2000}TCZ_iYear_{2000}\\\\+\\delta X_{i,t}+\\lambda_t+\\alpha_i+u_{i,t},\\ t=1991,1992,...,2000 \\] 如果\\(\\rho_{1992}, \\rho_{1993}, \\rho_{1994}, \\rho_{1995}, \\rho_{1996}, \\rho_{1997}\\)都不显著，可以认为共同趋势假设成立；反之，则不成立。如果共同趋势假设成立，\\(\\rho_{1998}, \\rho_{1999}, \\rho_{2000}\\)的估计系数反映了政策的动态效应。 附录2：双重差分法的估计量无偏吗？ 命题：如果共同时间趋势假设成立，那么，政策虚拟变量的系数的最小二乘估计量是无偏的。 Please see a proof for the case with only two periods, one period before a policy and the other after the policy. 图A1：Proof for the unbiasness of the DID estimator 附录3：Stata操作指引 Stata本身的帮助文档提供了命令的使用指导。如欲知如何使用regress命令，在Stata命令框中输入：“help regress”，即跳出对该命令使用的详细说明，包括举例。 陈强（2015）所著《计量经济学及Stata应用》介绍了常见的计量模型在Stata中的实现，可作为Stata操作的工具书翻阅。 也可以求助Stata操作于AI。自Chatgpt问世，AI展现了强大的能力。可用作科研助手。国外的AI包括：Chatgpt、Copilot和Claud等。国内的AI包括：通义千问、星火大模型等。以下是我与某AI一段连续问答，藉此说明如何把AI变成我们使用Stata时的助手： 问：你好，我手头有一个横截面数据，名为“WAGE1.dta”，它每一个观测值表示一个人，共有526个观测值。我已在stata中打开这一数据。数据中有一个变量名为y，它表示工资的对数。还有一个变量名为x，表示受教育年限。我想用y对x回归，请问应使用什么命令？ AI答：您好！您可以使用以下命令进行回归：reg y x。其中，y是被解释变量，x是解释变量。如果您想要去掉截距项，可以使用以下命令：reg y x, noconstant。 问：我想用y对x回归，只用前480个观测值，用什么命令？ AI答：您好！您可以使用以下命令进行回归：reg y x in 1/480。其中，y是被解释变量，x是解释变量，in 1/480表示只用前480个观测值。如果您想要去掉截距项，可以使用以下命令：reg y x in 1/480, noconstant。 问：我想计算y和x的相关系数，使用什么命令？ AI答：您好！您可以使用以下命令计算y和x的相关系数：pwcorr y x。如果您想要计算偏相关系数，可以使用以下命令：pcorr y x。 问：我想生成一个变量z，它取值为x的10倍，使用什么命令？ AI答：您好！您可以使用以下命令生成一个变量z，它取值为x的10倍：gen z = 10*x。 问：用工资的对数对受教育年限回归，受教育年限的系数是什么含义？ AI答：当用工资的对数对受教育年限回归时，受教育年限的系数表示的是：当工资的对数增加1个单位时，受教育年限的变化量。 问：I regress the logarithm of wage on years of education. How do I interpret the coefficient of years of education? AI答：When you regress the logarithm of wage on years of education, the coefficient of years of education represents the percentage change in wage associated with a one-unit increase in years of education. 说明： AI回答的质量依赖于问问题的质量（准确性和方式等），提高提问题的水平很重要； AI的回答未必是正确的，须予查证； AI基于概率模型，所以，重复问相同的问题，得到的回答未必完全相同； 使用中文和英文提相同的问题，得到的答案可能很不一样，这是由于训练AI的中英文素材不一样。 附录4：科学写作 Gopen（1990）写道： In our experience, the misplacement of old and new information turns out to be the No.  1 problem in American professionalwriting today. 所谓旧信息（old information）指已在前文中出现过的信息，新信息（new information）指首次出现的信息。 应该怎么做？Gopen（1990）继续写道： Put in the topic position the old information that links backward; putinthe stress position the new information you want the reader to emphasize. 例：“图书馆前有一只猫。这只猫是白色的。”在第一句中，“猫”已出现，故对第二句来说，“这只猫”属于旧信息，出现在第二句开头；“白色”是新信息，出现在第二句结尾。 ACEMOGLU et al.（2001）第一段： What are the fundamental causes of the large differences in income per capita across countries? Although there is still little consensus on the answer to this question, differences in institutions and property rights have received considerable attention in recent years. Countries with better “institutions,” more secure property rights, and less distor tionary policies will invest more in physical and human capital, and will use these factors more efficiently to achieve a greater level of income (e.g., Douglass C. North and Robert P. Thomas, 1973; Eric L. Jones, 1981; North, 1981). This view receives some support from cross-country correlations between measures of property rights and economic development (e.g., Stephen Knack and Philip Keefer, 1995; Paulo Mauro, 1995; Robert E. Hall and Charles I. Jones, 1999; Dani Rodrik, 1999), and from a few micro studies that investigate the relationship between property rights and investment or output (e.g., Timothy Besley, 1995; Christopher Mazingo, 1999; Johnson et al., 1999). 注意：每一句都以旧信息开头（加粗显示）。 这一原则也适用于中文科学写作。且看金庸《倚天屠龙记》： 第四回 字作丧乱意彷徨 忽听得背后有人幽幽叹了口气。这一下叹息,在黑沉沉的静夜中听来大是鬼气森森,张翠山霍地转身,却见背后竟无一人,游目环顾,除了湖上小舟中那个单身游客之外,四下里寂无人影。张翠山微觉惊讶,斜睨舟中游客,只见他青衫方巾,和自己一样,也是作文士打扮,朦胧中看不清他的面貌,只见他侧面的脸色极是苍白,给碧纱灯笼一照,映着湖中绿波,寒水孤舟,冷冷冥冥,竟不似尘世间人。但见他悄坐舟中,良久良久,除了风拂衣袖,竟是一动也不动。 … 忽听得桨声响起，小舟已缓缓荡向湖心，但听那少女抚琴歌道：“今夕兴尽，来宵悠悠，六和塔下，垂柳扁舟。彼君子兮，宁当来游？”舟去渐远，歌声渐低，但见波影浮动，一灯如豆，隐入了湖光水色。 第五回 皓臂似玉梅花妆 钱塘江到了六和塔下转一个大弯，然后直向东流。该处和府城相距不近，张翠山脚下虽快，得到六和塔下，天色也已将黑，只见塔东三株大柳树下果然系着一艘扁舟。钱塘江中的江船张有风帆，自比西湖里的游船大得多了，但船头挂着两盏碧纱灯笼，却和昨晚所见的一般模样。张翠山心中怦怦而跳，定了定神，走到大柳树下，只见碧纱灯下，那少女独坐船头，身穿淡绿衫子，却已改了女装。 … 张翠山本来一意要问她昨晚的事，这时见她换了女子装束，却踌躇起来，忽听那少女仰天吟道：“抱膝船头，思见嘉宾，微风波动，惘焉若醒。” 文字特点：符合科学写作的要求；常省略，短句多，长短交错，体现了中文的优美（节奏感，韵律感）。 参考文献 陈强. 计量经济学及Stata应用[M]. 高等教育出版社, 2015. Gopen G D, Swan J A. The science of scientific writing[J]. American scientist, 1990, 78(6): 550-558. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
