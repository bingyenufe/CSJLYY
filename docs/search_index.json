[["index.html", "财税计量应用讲义 序言", " 财税计量应用讲义 叶兵 2022-07-24 序言 本书的写作动机 国内本科计量经济学教学和研究严重脱节。这不是说研究高深莫测，超出了本科生的理解范围。实际上，计量经济学研究用到的主流的方法并不难理解。 市面上不乏好的计量经济学教材，如伍德里奇（2015）、斯托克和沃森（2012）、安格里斯特和皮施克（2012）。但这些书内容芜杂，涉及到过多的数学，侧重理论，涉及应用较少。 实有必要写这样一本书：内容可控，数学尽量简单，本科生容易理解，学习后能读懂大部分应用计量文章，并能开展简单的研究。这是本书的目的。 本书最贴合的目标对象是公共经济学的本科生，因为书中举的大部分例子属于公共经济学领域。但由于经济学各子学科所用计量方法实无太大的差异，本书也能满足经济学大类本科生的要求。 前置知识 本书的前置知识括《概率论与数理统计》《统计学》《财政学》《公共支出管理》的知识。本书也会对涉及到的知识做简要回顾。 本书的内容 各章目次如下： 章序号 章名 第一章 导论 第二章 二元线性回归 第三章 多元线性回归：估计 第四章 多元线性回归：统计推断 第五章 定性信息 第六章 清晰断点回归 第七章 机制和异质性分析 第八章 一致性 第九章 面板数据模型：计量方法及应用 第十章 基于面板数据的双重差分法：计量方法及应用 第十一章 工具变量法：计量方法及应用 第十二章 科学写作 第十三章 专题：政府支出 第十四章 专题：政府收入 第十五章 专题：政府间关系（含模糊断点回归） 第十六章 其他财税问题 本书分为两部分。第一部分讲当前公共经济学领域应用计量研究中最流行的几种方法。在讲方法的时候穿插应用。在这部分，作者大量采取拿来主义的做法，凡在文献中已经有很好的表述的，只提供一个指向该文献的指针，以示对原作者知识产权的尊重。只有那些在文献中找不到表述，或文献中的表述不适合本科生的，才提供完整的文本。 第二部分以专题的形式讲这些计量方法的应用。 两部分涉及应用，作者都通过讲解一流英文杂志上公共经济学领域的文章展示。 软件实现 本书既名《财税计量应用》，就强调应用，要求学生能够利用专业的计量软件Stata估计各计量模型的结果。为此，我们录制了配套视频，循序渐进地教读者使用Stata进行相关操作。 读者还可以通过以下渠道学习Stata： Stata帮助文档 陈强. 计量经济学及Stata应用[M]. 高等教育出版社, 2015 遇到问题在网上搜索问题的关键词 参考教材 伍德里奇. 计量经济学导论(第五版)[M]. 中国人民大学出版社, 2015. 斯托克, 沃森. 计量经济学[J]. 格致出版社, 2012. 安格里斯特, 皮施克. 基本无害的计量经济学：实证研究者指南[M]. 格致出版社, 2012. 叶兵 于紫东 "],["intro.html", "第 1 章 导论 1.1 相关和因果关系 1.2 估计总体均值 1.3 计量经济学的性质与经济数据 1.4 数学知识复习", " 第 1 章 导论 1.1 相关和因果关系 What is Correlation? Correlation is a relationship or connection between two or more objects. If X and Y, two variables, tend to be observed at the same time, there’ s a correlation between them. You cannot say X caused Y, you will simply say that when X and Y are observed together. Positive Correlation: When variable X increases, variable Y also increases. Similarly, if X decreases, Y correspondingly decreases. Negative Correlation: When variable X increases, variable Y decreases, or vice versa. No Correlation: Any change in X leads to no change in Y, or vice versa. A correlation is a statistical measure that we use to describe the linear relationship between two continuous variables. What is Causation? Unlike Correlation, the relationship is not because of a coincidence. We are saying that X causes V, or vice versa. It means that the existence of one variable causes the manifestation of another. “cause”是什么意思？这里所谓导致是指其他条件不变的情况下，如果X变化，Y也随之变化，那么我们就说X导致了Y，X和Y具有因果关系（X-&gt;Y的因果关系）。在微观经济学中，需求函数就是说价格和需求之间存在负向因果关系：如果价格提高，需求会减少。隐含的假设是，价格提高的时候，其他因素（包括偏好、其他商品的价格和收入等）一概不变，这时需求才会减少。如果价格提高的时候，收入也提高，需求不一定减少。 What’s the difference between correlation and causation? Causation explicitly applies to cases where action A Causation explicitly applies to cases where action A causes outcome B. causes outcome B. On the other hand, correlation is simply a relationship. Action A relates to Action B—but one event doesn’t necessarily cause the other event to happen. However, we cannot simply assume causation even if we see two events happening, seemingly together, before our eyes. One, our observations are purely anecdotal. Two, there are so many other possibilities for an association, including but not limited to: The opposite is true: B actually causes A. 反向因果 The two are correlated, but there’s more to it: A and B are correlated, but they’re actually caused by C. 例：图 1.1。在该图中，溺死数和冰淇淋消费量是相关关系，而非因果关系。实际上，是天热导致溺死数和冰淇淋消费量同时增加。更一般地，A不影响B, C-&gt;B, and A and C are correlated. A和B之间的相关关系完全由C导致=&gt;遗漏变量 另一种情形：A-&gt;B, C-&gt;B, and A and C are correlated. A和B之间的相关关系在部分程度上由C导致。例：A是受教育程度，B是毕业后的收入。通常，我们观测到，受教育程度更高的人的平均收入也更高。但是，其高收入并不完全由教育导致，还可能有别的因素起作用：如为受教育程度更高的人的平均IQ更高，高的IQ也会导致高收入=&gt;遗漏变量 图 1.1: Drowning deaths and ice-cream consumption 判断正误 Correlation =&gt; Causation. False Causation =&gt; Correlation. False: think of nonlinear causation 测试题 题目1: 在美国金融危机后，我国推出了“四万亿”投资，经济随之企稳，如图 1.2 所示： 图 1.2: Economic growth rate: 2008-2009 Q: “四万亿”投资与GDP增长率(2019Q1-&gt;2019Q4)提高5.5%是（前者-&gt;后者的）因果关系吗? 题目2: 东部地区基础设施存量多1万亿(假设值), 人均GDP高2万元(假设值)。Q: 前者与后者是（前者-&gt;后者的）因果关系吗? 识别因果关系 何为识别因果关系？把确定两个变量之间是否具有因果关系的过程叫做识别因果关系。在英文里面叫做“identification”。 识别因果关系的经典方法:随机实验法 识别因果关系的经典方法：随机实验法，在英文里面叫做random experiment。借鉴自自然科学，核心是随机分组。比如，研究肥料对作物收成的影响。这里是一种因果关系含义上的影响。隐含的假设是，只肥料这一个因素改变——肥料增加一单位，其他影响作物收成的因素（包括土地质量、降雨量、寄生物等）均保持不变，大豆的产出增加多少？用随机实验处理这个问题的思路：找到若干块土地，如100，每块土地的大小都是一样的，如1亩。将这些土地随机分成两组。因为是随机分组，所以这两组土地的情况平均来说是相同的。然后对其中一组不施肥，对另外一组施1单位的肥料。用施肥组的平均作物收成减去不施肥组的平均作物收成，看它为正还是为负，藉此判断肥料对作物收成的影响。 这一差值反映了因果关系。为何？回忆：因果关系是说其他因素不变，只肥料变化作物产出如何变化。这里，因为分组是随机的，两组的情况平均而言是相同的，除肥料使用量。所以，作物收成的差异平均而言反映了施肥量的影响。 在社会科学中使用随机实验法的局限 局限其一。试看下例。教育回报率指受教育程度提高，比如说受教育程度从高中提高到大学，会使得收入如何变化？这是一个因果关系含义上的概念。隐含的假设是，受教育程度提高时其他影响收入的因素（IQ、家庭环境等）都保持不变。如果用随机实验法，做法是：找一些小孩，随机地给他们不同年限的教育，继而比较他们成年后的收入。因为他们的受教育年限是随机的，所以他们成年后的收入差异（平均而言）反映了受教育年限的差异。但是，这里存在道德伦理方面的问题：为什么给一些小孩更高的教育年限，而给另外一个小孩更低的教育年限。对此很多人不会认同。一般地，从伦理道德的角度，很多时候随机实验法在社会科学中不可行。 局限其二。仍看一例。研究交通基础设施对经济增长的影响。用随机实验法处理这一问题：去落后地区找一些不通路的村子，如找100个村子。将其随机分成两组，一些给修路，一些不给修路。然后看那些给修路的村子在路通之后经济发展是否更好。问题在于，修路贵。给50个村修路，即使不花几千万也得花几百万。哪个研究者有这么多钱搞这个研究？随机实验法成本高，故需开发多种经济的计量方法识别因果关系。 总之，该讲义的核心就是介绍多种计量方法，以识别因果关系。 1.2 估计总体均值 问题：如何估计一个随机变量Y的总体均值\\(\\mu\\)？ 随机抽样，用样本均值估计总体均值: \\(\\bar{y} = \\frac{ \\sum_{i=1}^N y_i }{N}\\)。例：掷硬币，掷到正面记1，掷到反面记-1，易知总体均值是0。假设我们不知道总体均值，可以随机抽取30个观测值（掷10次硬币），计算样本均值，作为总体均值的估计。 样本均值具有一个良好的性质：样本均值使下面的函数达到最小值: \\[\\begin{align} f(m) = \\sum_{i=1}^N (y_i-m)^2 \\tag{1.1} \\end{align}\\] 假设随机抽取了3个观测值：\\(y_1\\)，\\(y_2\\)，\\(y_3\\)，如图1.3所示： 图 1.3: 通过随机抽样估计总体均值 纵轴就表示观测值大小；横轴1表示第一个观测值，以此类推。给定一个数m，可以画出水平线，将图中最左边垂线的平方定义为m到第一个观测值（点）的距离，即\\((y_1-m)^2\\)。类似地，m到第2和3个观测值的距离分别为\\((y_2-m)^2\\)和\\((y_3-m)^2\\)。三者相加，就是\\(f(m)\\)，反映数m（水平线）到这三个观测值（点）的总距离。不同的m，到这些观测值的总距离不一样。m取什么值时总距离最小？答案就是样本均值（请自行验证）。 样本均值是一个随机变量：今天随机掷30次硬币，计算得出一个样本均值。明天再掷30次硬币，也计算出一个样本均值。如此下去10000天。往往各天的样本均值不一样，亦有别于总体均值。 样本均值作为一个随机变量具有统计性质，有期望，也有方差。\\(E[ \\bar{y} ] = \\mu\\)。虽然往往各天的样本均值不同，但如果对这10000个样本均值给求平均，那么它大概等于总体均值。平均而言，估计是准确的（简单来说，期望就是平均的意思）。 Y的方差多大？假设\\(Y\\sim N(\\mu,1)\\),\\(Var[\\bar{y}]=\\frac{1}{N}\\),\\(\\bar{y}\\sim N(\\mu,\\frac{1}{N})\\)。 给定其分布，可以构建置信区间： \\[\\begin{align} Prob\\left( \\lvert \\frac{ \\bar{y}-\\mu }{ 1 \\div \\sqrt{N} } \\rvert \\leq 1.96\\right) = 0.95 \\Rightarrow Prob\\left( \\bar{y} - \\frac{1.96}{\\sqrt{N}} \\leq \\mu \\leq \\bar{y} + \\frac{1.96}{\\sqrt{N}} \\right) = 0.95 \\tag{1.2} \\end{align}\\] 基于置信区间，可做假设检验。原假设\\(H_0:\\mu=0\\)。如果置信区间包含0，那么我们不能拒绝原假设；否则，我们就要拒绝原假设。（以上数学公式如不明白，请翻阅前置课程统计学、概率论与数理统计的相关内容） 还是同样一个过程，换一个顺序说明，分为5个步骤： 第一步, 建立（计量）模型:\\(\\epsilon_{(i)}=Y_{(i)}-\\mu\\)。表示抽到的第i个值对总体均值的偏离。为了简便，在不引起混淆的时候把下标i省略掉。Y是一个随机变量, \\(\\mu\\)是一个确的定值，尽管未知待估。因此，\\(\\epsilon\\)是一个随机变量，E[\\(\\epsilon\\)]=0。模型转换：Y=\\(\\mu\\)+\\(\\epsilon\\),E(\\(\\epsilon\\))=0。这就是Y的统计模型，或者叫计量模型。 第二步，随机抽样 &lt;- 有了计量模型我们需要数据。假设抽到N个观测值。 第三步, 估计总体参数\\(\\mu\\)：\\(Min_m f(m) = \\sum_{i=1}^N (y_i -m)^2 \\Rightarrow m^*=\\bar{y}\\)。直观的理解：进行随机抽样，抽到多个观测值。这些观测观测值应该围绕着总体均值上下波动的。有时抽到的观测值比将总体均值大，而有时抽到的观测值比总体均值小。观测数很多时，大于总体均值和小于总体均值的个数大致相当。反过来说，总体均值处于抽到的观测值的中间，总的来说离观测值的近。因此，一个自然的想法是，选择距观测值最近的数作为总体均值的估计。样本均值是总体均值的一个估计量。上式最小化距离平方和，因此称称作最小二乘法。 第四步, 推导估计量的期望和方差, 公式已在上面给出。 第五步, 构建置信区间, 进行假设检验。 这5步其实就是计量经济学里面最核心的5步。后续的计量分析主要照此召开。 1.3 计量经济学的性质与经济数据 见伍德里奇《计量经济学导论：现代观点》第五版第1章。 1.4 数学知识复习 见斯托克和沃森《计量经济学》第二版第2章的如下内容： 2.1 随机变量与概率分布 2.2 期望值、均值与方差 2.3 二维随机变量。Q：用数学形式表述：平均而言，受教育程度为本科的人的IQ高于受教育程度为高中的人的IQ？ 2.5 随机抽样和样本均值的分布 2.6.1 大数定理和一致性 "],["blr.html", "第 2 章 二元线性回归 2.1 二元线性回归模型的定义 2.2 普通最小二乘法的推导 2.3 OLS估计量的期望和方差 2.4 函数形式 2.5 最小二乘法：再考察 2.6 零条件均值假设：成立吗？", " 第 2 章 二元线性回归 2.1 二元线性回归模型的定义 见伍德里奇《计量经济学导论：现代观点》第五版第2.1节。 2.2 普通最小二乘法的推导 最小二乘（OLS）法的直观理解 从总体中随机抽取N个观测值。记号：{\\(((x_i,y_i):i=1,...,N)\\)}。 画散点图。横轴表示受教育程度，纵轴表示工资。呈正向关系。 问题：基于这些数据，估计总体参数。之前，我们估计的总体参数只有总体均值一个；这里，有两个待估计的总体参数：\\(\\beta_0\\)和\\(\\beta_1\\)。怎么估计\\(\\beta_0\\)和\\(\\beta_1\\)？ 记\\(\\beta_0\\)的估计量为\\(\\hat{\\beta_0}\\)，\\(\\beta_1\\)的估计量记为\\(\\hat{\\beta_1}\\)。如果确定了\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)，就可以确定一条直线：为\\(y=\\hat{\\beta_0}+\\hat{\\beta_1}x\\)。\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)变化，直线也跟着变化。反过来，直线确定了，\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)也确定了。即：\\({\\hat{\\beta_0},\\hat{\\beta_1}}\\)与直线是一一对应的关系。那么，确定\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)，等价于找直线为\\(y=\\hat{\\beta_0}+\\hat{\\beta_1}x\\)。 问题：直线有无限条，需要我们找出其中一条，它在某种意义上是最优的。直观上，该怎么去找？ 图 2.1: wage and education 回忆：估计总体均值时，我们选择距观测值m（对应观测点）最近的数（对应一条水平线y=m），或者说选择距观测点最近的水平线。 类比：找一条离观测点最近的直线。但这里不必是一条水平线，可以是任意走向的直线。 严格地，定义一条给定的直线到各观测点的距离。一种（不是唯一的）定义距离的方法：如图2.2，三个观测点\\((x_1,y_1),(x_2,y_2),(x_3,y_3)\\)，一条给定的直线\\(y =\\hat{\\beta_0}+\\hat{\\beta_1}x\\)，做一条从点1出发的垂直线段，与该直线相交，定义该线段的平方为点1到该直线的距离。数学表达：\\((y_1- \\hat{\\beta_0}-\\hat{\\beta_1}x_1)^2\\)。注意，\\(y_1-\\hat{\\beta_0}-\\hat{\\beta_1}x\\)可能为负，求其平方，保证得到一个正数。类似可求其他点到该直线的距离。总距离为： \\[\\begin{align} (y_1 - \\hat{\\beta_0} - \\hat{\\beta_1}x_1)^2 + (y_2 - \\hat{\\beta_0} - \\hat{\\beta_1}x_2)^2 +(y_3 - \\hat{\\beta_0} - \\hat{\\beta_1}x_3)^2 \\tag{2.1} \\end{align}\\] 选择直线与观测点的总距离最小，或者说选择\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)使得总距离最小： \\[\\begin{align} Min_{\\hat{\\beta_0},\\hat{\\beta_1}} (y_1 - \\hat{\\beta_0} - \\hat{\\beta_1}x_1)^2 +(y_3 - \\hat{\\beta_0} - \\hat{\\beta_1}x_2)^2 + (y_2 - \\hat{\\beta_0} - \\hat{\\beta_1}x_3)^2 \\tag{2.2} \\end{align}\\] 图 2.2: Illustration of the OLS method 定义： \\[\\begin{align} \\hat{y} = \\hat{\\beta_0} + \\hat{\\beta_1}x \\\\ \\hat{u} = y - \\hat{y} = y - \\hat{\\beta_0} - \\hat{\\beta_1}x \\tag{2.3} \\end{align}\\] \\(\\hat{y}\\)就是直线的纵坐标，称为拟合值。\\(\\hat{u}\\)是图2.2 中线段，在直线上方记为正，在直线下方记为负，称为残差。可以把最小化问题表述为： \\[\\begin{align} Min_{\\hat{\\beta_0},\\hat{\\beta_1}} (y_1 - \\hat{y_1})^2 +(y_2 - \\hat{y_2})^2 + (y_3 - \\hat{y_3})^2 = \\hat{u_1}^2 +\\hat{u_2}^2 + \\hat{u_3}^2 \\tag{2.4} \\end{align}\\] OLS估计量的推导 一般地，有N个观测值，优化问题为： \\[\\begin{align} Min_{\\hat{\\beta_0},\\hat{\\beta_1}} \\sum_{i=1}^N (y_i - \\hat{\\beta_0} - \\hat{\\beta_1}x_i)^2 \\tag{2.5} \\end{align}\\] 对择\\(\\hat{\\beta_0}\\)和\\(\\hat{\\beta_1}\\)求偏导，得到一阶条件： \\[\\begin{align} \\sum_{i=1}^N (y_i - \\hat{\\beta_0} - \\hat{\\beta_1}x_i) = 0 \\\\ \\sum_{i=1}^N (y_i - \\hat{\\beta_0} - \\hat{\\beta_1}x_i) x_i = 0 \\tag{2.6} \\end{align}\\] 可以推出： \\[\\begin{align} \\hat{\\beta_1} = \\frac{\\sum_{i=1}^N (x_i-\\overline{x})(y_i-\\overline{y})}{(x_i-\\overline{x})^2} \\\\ \\hat{\\beta_0} = \\overline{y} - \\hat{\\beta_1}\\overline{x} \\tag{2.7} \\end{align}\\] 推导见伍德里奇《计量经济学导论：现代观点》第五版式(2.16)-(2.19)。 \\(\\hat{\\beta_1}\\)和\\(\\hat{\\beta_1}\\)的计算公式已经给出来了。两个估计量均是观测值{\\(((x_i,y_i):i=1,...,N)\\)}的函数。由于我们把x,y视作随机变量，随机变量的函数依然是随机变量。 程序模拟 写了的一个Fortran小程序。它从总体中随机抽取一个样本，包含30个观测值，每个观测值包含x和y两个取值（可以将y理解成wage，x理解成education）。 一次随机抽样的结果如图2.3。抽到的第一个观测值的y是0.4187，x是0.1616。第二个观测值的y是0.2976,x是1.3366。因为是随机抽样，第二个观测值y和x的取值不同于第一个观测值的y和x的取值。其他观测值取值如图。基于这些观测值，我们计算了\\(\\hat{\\beta_1}\\)，计算结果和详细的计算过程如图2.3。 图 2.3: Calculation based on a random sample 把这个过程重复500遍，即进行500次抽样。在每一次抽样中，都随机抽取30个观测值，基于这些观测值重新计算\\(\\hat{\\beta_1}\\)。 为便于理解，列出前两次抽样的观测值：图2.4左边是第一次抽样的观测值，右边是第二次抽样的观测值。左右两边的观测值不一样，因是随机抽取的。既如此，基于各样本计算的\\(\\hat{\\beta_1}\\)也就不一样。 图 2.4: Two random samples 图2.5列出了由500次抽样计算出来的500个\\(\\hat{\\beta_1}\\)。图中第一列表示抽样次数，第二列表示\\(\\hat{\\beta_1}\\)。可以看到，各次抽样的\\(\\hat{\\beta_1}\\)均不一样，这就是为什么我们说\\(\\hat{\\beta_1}\\)是一个随机变量。 图 2.5: 500 estimates (only first 40 estimates displayed) 总结：因为x和y是随机的，每次抽样得到了x和y不一样，基于这些x和y计算出来的\\(\\hat{\\beta_1}\\)不一样，故\\(\\hat{\\beta_1}\\)是一个随机变量。 例：教育回报率 见伍德里奇《计量经济学导论：现代观点》第五版例2.4。 一阶条件的含义 一阶条件也可写成： \\[\\begin{align} \\sum_{i=1}^N u_i = 0 \\\\ \\sum_{i=1}^N u_i x_i = 0 \\tag{2.8} \\end{align}\\] 含义：（1）正负偏离相抵；（2）残差与自变量不相关。Q：为什么？[提示：想想相关系数的公式]。 一阶条件的直观展示如图2.6。仍然使用伍德里奇《计量经济学导论：现代观点》第五版例2.4的数据，绘制散点图，\\(\\hat{u_i}\\)作为纵轴，education作为横轴。 首先看第一个一阶条件：残差有正的也有负的，图2.6中正负偏差相抵。再看第二个一阶条件。图2.6中\\(\\hat{u_i}\\)和education之间没有明显的正的线性关系的或负的线性关系，它们的相关系数为0。 图 2.6: Calculation based on a random sample 2.3 OLS估计量的期望和方差 问题：反过来用educ对wage做回归，可不可以？有没有意义？ 数学上没有问题。Stata演示结果略。经济学上没有意义。一般的结论：用变量1对变量2回归，不能保证变量2的估计系数有意义。 为了使估计系数有意义，需要施加约束。什么是有意义？通常，满足下式，称有意义： \\[\\begin{align} E[\\hat{\\beta_1}] = \\beta_1 \\tag{2.9} \\end{align}\\] 含义：\\(\\hat{\\beta_1}\\)是一个随机变量。我们不能保证每一次抽样得到的\\(\\hat{\\beta_1}\\)都等于\\(\\beta_1\\)；通常前者不等于后者。我们希望至少保证当把这个事情重复很多遍，说我们刚才抽样500次，得到的500个\\(\\hat{\\beta_1}\\)的平均值等于\\(\\beta_1\\)。或者说，上式成立；期望表示的就是平均而言。 总结：平均而言，\\(\\hat{\\beta_1}\\)反映/识别了因果关系。 问题：施加什么条件才能使上式成立？ 直接思考这个问题有一定难度。可以从一个简单的问题开始考虑这个问题。如果\\(E[IQ|受教育程度=本科]&gt;E[IQ|受教育程度=高中]\\)（受教育程度等于本科的人的IQ平均来说大于受教育程度等于高中的人的IQ），那么\\(E[收入|受教育程度=本科]-E[收入|受教育程度=高中]\\)(本科生的收入的均值减去高中生的收入的均值)是否反映受教育程度和收入之间的因果关系？即该差值是否完全由受教育程度的差异所致？如果不能的话，将这一前提条件替换成什么条件可使这一差分反映因果关系？ 第一小问：本科生平均收入比高中生平均收入高，既因接受了更多的教育，又因本科生IQ平均来说比高中生高。故给定该前提条件，该差值不能反映受教育程度和收入之间的因果关系。 第二小问：换成\\(E[IQ|受教育程度=本科]=E[IQ|受教育程度=高中]\\)。我们之前担心有遗漏变量问题：本科生和高中生的IQ不相同，因此，不知道这个收入到底是受教育程度不同还是IQ不同所致。改成这一前提条件，回避了这一问题。 即使如此，本科生和高中生在别的方面存在差异。如，一般来说，家庭收入越高，对小孩的教育投入越多，小孩上大学的概率越高。又如，本科生和高中生的道德品质可能有差异。等等。为此，按照上面的逻辑，我们还需要增加如下的前提条件： \\[\\begin{align} E[家庭收入|受教育程度=本科]=E[家庭收入|受教育程度=高中] \\\\ E[道德品质|受教育程度=本科]=E[道德品质|受教育程度=高中] \\\\ ... \\tag{2.10} \\end{align}\\] 问题在于，可以列出成百上千个前提条件，因为影响收入的因素众多。可不可以化繁为简，用一个简单的式子概括一系列前提条件？这个简单的式子是什么？下式符合要求： \\[\\begin{align} E[u|受教育程度=本科]=E[u|受教育程度=高中] \\tag{2.11} \\end{align}\\] 干扰项的定义就是除了我们纳入模型的因素以外，未纳入模型的因素的综合影响。数学上，可以u写成IQ、家庭收入、道德品质等一众未纳入模型的因素的函数。上式表示，本科生和高中生除受教育程度以外各因素的综合影响平均而言相等，或者说给定受教育程度，除受教育程度以外各因素的综合影响的期望为一个常数。 这个前提条件满足的情况下，\\(E[收入|受教育程度=本科]-[收入|受教育程度=高中]\\)能够反映受教育程度和收入之间的因果关系。注意这只是一个假设，成不成立是另外一回事。这里只是说如果假设成立，那么我们可以得出结论。 一般地，受教育程度可以取多个值，如小学、初中、高中、本科、研究生等。将前提条件换成： \\[\\begin{align} E[u|educ] = Constant \\tag{2.12} \\end{align}\\] 表示，不管受教育程度取何值，除受教育程度以外各因素的综合影响平均而言均相等。 这是保证OLS估计量有意义的核心假设。此外，我们还需要其他一些假设。 四个假设 见伍德里奇《计量经济学导论：现代观点》第五版第41-43页。 补充：零条件均值假设与前述条件均值为常数对于估计\\(\\beta_1\\)是一回事。为什么？ 零条件均值假设的含义：x变化时，所有其他因素对y的综合影响平均意义上保持不变。在教育回报率的例子中，这意味着，不管受教育程度怎么变化，所有其他因素对收入的综合影响平均意义上保持不变（合理吗？）。也可以说，或者说，x对于预测其他因素对y的综合影响的均值无帮助。 零条件均值假设是假设，未必是事实。如果它成立，我们可以在它基础上进行推导。但我们要检查它在现实中是否成立。 OLS估计量的无偏性 见伍德里奇《计量经济学导论：现代观点》第五版第43-45页。 程序模拟（续） 接§2.2中的程序模拟。疑问：500次抽样怎么抽的？这里予以明确。假设真实的模型为： \\[\\begin{align} y=x+u, x\\ and\\ u \\sim N(0,1), x\\ and\\ u\\ are\\ independent. \\tag{2.13} \\end{align}\\] 这里，\\(\\beta_0=0,\\beta_1=1\\)。 抽样：以抽取第一个观测值为例，我们从一个标准正态分布里随机抽取一个\\(x_1\\)，从另一个独立的标准正态分布里随机抽取一个\\(u_1\\)，把它们加起来，就得到\\(y_1\\)。由此得到第一个观测值\\((x_1,y_1)\\)。如此，我们抽第2至30个观测值，组成一个样本。这是一次抽样。基于这一次抽样的话，计算一个\\(\\hat{\\beta_1}\\)。重复这一过程，进行第2至500次抽样。每次抽样均包含30个观测值，计算一个\\(\\hat{\\beta_1}\\)。共得到500个\\(\\hat{\\beta_1}\\)。 这一过程满足上述4个假设，包括\\(E(u|x)=0\\)。为什么？因此： \\[\\begin{align} E[\\hat{\\beta_1}]=1 \\tag{2.14} \\end{align}\\] 这是理论结果。是否500次抽样的\\(\\hat{\\beta_1}\\)的均值约等于1？绘制500个\\(\\hat{\\beta_1}\\)的直方图如图2.7。由图，\\(\\hat{\\beta_1}\\)不尽相同的，有的时候比较小，甚至达到0.3，而有的时候比较大，甚至达到1.7。就是说由一个随机抽取的样本计算的\\(\\hat{\\beta_1}\\)可能离总体参数很远。但在\\(\\hat{\\beta_1}\\)等于总体参数1的概率最大。总体上，\\(\\hat{\\beta_1}\\)围绕着1分布，等于极端值的概率小。 图 2.7: Histogram of 500 estimates 图2.8展示了前若干个\\(\\hat{\\beta_1}\\)的均值。如最右端横轴是500，纵轴表示前500次抽样的\\(\\hat{\\beta_1}\\)的均值，它约等于1。 图 2.8: Mean of estimates 这个形象的例子说明在满足4个假设的情况下，基于一个样本计算的\\(\\hat{\\beta_1}\\)通常不等于\\(\\beta_1\\)，还可能离\\(\\beta_1\\)比较远。但\\(\\hat{\\beta_1}\\)的均值等于总体参数。 零条件均值、无偏性与因果关系 我们很多次把我们的最小二乘回归跟因果关系联系在一起。并非牵强附会。 因果关系的定义：x变化时其他因素不变，y怎么变化？反映x到y之间的因果关系。 零条件均值假设：x的变化的时候，平均而言其他因素不变，这里加了个“平均而言”，因为有一个期望符号。零条件均值假设跟因果关系定义的前半句非常相似,唯一的区别是多了一个“平均而言”。社会科学不同于自然科学，一般来说我们没办法进行实验，保持其他因素完全不变。比如，我们抽到若干个本科生和若干个高中生，除了受教育程度不一样，本科生和高中生在别的各方面也不一样。每一个人都是独特的，没有办法保持IQ严格不变，我们尽可能能做到的是保持本科生和高中生的IQ的均值一样。故我们不得不加上“平均而言”，在数学上用期望表示。 如果零条件均值假设成立，可以推出无偏性：平均而言，\\(\\hat{\\beta_1}\\)等于\\(\\beta_1\\)，即平均而言反映因果关系，跟因果关系的定义的后半句非常相似，唯一的区别依然是多了一个“平均而言”。因为零件均值假设中有一个“平均而言”，这里也得有一个。 OLS估计量的方差 见伍德里奇《计量经济学导论：现代观点》第五版第46-49页。 误差方差的估计 见伍德里奇《计量经济学导论：现代观点》第五版第49-51页。 2.4 函数形式 见伍德里奇《计量经济学导论：现代观点》第五版第38-41页。 2.5 最小二乘法：再考察 最小二乘法到底在干什么？之前我们给了一种理解（称为理解1）：把观测值画在二维图里，找离这些观测值最近的直线。这是一种直观的理解，但不是唯一的理解。下面我们给出另外两种理解。 理解2 \\[\\begin{align} y_i=\\hat{\\beta_0}+\\hat{\\beta_1}x_i+\\hat{u_i}=\\hat{y_i}+\\hat{u_i} \\tag{2.15} \\end{align}\\] 也就是说我可以把y分解成两部分：拟合值\\(\\hat{y}\\)和残差\\(\\hat{u}\\)，这两部分有什么关系？ \\(\\sum_{i}(\\hat{\\beta_0}+\\hat{\\beta_1}x_i)\\hat{u_i}=0\\)。为什么？[提示：使用一阶条件]。意味着\\(\\hat{y}\\)和\\(\\hat{u}\\)不相关。为什么？[提示：使用相关系数的公式] 直观上，可以绘制UIhat和Yihat的散点图。仍利用教育回报率的例子，绘制\\(\\hat{y_i}\\)（横轴，怎么计算？）和\\(\\hat{u_i}\\)（纵轴）的散点图如图2.9。可见，两者不存在线性关系。严格地，可以算出它们地相关系数就是为0。 图 2.9: What does OLS method do? 总之，最小二乘法是做分解：将因变量分解成拟合值和残差这两个不相关的项。 理解3 换一个角度，利用线性代数的知识。考虑过原点的回归模型： \\[\\begin{align} y=\\beta_1x+u \\tag{2.16} \\end{align}\\] 也就是说，\\(\\beta_0=0\\)。 OLS估计量（推导见伍德里奇《计量经济学导论：现代观点》第五版第51页）： \\[\\begin{align} \\hat{\\beta_1}=\\frac{\\sum_{i}x_iy_i}{\\sum_{i}x_i^2} \\tag{2.17} \\end{align}\\] 有两个观测值：\\((x_1=2,y_1=1)，(x_2=0,y_2=2)\\)。代入上面的公式，得：\\(\\hat{\\beta_1}=0.5\\) 将两个观测值的回归方程用线性代数表示： \\[\\begin{align} \\left( \\begin{array}{c} 1 \\\\ 2 \\end{array} \\right) = \\left( \\begin{array}{c} 2 \\\\ 0 \\end{array} \\right) \\times0.5 +\\left( \\begin{array}{c} 0 \\\\ 2 \\end{array} \\right) = \\left( \\begin{array}{c} 1 \\\\ 0 \\end{array} \\right) +\\left( \\begin{array}{c} 0 \\\\ 2 \\end{array} \\right) \\tag{2.18} \\end{align}\\] 记向量\\(\\vec{y}=(1,2)&#39;,\\vec{x}=(2,0)&#39;,\\vec{u}=(0,2)&#39;\\)。把这些向量画在二维图中： 图 2.10: What does OLS method do? (continued) 由图。OLS法就是做线性投影：将向量y在x确定的平面上做线性投影，线性投影为拟合值，投影剩下的部分就是残差。该结论对于二元线性回归模型和下一章要讲的多元线性回归模型依然成立。 2.6 零条件均值假设：成立吗？ 一个物理学家，一个化学家和一个经济学家落难孤岛，正值饥肠辘辘，海上漂来一盒罐头。物理学家提议用岩石砸开罐头，化学家主张生火加热使其膨胀破裂，此时，经济学家慢条斯理地说：“你们的方法太复杂了，假设有一个开瓶器，我们就可以轻松撬开它。” 资料来源：https://www.douban.com/group/topic/252843954/?_i=7975810BnpGaYU 当零条件假设成立时，OLS估计量无偏，平均而言能够反映因果关系。问题是，什么情况下零条件均值假设成立？ 随机实验 如果x是随机分配的，那么零条件均值假设成立。比如，一个农学家研究施肥量（记为x）对作物收成（记为y）的影响。他可能做自然实验：找100块1亩大小的土地，随机分成10组，分别施以0、1、2……、9单位的肥料。某块地施肥量多寡，纯系运气，与别的信息无关。也就是说，知道该块地的施肥量对于推测该块地的别的信息了无帮助。用数学术语讲： 对于任一施肥量，别的信息对此的条件期望是一个常数，即零条件均值假设成立。 问题在于，在经济学里，很难开展随机实验，原因有二：其一，经济学领域的随机实验的成本可能较高，如为了解基础设施对经济增长的影响，随机实验的思路选择100个村子，随机分成2组，给一组修路，对另一组不做处理。修路成本高昂显而易见。其二，为估计教育回报率，随机实验的思路是随机地给不同小孩不同的受教育程度。但为什么有的小孩就能得到高学历，而有的小孩初中毕业就不得不步入社会？这是伦理压力。 检验零条件均值假设是否成立 定理：\\(E[u|x]=0=&gt;Cov(x,u)=0,Corr(x,u)=0\\)。 证明见斯托克和沃森《计量经济学》第二版格致出版社等第27页。 反过来，如果相关，零条件均值假设不成立。这为我们提供了一个判断零条件均值假设成不成立的思路：一般来说，很难直接判断零条件均值假设是否成立，因其抽象。但容易判断x和u是不是相关的。如果有理由认为x和u相关，则有理由认为零条件均值假设不成立。 例1：\\(y=\\beta_0+\\beta_1*educ+u\\)。干扰项包含除教育以外其他影响收入因素，包括IQ。IQ和受教育程度x应是正相关的。而IQ是u的一个组成部分，因此我们有理由认为u和educ也是相关的。进而有理由认为零条件均值假设不成立。这就是所谓的遗漏变量问题：这里遗漏掉IQ，它与educ相关。既如此，OLS估计量不满足无偏性，平均而言不能反映因果关系。 例2：cons=β0+β1transfer+u(消费&lt;-转移支付)。Q：u是哪些因素的综合影响?这些因素各自与transfer相关吗？如果相关, 是正相关还是负相关？0条件均值假设成立吗？ 另外一种情况是不仅x会影响y，反过来y也会影响x。 例3：基础设施和经济发展水平的关系。良好的基础设施促进经济发展。反过来，经济发达，政府税收多，基础设施多。也就是说，基础设施和经济发展水平双向影响。 例4：国民总收入和总消费的关系。 如果x和y双向影响，那么x和u相关。证明如下： 图 2.11: reverse causilty and biased estimator 这就是反向因果问题。当其存在的情况下，零条件均值假设不成立，OLS估计量有偏, 平均而言不能反映因果关系。 遗漏变量或反向因果问题在实践中非常常见，以致于很多时候，简单做一个最小二乘回归没有什么意义。处理遗漏变量或反向因果问题至关重要。如何处理？本讲义后述各种方法，皆旨在处理这两个问题。 "],["mlr.html", "第 3 章 多元线性回归：估计 3.1 使用多元线性回归模型的动因 3.2 多元线性回归模型的定义 3.3 OLS法的操作和解释 3.4 OLS估计量的期望 3.5 OLS估计量的方差 3.6 OLS估计量的有效性 3.7 模型误设", " 第 3 章 多元线性回归：估计 3.1 使用多元线性回归模型的动因 二线线性回归模型： \\[\\begin{align} wage=\\beta_0+\\beta_1educ+u(IQ,...)，Cov(educ, IQ)&gt;0 \\tag{3.1} \\end{align}\\] 问题是，受教育程度更高的人平均而言IQ更高，零条件均值假设不成立，估计量是有偏。怎么解决这个问题？ 造成困扰的原因是干扰项包含了IQ。既如此，直接把IQ放到自变量里面就行了： \\[\\begin{align} wage=\\beta_0+\\beta_1educ+\\beta_2IQ+u \\tag{3.2} \\end{align}\\] 这是多元线性回归模型，具体来说是三元线性回归模型，三元是educ、IQ和常数1（beta0*1）。一般地，可以把认为可能会干扰结果的遗漏变量加到自变量中。这样，它们不再被遗漏掉，以此处理遗漏变量问题。 3.2 多元线性回归模型的定义 见伍德里奇《计量经济学导论：现代观点》第五版第60-61页。 补充：虽然列出来了多个解释变量，但并不是说我们对于所有解释变量的系数都同等程度地关心。通常，我们会只关心其中的一个解释变量\\(x_1\\)的系数。 如在上面的例子中，我们仅关心educ的系数，表示教育回报率。至于IQ的系数是多少，我们不关心。把IQ加进来唯一的理由是，若不加进来，它就是遗漏变量，会导致估计结果有偏。我们把\\(x_1\\)叫做核心解释变量，其他解释变量叫做控制变量。 函数形式 见伍德里奇《计量经济学导论：现代观点》第五版第154-161页 3.3 OLS法的操作和解释 见伍德里奇《计量经济学导论：现代观点》第五版第3.2节如下小节： “如何得到OLS估计值” “对OLS回归方程的解释” “多元回归中‘保持其他因素不变的含义’” “OLS的拟合值和残差” “对多元回归‘排除其他变量影响’的解释” 补充：一阶条件： \\[\\begin{align} \\sum_i\\hat{u_i}=0 \\tag{3.3} \\end{align}\\] \\[\\begin{align} \\sum_ix_{ij}\\hat{u_i}=0\\ for\\ j=1,2,...,k \\tag{3.4} \\end{align}\\] \\[\\begin{align} \\sum_i\\hat{y_i}\\hat{u_i}=0 \\tag{3.5} \\end{align}\\] 式(3.3)的含义：Deviations from regression line sum up to zero。也就是说，正负残差抵消掉了。 式(3.4)的含义：Correlations between deviations and regressors are zero，即所有解释变量和残差不相关。 式(3.5)的含义：将因变量分解成拟合值和残差这个不相关的两部分。 3.4 OLS估计量的期望 见伍德里奇《计量经济学导论：现代观点》第五版第70—74页。 补充：所谓准确的线性关系，是指非常熟解释变量存在准确的线性关系，即它们之间具有如下的关系： \\[\\begin{align} a_0+a_1x_1+a_2x_2+…+a_kx_k=0 \\tag{3.6} \\end{align}\\] 可以用\\(x_2,…x_k,constant\\)来表示\\(x_1\\)。知道了前者，就知道了\\(x_1\\)，故\\(x_1\\)的信息是多余的。 零条件均值假设表示自变量\\(x_1,x_2,…,x_k\\)对于我预测干扰项的均值没有帮助。也就是说，任一自变量变大或变小，干扰项的均值保持不变。 如果零条件均值假设成立，有下面的推论：\\(Cov(x_j,u)=0,Corr(x_j,u)=0\\ for\\ j=1,2,…,k\\)。把跟干扰项不相关的变量就称为外生解释变量。跟干扰项相关的解释变量称为内生解释变量。零条件均值假设成立意味着所有解释变量都是外生解释变量。 3.5 OLS估计量的方差 见伍德里奇《计量经济学导论：现代观点》第五版第3.4节除“误设模型中的方差”一小节。 3.6 OLS估计量的有效性 见伍德里奇《计量经济学导论：现代观点》第五版第3.5节。 3.7 模型误设 遗漏相关变量 Q：如果E[IQ|受教育程度=本科]&gt;E[IQ|受教育程度=高中]，那么，E[收入|受教育程度=本科]-[收入|受教育程度=高中]将过高地估计（高估）、还是过低地估计（低估）受教育程度对收入的因果影响？假设真实的情况是受教育程度由高中提高到本科将使月收入提高1000元，如估计值为1500元则为高估，估计值为800元则为低估。 本科生的收入更高反映了两种影响：一个是教育的作用，另一个是本科生的IQ平均更高，而IQ高导致收入高，即收入差距一部分是由IQ差距导致的。简单求收入差值相当将高估受教育程度对收入的因果影响。 用数学语言，造成正的偏误的来源有两点：受教育程度与IQ正相关，而IQ对收入有正向的因果影响。 用计量语言概括此例：真实的模型是这样的：$wage=_0+_1educ+_2IQ+u \\(。但我们错误估计了如下模型：\\)wage=_0+_1educ+w$。这属于模型误设的一种情形：遗漏相关变量。正的偏误。 一般地，真实的模型为：\\(y=\\beta_0+\\beta_1x_1+\\beta_2x_2+u\\)。假设零条件均值假设成立。错误地估计了模型：\\(y=\\alpha_0+\\alpha_1x_1+w\\)。系数\\(\\alpha_1\\)和\\(\\beta_1\\)有何联系？ 推导： 图 3.1: Derivation for omitted variables 估计结果：\\(\\alpha_1=\\beta_1+\\beta_2\\delta_1\\)。而真实的因果影响为\\(\\beta_1\\)。多出来的部分\\(\\beta_2\\delta_1\\)就是偏误。其中，\\(delta_1\\)反映\\(x_1\\)和\\(x_2\\)的相关性。\\(\\beta_2\\)反映\\(x_2\\)对y的因果影响。对应上面提到的两点。例：\\(\\beta_2\\)和\\(\\delta_1\\)都为正，正正得正，偏误为正，高估。 Q：基于这些数学公式理解上述例子中正的偏误。 例: cons&lt;-transfer+income, 遗漏income. Q: 偏误方向? 例: GDP&lt;-govt expenditure+money supply, 遗漏货币供给. Q: 偏误方向? 另见伍德里奇《计量经济学导论：现代观点》第五版第75-78页。 包含无关变量 见伍德里奇《计量经济学导论：现代观点》第五版第74-75页。 总结：遗漏相关变量导致偏误，包含无关变量影响方差。这两个都有问题，哪个问题更小一点？遗漏相关变量问题可能更大一点。所以，一般的建议是在不确定要不要加某个变量的时候，把它给加上，这可能使得标准误变大，但OLS估计量始终是无偏的，意味着平均而言反映了因果关系。 "],["mlrinf.html", "第 4 章 多元线性回归：统计推断 4.1 引例 4.2 OLS估计量的抽样分布 4.3 检验对单个总体参数的假设 4.4 多元回归能解决遗漏变量问题吗？", " 第 4 章 多元线性回归：统计推断 4.1 引例 在电影《肖申克的救赎》的一开始，男主人公被控杀害妻子，“铁证如山”，锒铛入狱。但，男主人公是被冤枉的。 审判的程序： 提出原假设(无罪)； 提供证据； 证据不足, 维持原假设(无罪释放); 证据足够充分, 拒绝原假设(锒铛入狱) 可能存在的问题： 释放了真正的罪犯（错误地维持原假设）； 将无辜的人关进监狱（错误地拒绝原假设）。 统计推断的程序和存在的问题亦如是。 4.2 OLS估计量的抽样分布 见伍德里奇《计量经济学导论：现代观点》第五版第4.1节。 4.3 检验对单个总体参数的假设 见伍德里奇《计量经济学导论：现代观点》第五版第4.2节。 4.4 多元回归能解决遗漏变量问题吗？ 相比简单回归，多元回归考虑了更多的影响因素，能不能解决彻底解决遗漏变量问题？问题在于，影响因素有很多，能把所有的因素都包含进来吗？有两个难点： 第一个难点是，甚至不可能列出所有的影响因素。例：20世纪90年代，美国犯罪率大幅降低，什么原因所致？列维特等提出并验证了，约70年代允许堕胎法案的通过导致了90年代犯罪率的降低！多数人考虑不到这个影响因素。 第二个难点是，即使列出来一些影响因素，一定能找到这些影响因素的数据吗？收集数据最原始的方式是发传单。如果想度量更多的影响因素，就要在问卷上设置更多的问题。问题一多，做一份问卷的时间就长了，时间或人工成本增加，未必是时间或经费有限的研究者能够承受的。在有限的时间或经费预算内，理性的做法是，尽可能多地测度重要的因素，舍弃相对次要的因素。 总之，不可能把所有的影响因素都加入自变量。未纳入的影响因素进入干扰项。不能保证所有未纳入的因素都和核心解释变量不相关。一旦有一个未纳入的因素跟核心解释变量相关，零条件均值假设就不成立了，OLS估计量有偏，平均而言不能识别因果关系。 结论：相比简单回归，多元回归的话，使得遗漏变量问题有所缓解，但不能保证能够彻底解决遗漏变量问题，且通常不能彻底解决遗漏变量问题。 但，有一种特殊的情况，多元线性回归能识别因果关系，这就是满足一定前提条件的清晰断点回归（可以把它看作多元线性回归的一个特例）。为了能够理解清晰断点回归，需要先学习定性信息的知识。 "],["dummy.html", "第 5 章 定性信息 5.1 二值变量 5.2 虚拟变量陷阱 5.3 分类、基准和虚拟变量 5.4 多个虚拟变量 5.5 更多例子", " 第 5 章 定性信息 5.1 二值变量 回忆OLS估计量的计算公式，不要求变量是连续的，可以是离散的，如只取两个值——1或0。称之为二值变量，或指示变量，或虚拟变量。考虑如下的二元线性回归模型： \\[\\begin{align} y=\\beta_0+\\beta_1D+u \\tag{5.1} \\end{align}\\] \\(\\beta_1\\)表示其他因素不变，D从0增加到1，y的变化。 利用OLS估计量的计算公式推出，\\(\\hat{\\beta_1}\\)等于 D等于1时y的均值减去D等于0时y的均值。 如果零条件均值假设成立，\\(\\hat{\\beta_1}\\)是无偏的。 一个例子 中国改革的一个典型做法是先在一些地方试点，如果试点效果好，再把成功的经验推向全国。所以，考虑下面一个情形：在中国的一部分地级市进行某项财税改革的试点。考虑如下的计量模型： \\[\\begin{align} y=\\beta_0+\\beta_1Pilot+u \\tag{5.2} \\end{align}\\] 其中，y表示的是人均GDP的对数，度量经济发展水平。Pilot是一个虚拟变量，定义如下： \\[ Pilot= \\begin{cases} 1&amp; \\text{进行了试点} \\\\ 0&amp; \\text{未进行试点} \\end{cases} \\] 通常把它称为政策虚拟变量（有政策为1，没政策为0，所以叫政策虚拟变量）。\\(\\beta_1\\)表示D从0（无试点）增加到1（无试点）导致的y的变化，即试点的效果。\\(\\beta_1\\)的OLS估计值等于试点市y的平均值减去未试点市y的平均值。如果零条件均值假设成立，OLS估计量是无偏的。零条件均值假设成立的一种情形是试点城市的选定是随机的。 5.2 虚拟变量陷阱 定义虚拟变量NoPilot如下： \\[ NoPilot= \\begin{cases} 1&amp; \\text{未进行试点} \\\\ 0&amp; \\text{进行了试点} \\end{cases} \\] Q：可以在计量模型中同时加入Pilot和NoPilot吗？即可以设置如下的计量模型吗？ \\[\\begin{align} y=\\beta_0+\\beta_1Pilot+\\beta_2NoPilot+u \\tag{5.3} \\end{align}\\] \\(Pilot+NoPilot=1\\)。存在多重共线性。因此，不能这样做。 5.3 分类、基准和虚拟变量 从分类的角度理解虚拟变量。将地级市分成两类：试点和未试点。以未试点的地级市为基准，给试点的地级市一个虚拟变量Pilot(如图5.1)。回归中Pilot的系数表示相对基准试点地级市因变量的平均增幅. 图 5.1: Classification 基准的选择是任意的。也可以选择试点的地级市作为基准，给未试点的地级市一个虚拟变量NoPilot，估计\\(y=\\beta_0+\\beta_1NoPilot+u\\)。从数学上讲，这样做没有问题，但NoPilot的系数的含义不那么自然。 5.4 多个虚拟变量 考虑另外一种试点情形：有两套试点方案，一套试点方案在一些地区实施，另一套试点方案在另一些地区实施，还有一些地区未实施任一方案，作为对照组。 现在有两套试点方案，需要定义两个虚拟变量。记第一种试点方案得虚拟变量为Pilot1（试点此方案记为1，否则记为0），第二种试点方案的虚拟变量为Pilot2。计量模型： \\[\\begin{align} y=\\beta_0+\\beta_1Pilot1+\\beta_2Pilot2+u \\tag{5.4} \\end{align}\\] \\(\\beta_1\\)和\\(\\beta_2\\)分别表示试点方案1和2的效果。 β1的OLS估计量: 推行第一种试点方案的地级市y的均值-未试点的地级市y的均值。β2的OLS估计量：推行第二种试点方案的地级市y的均值-未试点的地级市y的均值。 也可以从分类的角度理解，如图5.2。 图 5.2: Classification (continued) 把地级市分成三类：没有进行试点的地级市，试点方案一的地级市，试点方案二的地级市。把未进行试点的地级市作为基准。给试点方案一的地级市一个虚拟变量Pilot1，其系数表示相对基准试点方案二的地级市因变量的平均增或减幅。 给试点方案二的地级市一个虚拟变量Pilot2，其系数表示相对基准试点方案二的地级市因变量的平均增或减幅。 5.5 更多例子 用虚拟变量可以做很多事。比如，定义这么一个虚拟变量Male。顾名思义，它是男性的虚拟变量。严格的定义如下： \\[ Male= \\begin{cases} 1&amp; \\text{男} \\\\ 0&amp; \\text{女} \\end{cases} \\] 计量模型： \\[\\begin{align} wage=\\beta_0+\\beta_1Male+u \\tag{5.5} \\end{align}\\] Q：\\(\\beta_1\\)的含义？\\(\\hat{\\beta_1}=?\\) 还可以用虚拟变量研究种族（汉族还是少数民族）；行业（重工业或轻工业，三大产业）；地区（东中西）。 另见伍德里奇《计量经济学导论：现代观点》第五版第7.1-7.3节。 "],["srdd.html", "第 6 章 清晰断点回归 6.1 思路 6.2 估计 6.3 应用", " 第 6 章 清晰断点回归 本章是对清晰断点回归的极简介绍。 6.1 思路 以下是学者最开始用清晰断点回归处理的例子。假设依据GPA（x）确定授予/不授予奖学金，具体方案如下： GPA≥3.9，授予奖学金; GPA&lt;3.9，不授予奖学金 问题：获得奖学金会改变学习计划（y）吗？这是可能的，比如大三面临考研，如果有足够的预算，理性的选择是采取一些有效率但费钱的方式，如报考研班（假设报班是有效率的）。得到奖学金，扩大了预算，提高了报考研班的概率——奖学金改变了学习计划。 怎么估计奖学金对学习计划的影响？一个简单的想法是比较得到和未得到奖学金的同学，将他们在学习计划方面的差异认定为奖学金对学习计划的影响。这样做有问题。想想为什么有的同学总你能得到奖学金。因其学习计划性本来就比较好：看手机少看书多，有计划，遵守计划等。即使没有奖学金这个事，也会观测到两类学生在学习计划方面的差异。 但可以比较GPA刚好超过临界值3.9（3.9+ε，ε为任意小的正数）一点点的同学张三和刚好低于3.9（3.9-ε）一点点的同学李四。两人GPA微小的差距很可能是偶然因素造成的，如张三的跪舔得到了回应使其考试时状态好，而李四考试时感冒了。本身来讲，两人学习计划性差距甚微。但张三就是得到了奖学金，而李四未得。有无得到奖学金这件事这可能影响到学习计划性。因此，如果发现两人在学习计划方面存在明显的差异，那么这一差异几乎就是奖学金造成的。 严格地讲，两人学习计划性的差异包含两部分：第一，本身学习计划性的差异，由基因等决定。第二，奖学金对学习计划性的影响。当ε趋近于0时，两人GPA的差异趋近于0，第一部分趋近于0，两人学习计划性的差异趋近于奖学金对学习计划性的影响。 有无获得奖学金在3.9处有一个从无到有的跳跃。将3.9称为（清晰）断点。将比较（清晰）断点两侧一点点的观测值的方法称为（清晰）断点回归。 6.2 估计 图6.1是若干同学的散点图。 图 6.1: Sharp RDD: estimation 横轴是GPA。纵轴是学习计划性y。竖线x=3.9右边的同学得到奖学金，左边未得。 竖线以右，基于这部分散点绘制拟合曲线，它是线性、连续的，当GPA从左侧趋近于3.9时，拟合值趋近于\\(y_r\\)，对应前例中ε趋近于0时的张三。竖线以左，基于这部分散点绘制拟合曲线，它是线性、连续的，当GPA从左侧趋近于3.9时，y趋近于\\(y_l\\)，对应前例中ε趋近于0时的李四。在断点处，拟合值有一个跳跃，幅度为\\(y_r-y_l\\equiv\\rho\\)，反映奖学金对y的影响。 怎么用数学表示这个跳跃？竖线左边观测值的拟合曲线和右边观测值的拟合曲线斜率相同、截距不同。截距差就是\\(y_r-y_l\\)，正是我们要找的奖学金对y的影响。 断点左边的拟合曲线： \\[\\begin{align} \\hat{\\alpha}+\\hat{\\beta}x \\tag{6.1} \\end{align}\\] 断点右边的拟合曲线： \\[\\begin{align} \\hat{\\alpha}+\\hat{\\rho}+\\hat{\\beta}x \\tag{6.2} \\end{align}\\] 涵盖所有观测值的总的拟合曲线应该怎么写？如下： \\[\\begin{align} \\hat{\\alpha}+\\hat{\\rho}D+\\hat{\\beta}x,\\ D=1\\ iff\\ x\\ge3.9 \\tag{6.3} \\end{align}\\] 其中，D是奖学金的虚拟变量。 对应的计量模型为： \\[\\begin{align} y=\\alpha+\\rho D+\\beta x+u \\tag{6.4} \\end{align}\\] 这是一个多元线性回归！D和x是两个自变量。D的系数表示奖学金的作用。Q：D由x构造而来，D和x之间是否存在多重共线性？ 满足以下两个条件时，D的系数的OLS估计量无偏： x不能被操纵。在例子中，这意味着学生不能通过不正当手段左右成绩，不正当手段包括跟老师说，我GPA就差一点点就到3.9，老师您给我加2分我就可以拿奖学金了； 遗漏变量在断点处不存在跳跃。在例子中，这排除了下面的情况：父母宣称，子女GPA超过3.9，奖励1万元。这样，奖学金的作用和父母奖励的作用混合在一起了，无法区分。 这两个条件比零条件均值假设弱，且可以用统计方法验证（Q：思考验证的思路）。 6.3 应用 中国冬日（城市）集中供暖以淮河（图6.2）为界，以北政府集中供暖，以南政府不集中供暖。冬日集中供暖在人世最寒凉的时候予人温暖。同时胴体集中供暖产生空气污染物，危害人的健康，最终导致人的预期寿命减少。 如何估计冬日集中供暖对预期寿命的影响？思路是比较淮河两侧一点点的城市，淮河构成断点。数学上，只需将式(6.4)中的变量重新定义即可。定义x为城市距淮河多少纬度，在淮河以北为正，以南为负。如一个城市在淮河以北2个纬度，则其x为2；另一个城市在淮河以南1.5个纬度，则其x为-1.5。定义\\(D=1\\ iff\\ x\\ge0\\)。 估计结果显示，冬日集中供暖使得预期说明降低了约5年（Chen et al., 2013）！ 图 6.2: Local map of China. Source: Chen et al (2013) 参考文献 安格里斯特, 皮施克. 基本无害的计量经济学：实证研究者指南[M]. 格致出版社, 2012, 第2.1节和6.1节. Chen Y, Ebenstein A, Greenstone M, et al. Evidence on the impact of sustained exposure to air pollution on life expectancy from China’s Huai River policy[J]. Proceedings of the National Academy of Sciences, 2013, 110(32): 12936-12941. "],["mech.html", "第 7 章 机制和异质性分析 7.1 机制分析 7.2 异质性分析", " 第 7 章 机制和异质性分析 7.1 机制分析 回到§5.5的计量模型： \\[\\begin{align} wage=\\beta_0+\\beta_1Male+u \\tag{7.1} \\end{align}\\] 很可能得到，\\(\\hat{\\beta_1}\\)为正，即样本中男性平均工资比女性平均工资高。进一步我们想问为什么平均而言男性工资比女性工资高？猜想男性工资更高一个原因/机制是男性受教育程度更高。怎么检验这一猜想/机制？思路、计量方法？ （1）首先，检验男性受教育程度更高，这是前提。regress educ on Male: \\[\\begin{align} educ=\\gamma_0+\\gamma_1Male+\\epsilon \\tag{7.2} \\end{align}\\] 应满足：\\(\\hat{\\gamma_1}&gt;0\\)。 （2）然后，两性受教育程度的差异对于两性工资差异有解释力。举例来说，男性工资平均高10，其中3是男性受教育程度高造成的，7是其他因素造成的。也就是说，比较受教育程度相同的男性和女性，前者平均工资比后者高7。即控制受教育程度，男性平均工资高7（相比不控制时的10减小）。因此，验证思路：设法控制受教育程度（即剔除这一机制），看此时估计系数是否减小（至7）。Q：怎么控制受教育程度？[提示：回忆多元线性回归中系数的含义] \\[\\begin{align} wage=\\alpha_0+\\alpha_1Male+\\alpha_2educ+v \\tag{7.3} \\end{align}\\] 式(7.1)中\\(\\beta_1\\)相当于例子中的10，式(7.3)中\\(\\alpha_1\\)相当于例子中的7。验证：\\(\\alpha_1&lt;\\beta_1\\)，即控制教育这一机制后，两性工资差距减小。还要验证这一推导背后隐含的假设：教育提高了工资，即\\(\\alpha_2&gt;0\\)。 进一步，在例子中，教育这一机制解释了\\(\\frac{10-7}{10}=30\\%\\)的两性工资差异。一般地，教育这一机制解释了\\(\\frac{\\beta_1-\\alpha_1}{\\beta_1}\\)的两性工资差异。 如果（1）和（2）同时的得到验证，则教育这一机制得证。 一般地，怀疑x影响y的一个机制是z，即怀疑存在x-&gt;z-&gt;y的逻辑路径。检验该机制的程序类此。 7.2 异质性分析 回到最初的计量模型： \\[\\begin{align} wage=\\beta_0+\\beta_1educ+u \\tag{7.4} \\end{align}\\] \\(\\beta_1\\)反映样本中受教育程度增加1单位工资平均增加多少，即反映平均的教育回报率。可能不同人的教育回报率不一样。如在古代，女性的教育回报率接近0，因其参加不了科举，做不了官。而男性的教育回报率为正。即教育回报率在两性间存在差异，呈现出异质性。用什么计量模型刻画不同个体差异化的教育回报率？ 一种方法：将样本分成两组，一组全是男，一组全是女，分组估计，看两组的\\(\\hat{\\beta_1}\\)是否存在明显的差异。 另一种方法：记男性的估计系数比女性的估计系数多\\(\\gamma_2\\in R\\)。女性的回归方程为： \\[\\begin{align} wage=\\beta_0+\\gamma_1educ+u \\tag{7.5} \\end{align}\\] 男性的回归方程为： \\[\\begin{align} wage=\\beta_0+(\\gamma_1+\\gamma_2)educ+u \\tag{7.6} \\end{align}\\] Q：试用一个统一的计量模型概括上述两式。 \\[\\begin{align} wage=\\beta_0+(\\gamma_1+\\gamma_2Male)educ+u \\tag{7.7} \\end{align}\\] 或 \\[\\begin{align} wage=\\beta_0+\\gamma_1educ+\\gamma_2educ\\times Male+u \\tag{7.8} \\end{align}\\] 男性的教育回报率大于女性的教育回报率 &lt;=&gt; \\(\\gamma_2&gt;0\\)。 换一种表述：教育回报率的大小依赖于性别，为刻画这一点，在自变量已包含educ之外，再加入educ与性别指标Male的乘积。一般地，怀疑x对y的影响依赖于z，为刻画这一异质性，在自变量中加入x与z的乘积，即使用如下的计量模型： \\[\\begin{align} y=\\beta_0+\\gamma_1x+\\gamma_2x\\times z+u \\tag{7.9} \\end{align}\\] \\(\\gamma_2\\)的含义：z增加1单位，将使x的系数增加\\(\\gamma_2\\)。如果\\(\\gamma_2&gt;0\\)，那么更大的z增大了x对y的因果影响。Q：举一式(7.9)适用的例子，说明y、x和z分别表示什么，解释x对y的影响依赖于z的逻辑。 "],["cons.html", "第 8 章 一致性", " 第 8 章 一致性 见伍德里奇《计量经济学导论：现代观点》第五版第136-139页。 补充：无偏性意味着估计量在平均意义上能够反映因果关系（无论n的大小），而一致性意味着估计量在n足够大/渐进意义上能够反映因果关系。 "],["panel.html", "第 9 章 面板数据模型：计量方法及应用 9.1 第一节", " 第 9 章 面板数据模型：计量方法及应用 123 9.1 第一节 123 内容待添加 "],["did.html", "第 10 章 基于面板数据的双重差分法：计量方法及应用 10.1 第一节", " 第 10 章 基于面板数据的双重差分法：计量方法及应用 123 10.1 第一节 123 "],["iv.html", "第 11 章 工具变量法：计量方法及应用 11.1 第一节", " 第 11 章 工具变量法：计量方法及应用 123 11.1 第一节 123 "],["sciwri.html", "第 12 章 科学写作 12.1 第一节", " 第 12 章 科学写作 123 12.1 第一节 123 "],["exp.html", "第 13 章 专题：政府支出 13.1 第一节", " 第 13 章 专题：政府支出 123 13.1 第一节 123 "],["rev.html", "第 14 章 专题：政府收入 14.1 第一节", " 第 14 章 专题：政府收入 123 14.1 第一节 123 "],["intgovt.html", "第 15 章 专题：政府间关系（含模糊断点回归） 15.1 第一节", " 第 15 章 专题：政府间关系（含模糊断点回归） 123 15.1 第一节 123 "],["oth.html", "第 16 章 其他财税问题 16.1 第一节", " 第 16 章 其他财税问题 123 16.1 第一节 123 "],["references.html", "参考文献", " 参考文献 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
