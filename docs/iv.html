<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 12 章 工具变量法：计量方法及应用 | 公共经济学中的计量方法及应用</title>
  <meta name="description" content="第 12 章 工具变量法：计量方法及应用 | 公共经济学中的计量方法及应用" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="第 12 章 工具变量法：计量方法及应用 | 公共经济学中的计量方法及应用" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="yihui/bookdown-chinese" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 12 章 工具变量法：计量方法及应用 | 公共经济学中的计量方法及应用" />
  
  
  

<meta name="author" content="叶兵" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="did.html"/>
<link rel="next" href="exp.html"/>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">公共经济学中的计量方法及应用</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>序言</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> 导论</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#intro-corr"><i class="fa fa-check"></i><b>1.1</b> 相关和因果关系</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#intro-esti"><i class="fa fa-check"></i><b>1.2</b> 估计总体均值</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#intro-nature"><i class="fa fa-check"></i><b>1.3</b> 计量经济学的性质与经济数据</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#intro-math"><i class="fa fa-check"></i><b>1.4</b> 数学知识复习</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="blr.html"><a href="blr.html"><i class="fa fa-check"></i><b>2</b> 二元线性回归</a>
<ul>
<li class="chapter" data-level="2.1" data-path="blr.html"><a href="blr.html#blr-sec1"><i class="fa fa-check"></i><b>2.1</b> 二元线性回归模型的定义</a></li>
<li class="chapter" data-level="2.2" data-path="blr.html"><a href="blr.html#blr-sec2"><i class="fa fa-check"></i><b>2.2</b> 普通最小二乘法的推导</a></li>
<li class="chapter" data-level="2.3" data-path="blr.html"><a href="blr.html#blr-sec3"><i class="fa fa-check"></i><b>2.3</b> OLS估计量的期望和方差</a></li>
<li class="chapter" data-level="2.4" data-path="blr.html"><a href="blr.html#blr-sec4"><i class="fa fa-check"></i><b>2.4</b> 函数形式</a></li>
<li class="chapter" data-level="2.5" data-path="blr.html"><a href="blr.html#blr-sec5"><i class="fa fa-check"></i><b>2.5</b> 最小二乘法：再考察</a></li>
<li class="chapter" data-level="2.6" data-path="blr.html"><a href="blr.html#blr-sec6"><i class="fa fa-check"></i><b>2.6</b> 零条件均值假设：成立吗？</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mlr.html"><a href="mlr.html"><i class="fa fa-check"></i><b>3</b> 多元线性回归：估计</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mlr.html"><a href="mlr.html#mlr-sec1"><i class="fa fa-check"></i><b>3.1</b> 使用多元线性回归模型的动因</a></li>
<li class="chapter" data-level="3.2" data-path="mlr.html"><a href="mlr.html#mlr-sec2"><i class="fa fa-check"></i><b>3.2</b> 多元线性回归模型的定义</a></li>
<li class="chapter" data-level="3.3" data-path="mlr.html"><a href="mlr.html#mlr-sec3"><i class="fa fa-check"></i><b>3.3</b> OLS法的操作和解释</a></li>
<li class="chapter" data-level="3.4" data-path="mlr.html"><a href="mlr.html#mlr-sec4"><i class="fa fa-check"></i><b>3.4</b> OLS估计量的期望</a></li>
<li class="chapter" data-level="3.5" data-path="mlr.html"><a href="mlr.html#mlr-sec5"><i class="fa fa-check"></i><b>3.5</b> OLS估计量的方差</a></li>
<li class="chapter" data-level="3.6" data-path="mlr.html"><a href="mlr.html#mlr-sec6"><i class="fa fa-check"></i><b>3.6</b> OLS估计量的有效性</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mlrinf.html"><a href="mlrinf.html"><i class="fa fa-check"></i><b>4</b> 多元线性回归：统计推断</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mlrinf.html"><a href="mlrinf.html#mlrinf-sec1"><i class="fa fa-check"></i><b>4.1</b> 引例</a></li>
<li class="chapter" data-level="4.2" data-path="mlrinf.html"><a href="mlrinf.html#mlrinf-sec2"><i class="fa fa-check"></i><b>4.2</b> OLS估计量的抽样分布</a></li>
<li class="chapter" data-level="4.3" data-path="mlrinf.html"><a href="mlrinf.html#mlrinf-sec3"><i class="fa fa-check"></i><b>4.3</b> 检验对单个总体参数的假设</a></li>
<li class="chapter" data-level="4.4" data-path="mlrinf.html"><a href="mlrinf.html#mlrinf-sec4"><i class="fa fa-check"></i><b>4.4</b> 多元回归能解决遗漏变量问题吗？</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dummy.html"><a href="dummy.html"><i class="fa fa-check"></i><b>5</b> 定性信息</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dummy.html"><a href="dummy.html#dummy-sec1"><i class="fa fa-check"></i><b>5.1</b> 二值变量</a></li>
<li class="chapter" data-level="5.2" data-path="dummy.html"><a href="dummy.html#dummy-sec2"><i class="fa fa-check"></i><b>5.2</b> 虚拟变量陷阱</a></li>
<li class="chapter" data-level="5.3" data-path="dummy.html"><a href="dummy.html#dummy-sec3"><i class="fa fa-check"></i><b>5.3</b> 分类、基准和虚拟变量</a></li>
<li class="chapter" data-level="5.4" data-path="dummy.html"><a href="dummy.html#dummy-sec4"><i class="fa fa-check"></i><b>5.4</b> 多个虚拟变量</a></li>
<li class="chapter" data-level="5.5" data-path="dummy.html"><a href="dummy.html#dummy-sec5"><i class="fa fa-check"></i><b>5.5</b> 更多例子</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="srdd.html"><a href="srdd.html"><i class="fa fa-check"></i><b>6</b> 清晰断点回归</a>
<ul>
<li class="chapter" data-level="6.1" data-path="srdd.html"><a href="srdd.html#srdd-sec1"><i class="fa fa-check"></i><b>6.1</b> 思路</a></li>
<li class="chapter" data-level="6.2" data-path="srdd.html"><a href="srdd.html#srdd-sec2"><i class="fa fa-check"></i><b>6.2</b> 估计</a></li>
<li class="chapter" data-level="6.3" data-path="srdd.html"><a href="srdd.html#srdd-sec3"><i class="fa fa-check"></i><b>6.3</b> 应用</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mech.html"><a href="mech.html"><i class="fa fa-check"></i><b>7</b> 机制和异质性分析</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mech.html"><a href="mech.html#mech-sec1"><i class="fa fa-check"></i><b>7.1</b> 机制分析</a></li>
<li class="chapter" data-level="7.2" data-path="mech.html"><a href="mech.html#mech-sec2"><i class="fa fa-check"></i><b>7.2</b> 异质性分析</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cons.html"><a href="cons.html"><i class="fa fa-check"></i><b>8</b> 一致性</a></li>
<li class="chapter" data-level="9" data-path="misspe.html"><a href="misspe.html"><i class="fa fa-check"></i><b>9</b> 模型误设</a>
<ul>
<li class="chapter" data-level="9.1" data-path="misspe.html"><a href="misspe.html#misspe-sec1"><i class="fa fa-check"></i><b>9.1</b> 遗漏相关变量</a></li>
<li class="chapter" data-level="9.2" data-path="misspe.html"><a href="misspe.html#misspe-sec2"><i class="fa fa-check"></i><b>9.2</b> 包含无关变量</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="panel.html"><a href="panel.html"><i class="fa fa-check"></i><b>10</b> 面板数据模型：计量方法及应用</a>
<ul>
<li class="chapter" data-level="10.1" data-path="panel.html"><a href="panel.html#panel-sec1"><i class="fa fa-check"></i><b>10.1</b> 面板数据的定义</a></li>
<li class="chapter" data-level="10.2" data-path="panel.html"><a href="panel.html#panel-sec2"><i class="fa fa-check"></i><b>10.2</b> 差分法</a></li>
<li class="chapter" data-level="10.3" data-path="panel.html"><a href="panel.html#panel-sec3"><i class="fa fa-check"></i><b>10.3</b> 去均值法</a></li>
<li class="chapter" data-level="10.4" data-path="panel.html"><a href="panel.html#panel-sec4"><i class="fa fa-check"></i><b>10.4</b> 固定效应模型</a></li>
<li class="chapter" data-level="10.5" data-path="panel.html"><a href="panel.html#panel-sec5"><i class="fa fa-check"></i><b>10.5</b> LSDV法</a></li>
<li class="chapter" data-level="10.6" data-path="panel.html"><a href="panel.html#panel-sec6"><i class="fa fa-check"></i><b>10.6</b> 时间固定效应</a></li>
<li class="chapter" data-level="10.7" data-path="panel.html"><a href="panel.html#panel-sec7"><i class="fa fa-check"></i><b>10.7</b> 应用：财政联邦主义的文献</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="did.html"><a href="did.html"><i class="fa fa-check"></i><b>11</b> 基于面板数据的双重差分法：计量方法及应用</a>
<ul>
<li class="chapter" data-level="11.1" data-path="did.html"><a href="did.html#did-sec1"><i class="fa fa-check"></i><b>11.1</b> 双重差分法的思路</a></li>
<li class="chapter" data-level="11.2" data-path="did.html"><a href="did.html#did-sec2"><i class="fa fa-check"></i><b>11.2</b> 政策一次性实施</a></li>
<li class="chapter" data-level="11.3" data-path="did.html"><a href="did.html#did-sec3"><i class="fa fa-check"></i><b>11.3</b> 政策分多轮推进</a></li>
<li class="chapter" data-level="11.4" data-path="did.html"><a href="did.html#did-sec4"><i class="fa fa-check"></i><b>11.4</b> 外生事件</a></li>
<li class="chapter" data-level="11.5" data-path="did.html"><a href="did.html#did-sec5"><i class="fa fa-check"></i><b>11.5</b> 基于处理强度的双重差分法</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="iv.html"><a href="iv.html"><i class="fa fa-check"></i><b>12</b> 工具变量法：计量方法及应用</a>
<ul>
<li class="chapter" data-level="12.1" data-path="iv.html"><a href="iv.html#iv-sec1"><i class="fa fa-check"></i><b>12.1</b> 何谓“剥离”？</a></li>
<li class="chapter" data-level="12.2" data-path="iv.html"><a href="iv.html#iv-sec2"><i class="fa fa-check"></i><b>12.2</b> 二元情形</a></li>
<li class="chapter" data-level="12.3" data-path="iv.html"><a href="iv.html#iv-sec3"><i class="fa fa-check"></i><b>12.3</b> 多元情形</a></li>
<li class="chapter" data-level="12.4" data-path="iv.html"><a href="iv.html#iv-sec4"><i class="fa fa-check"></i><b>12.4</b> 判断备选变量是否是合格的工具变量</a></li>
<li class="chapter" data-level="12.5" data-path="iv.html"><a href="iv.html#iv-sec5"><i class="fa fa-check"></i><b>12.5</b> 寻找工具变量：利用内生变量变异的外生来源</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="exp.html"><a href="exp.html"><i class="fa fa-check"></i><b>13</b> 专题：政府支出</a>
<ul>
<li class="chapter" data-level="13.1" data-path="exp.html"><a href="exp.html#exp-sec1"><i class="fa fa-check"></i><b>13.1</b> Government multiplier</a></li>
<li class="chapter" data-level="13.2" data-path="exp.html"><a href="exp.html#exp-sec2"><i class="fa fa-check"></i><b>13.2</b> Social insurance</a></li>
<li class="chapter" data-level="13.3" data-path="exp.html"><a href="exp.html#exp-sec3"><i class="fa fa-check"></i><b>13.3</b> Benefit incidence</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rev.html"><a href="rev.html"><i class="fa fa-check"></i><b>14</b> 专题：政府收入</a>
<ul>
<li class="chapter" data-level="14.1" data-path="rev.html"><a href="rev.html#rev-sec1"><i class="fa fa-check"></i><b>14.1</b> Short-term tax policy</a></li>
<li class="chapter" data-level="14.2" data-path="rev.html"><a href="rev.html#rev-sec2"><i class="fa fa-check"></i><b>14.2</b> Tax regime</a></li>
<li class="chapter" data-level="14.3" data-path="rev.html"><a href="rev.html#rev-sec3"><i class="fa fa-check"></i><b>14.3</b> Tax incidence</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="intgovt.html"><a href="intgovt.html"><i class="fa fa-check"></i><b>15</b> 专题：政府间关系（含模糊断点回归）</a>
<ul>
<li class="chapter" data-level="15.1" data-path="intgovt.html"><a href="intgovt.html#intgovt-sec1"><i class="fa fa-check"></i><b>15.1</b> Intergovernmental transfers</a></li>
<li class="chapter" data-level="15.2" data-path="intgovt.html"><a href="intgovt.html#intgovt-sec2"><i class="fa fa-check"></i><b>15.2</b> Place-based policy</a></li>
<li class="chapter" data-level="15.3" data-path="intgovt.html"><a href="intgovt.html#intgovt-sec3"><i class="fa fa-check"></i><b>15.3</b> Unfunded mandate</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="oth.html"><a href="oth.html"><i class="fa fa-check"></i><b>16</b> 其他公共经济学问题</a>
<ul>
<li class="chapter" data-level="16.1" data-path="oth.html"><a href="oth.html#oth-sec1"><i class="fa fa-check"></i><b>16.1</b> Public choice</a></li>
<li class="chapter" data-level="16.2" data-path="oth.html"><a href="oth.html#oth-sec2"><i class="fa fa-check"></i><b>16.2</b> Environmental regulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="附录.html"><a href="附录.html"><i class="fa fa-check"></i>附录</a>
<ul>
<li class="chapter" data-level="" data-path="附录.html"><a href="附录.html#附录1双重差分法共同趋势假设检验及动态效应分析"><i class="fa fa-check"></i>附录1：双重差分法：共同趋势假设检验及动态效应分析</a></li>
<li class="chapter" data-level="" data-path="附录.html"><a href="附录.html#附录2双重差分法的估计量无偏吗"><i class="fa fa-check"></i>附录2：双重差分法的估计量无偏吗？</a></li>
<li class="chapter" data-level="" data-path="附录.html"><a href="附录.html#附录3stata操作指引"><i class="fa fa-check"></i>附录3：Stata操作指引</a></li>
<li class="chapter" data-level="" data-path="附录.html"><a href="附录.html#附录4科学写作"><i class="fa fa-check"></i>附录4：科学写作</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">利用bookdown编写</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">公共经济学中的计量方法及应用</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="iv" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">第 12 章</span> 工具变量法：计量方法及应用<a href="iv.html#iv" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>在<a href="blr.html#blr-sec6">2.6</a>中，我们说明了对于简单回归——<span class="math inline">\(y=\alpha+\beta x\)</span>，遗漏变量和反向因果会导致：<span class="math inline">\(Cov(x,u)\neq0\)</span>，即x是内生变变量。这会导致<span class="math inline">\(\beta\)</span>的OLS估计量:(1)是有偏的，因为<span class="math inline">\(Cov(x,u)\neq0 \Rightarrow E[u|x]\neq0\)</span>；（2）是不一致的。</p>
<p>怎么办？如果我们遇到的是遗漏变量问题，我们可以尝试将可能的遗漏变量并加入回归。比如，在估计教育回报率的例子中，我们尝试将度量IQ并加入到回归中。这是多元回归模型。有的时候，可能造成问题的遗漏因素不好测量，但如果知道它不随时间变化的话，可以通过加入个体固定效应的形式将之加到回归里。这是固定效应模型。比如，在研究啤酒税对交通事故死亡率的影响时，为处理不变的酒驾社会接受度的可能影响，我们在模型中加入州固定效应。这些操作的实质是在保持这些遗漏因素不变的前提下开展研究。如不确定，请回忆多元回归和固定效应模型中系数的含义。</p>
<p>这一办法的局限：（1）当一个遗漏因素难以度量且随时间变化时，这一办法不适用；（2）这一办法处理不了反向因果问题。这一章要介绍的工具变量回归能克服这些局限，处理遗漏变量问题和反向因果问题。其处理问题的思路是”剥离”。</p>
<div id="iv-sec1" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> 何谓“剥离”？<a href="iv.html#iv-sec1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>比如，你昨天买了一根香蕉，今早起来发现香蕉的顶部1/4变黑了，其余3/4色泽如初。你会怎么办？有钱的话，你可以把它扔了，再买一根。也有可能，你把变黑的1/4切下来扔掉，吃掉其余3/4。也就是说，你把香蕉分成两部分：变黑的1/4和其余3/4。你认为，前一部分是有问题的部分，故而切掉扔弃。经过这一剥离之后，余下3/4没有问题，可以放心食用。</p>
<p>由此可见，剥离的思路其实我们非常熟悉了。还有一些别的例子。比如，把高考答卷的名字部分密封起来。这一做法有很长的历史，至少宋代科举就这样做了，当时称作“糊名”。明代举子杨慎参加进士考试，通过糊名可以把他分成两部分：学识部分的杨慎（写出了：滚滚长江东逝水，浪花淘尽英雄…）和身份部分的杨慎（首辅大臣的儿子）；并且，剥离掉可能引起问题的身份部分的杨慎，仅以学识部分的杨慎去应试。</p>
</div>
<div id="iv-sec2" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> 二元情形<a href="iv.html#iv-sec2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>考虑如下的简单回归模型：<span class="math inline">\(y=\beta_0+\beta_1x+u, Cov(x,u)\neq 0\)</span>。从而x是一个内生变量。</p>
<p><strong><em>x的分解已知</em></strong></p>
<p>假设我们能对x做如下分解：<span class="math inline">\(x=x_1+x_2\)</span>，满足：</p>
<ul>
<li><span class="math inline">\(Cov(x_1,u)=0\)</span>，即<span class="math inline">\(x_1\)</span>与u不相关；</li>
<li><span class="math inline">\(Cov(x_2,u)≠0\)</span>，即<span class="math inline">\(x_2\)</span>与u相关；</li>
<li><span class="math inline">\(Cov(x_1,x_2)=0\)</span>，即<span class="math inline">\(x_1\)</span>与<span class="math inline">\(x_2\)</span>相关。</li>
</ul>
<p>对照上面的例子，<span class="math inline">\(x_2\)</span>相当于香蕉变黑的1/4，是有问题的部分。<span class="math inline">\(x_1\)</span>相当于其余3/4，是无问题的部分。参照上一节的思路，剥离有问题的<span class="math inline">\(x_2\)</span>：<span class="math inline">\(y=\beta_0+\beta_1x_1+(\beta_1x_2+u)=\beta_0+\beta_1x_1+ε\)</span>。 这里，我们将<span class="math inline">\(x_2\)</span>扔到干扰项中，<span class="math inline">\(\beta_1x_2+u\)</span>合在一起，视之为一个新的干扰项，记为<span class="math inline">\(\epsilon\)</span>。计量模型由此转化为：<span class="math inline">\(y=\beta_0+\beta_1x_1+ε\)</span>。现在的问题是：在转化后的模型中，<span class="math inline">\(x_1\)</span>和<span class="math inline">\(\epsilon\)</span>不相关吗？</p>
<p><span class="math display">\[
Cov(x_1,\epsilon)=Cov(x_1,\beta_1x_2+u)=\beta_1Cov(x_1,x_2)+Cov(x_1,u)=0+0=0
\]</span></p>
<p>因此，在转化后的模型中，<span class="math inline">\(x_1\)</span>是外生变量，其OLS估计量是一致的。用y对<span class="math inline">\(x_1\)</span>回归即可得到<span class="math inline">\(\beta_1\)</span>的一个一致估计量。</p>
<p><strong><em>x的分解未知</em></strong></p>
<p>以上假设可以把x分解成<span class="math inline">\(x_1+x_2\)</span>，且分解满足上述三个性质。但问题是，怎么分解？</p>
<p>我们需要更多的信息。假设有一变量z, 满足:</p>
<ul>
<li><span class="math inline">\(Cov(z, x)\neq 0\)</span>；</li>
<li><span class="math inline">\(Cov(z, u)=0\)</span>。</li>
</ul>
<p>即z与x相关，但与u无关——它是一个与x相关的外生变量。</p>
<p>Q：基于这一信息，该如何分解?[提示：回忆<a href="blr.html#blr">2</a>的内容]</p>
<p>A：用x对z进行回归：<span class="math inline">\(x=(\delta_0+\delta_1z)+\eta\)</span>。注意，回归不要求存在因果关系（见简单回归一章）。由于<span class="math inline">\(Cov(z, x)\neq 0\)</span>，因此，<span class="math inline">\(\delta_1≠0\)</span>。验证：<span class="math inline">\(Cov(\delta_0+\delta_1z, u)=0,Cov(\delta_0+\delta_1z,\eta)=0\)</span>（如不清楚第二个等式缘何成立，回顾<a href="blr.html#blr">2</a>的内容）。因此，定义：<span class="math inline">\(x_1\equiv \delta_0+\delta_1z, x_2\equiv \eta\)</span>。这样的分解满足上述三个条件。</p>
<p>估计程序分为两阶段：</p>
<ul>
<li>第一阶段，用x对z回归，得到<span class="math inline">\(\hat{\delta_0}\)</span>和<span class="math inline">\(\hat{\delta_1}\)</span>，进而构建<span class="math inline">\(x_1\)</span>：<span class="math inline">\(x_1\equiv \hat{\delta_0}+\hat{\delta_1}z\)</span>，也就是拟合值；</li>
<li>第二阶段，用y对<span class="math inline">\(x_1\)</span>回归。</li>
</ul>
<p>经此程序，我们得到<span class="math inline">\(\beta_1\)</span>的一个一致估计量。在每一阶段，都使用最小二乘法，用了两次，故称为两阶段最小二乘法（2SLS method）。</p>
<p>理解:在第一阶段，利用z，剥离掉x中内生的部分(that is problematic)，仅余x外生的部分(that is problem-free)。第二阶段，用y对x外生的部分回归。z是一个剥离用的工具，称之为工具变量（Instrument variable，简称IV）。</p>
</div>
<div id="iv-sec3" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> 多元情形<a href="iv.html#iv-sec3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>一般，我们遇到的情形是，模型中有多个解释变量：<span class="math inline">\(y = \beta_0 + \beta_1x + \beta_2w_1 +... + \beta_{k+1}w_k +u\)</span>。x是核心解释变量，<span class="math inline">\(w_1,...,w_k\)</span>是控制变量。假设<span class="math inline">\(Cov(x,u)≠0, Cov(w_1,u)=0, ..., Cov(w_k,u)=0\)</span>，即x是内生变量，控制变量是外生变量。</p>
<p>假设有一组变量<span class="math inline">\(z_1, ..., z_m\)</span>, 满足:</p>
<ul>
<li>Instrument exogeneity：<span class="math inline">\(Cov(z_i,u)=0\)</span> for i=1, …, m，即<span class="math inline">\(z_1, ..., z_m\)</span>是外生变量；</li>
<li>Instrument relevance：在x对<span class="math inline">\(w_1, ..., w_k, z_1, ..., z_m\)</span>的总体回归中, <span class="math inline">\(z_1, ..., z_m\)</span>的系数不为0, 即保持<span class="math inline">\(w_1, ..., w_k\)</span>不变, <span class="math inline">\(z_1, ..., z_m\)</span>对预测x有帮助。</li>
</ul>
<p>第一个性质是上一节变量z性质1的重复。第二个条件上一节变量z性质2有所变化。回顾上一节变量z性质2：<span class="math inline">\(Cov(z, x)\neq 0 \Leftrightarrow \delta_1≠0\ (x=\delta_0+\delta_1z+\eta)\)</span>；即z对于预测x是有帮助的。这里的区别是在回归中加入了控制变量。保持<span class="math inline">\(w_1, ..., w_k\)</span>不变，<span class="math inline">\(z_1, ..., z_m\)</span>对预测x有帮助，用统计学的语言讲，就是说，<span class="math inline">\(z_1, ..., z_m\)</span>与x偏相关。</p>
<p>称满足这两个条件的变量为工具变量。</p>
<p>利用这些工具变量，进行两阶段最小二乘回归：</p>
<ul>
<li>第一阶段，用OLS法估计<span class="math inline">\(x=\delta_0+\delta_1w_1+...+\delta_kw_k+\delta_{k+1}z_1+...+\delta_{k+m}z_m+η\)</span>, 记拟合值为<span class="math inline">\(x_1\)</span>；</li>
<li>第二阶段，用OLS法估计<span class="math inline">\(y=\beta_0+\beta_1x_1+\beta_2w_1+...+\beta_{k+1}w_k+ε\)</span>。</li>
</ul>
<p>注意第一阶段中也加入了控制变量，第二阶段只是把原模型的x替换为<span class="math inline">\(x_1\)</span>。</p>
<p>命题：<span class="math inline">\(\beta_1\)</span>的2SLS估计量依概率收敛于总体参数(一致性)。</p>
<p>证明：仿照上一节，证明第二阶段中所有自变量都是外生变量即可。试予验证。从中可以明了为什么第一阶段需要将控制变量加入回归。</p>
<p>在Stata中，可以使用regress命令先后进行第一阶段和第二阶段回归。Stata也提供了一个命令自动完成这一系列过程（假设m=1，k=3）：</p>
<p><font color=red>ivregress 2sls y (x1=z1) w1 w2 w3</font></p>
</div>
<div id="iv-sec4" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> 判断备选变量是否是合格的工具变量<a href="iv.html#iv-sec4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>以上假定满足以上性质地<span class="math inline">\(z_1, …, z_m\)</span>给定。在此前提下，我们可以利用2SLS法一致地估计总体参数<span class="math inline">\(\beta_1\)</span>。问题在于，这样的变量需要我们自己寻找。实际中的步骤是，我们找到一些备选变量，验证这些备选变量是否满足上述两个性质。若满足，它们就是合格的工具变量；反之，则须另觅变量。</p>
<p>假设只找到一个备选变量v，下面说明如何判断此种情形下v是否满足工具变量的两个性质。</p>
<p>验证v满足Instrument relevance：（1）说明v与x相关的逻辑，即说明为什么你认为v应该与x相关？（2）进行统计检验，即按照这一性质的定义，估计以下回归模型：<span class="math inline">\(x=\delta_0+\delta_1w_1+...+\delta_kw_k+\delta_{k+1}v+η\)</span>。v的系数应显著不等于0，且其符号与上述v与x相关的逻辑一致。</p>
<p>验证v满足Instrument exogeneity：列举原来的回归（非第二阶段回归）模型中干扰项u包含的因素，要求这些因素不包含v（如包含v，意味着v直接影响因变量，自不能作为工具变量），且有理由相信这些因素与v无关（如果有理由相信某个因素与v相关，则v不是合格的工具变量）。</p>
<p>工具变量通常难找，因此，提出多个备选变量的情况少见，不予讨论。</p>
<p>具体如何做，我们通过一个例子说明，这个例子援引自斯托克和沃森（2012）第12.1.5节。</p>
<blockquote>
<p>例：研究美国各州香烟的需求函数：<span class="math inline">\(Ln(Q_i)=\alpha+\beta Ln(P_i)+u_i\)</span>。其中，i表示州，Q表示香烟销量，P表示香烟价格。该模型存在反向因果：一方面，价格影响需求量（需求函数）。另一方面，由于市场出清时需求量就等于供给量，供给量也会影响价格（供给函数）。存在反向因果意味着，<span class="math inline">\(Ln(P_i)\)</span>是内生变量。需要寻找工具变量。现提出如下的备选变量：<span class="math inline">\(SalesTax_i\)</span>，表示对每包香烟征收的销售税, 由州政府设定，各州不一。<br>
<br>
检验Instrument relevance是否成立：（1）从逻辑上讲，供给方会把部分会全部销售税转嫁给消费者，导致香烟销售税和价格正相关；（2）用<span class="math inline">\(Ln(P_i)\)</span>对<span class="math inline">\(SalesTax_i\)</span>回归，<span class="math inline">\(SalesTax_i\)</span>的估计系数为0.031（标准误为0.005），即显著异于0，且符号与逻辑一致。<br>
<br>
检验Instrument exogeneity是否成立：<span class="math inline">\(u_i\)</span>中不包含<span class="math inline">\(SalesTax_i\)</span>，即后者不直接影响价格。但<span class="math inline">\(u_i\)</span>中包含人均收入。一般来说，人均收入越高，对健康生活方式的需求越大，对香烟的需求越小。同时，人均收入高的州政府可能更多地依靠个人所得税筹资，而非销售税筹资，人均收入与销售税之间存在负相关。由于人均收入是u的组成部分，有理由认为u和销售税是相关的，Instrument exogeneity不成立。说明：只需要从u中找出任一个因素与销售税相关，即可否定Instrument exogeneity；而要说服他人相信Instrument exogeneity成立，则需要列出干扰项中包含的尽可能多的因素，说明这些因素与内生变量不相关的理由。<br>
<br>
由于Instrument exogeneity不成立，<span class="math inline">\(SalesTax_i\)</span>不是一个合格的工具变量。</p>
</blockquote>
<p>这个例子透露出，寻找工具变量并不是一件容易的事。这并不是说工具变量的寻找无迹可寻。存在一些寻找工具变量的套路。接下来介绍一个常用的套路。</p>
</div>
<div id="iv-sec5" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> 寻找工具变量：利用内生变量变异的外生来源<a href="iv.html#iv-sec5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>所谓内生变量变异是指不同的观测值内生变量取到不尽相同的值。为什么有的观测值内生变量取值大，而有的观测值内生变量取值小？有很多原因。我们尝试追踪内生变量变异的外生来源，即与因变量的决定因素无关的来源。基于这样的外生来源，分离出内生变量变异中的外生部分。这样做的前提是，我们对内生变量变异的来源有充分的认知，这通常要求我们对相关的背景有充分的了解。以下介绍循此思路的两个经典范例。</p>
<p><strong><em>Hoxby（2000）</em></strong></p>
<p>Hoxby（2000）基于美国横截面数据，研究：Does Competition among Public Schools Benefit Students and Taxpayers？</p>
<p>美国业务教育阶段公立学校上学采取租售同权原则，即一个学区内的租户也有权上该学区的公立学校。租房的成本相对较低，因此，学生及其家庭能够以较低的成本在学区间流动，导致学区间面临着的争夺生源的竞争。生源竞争的激烈程度依不同都市区而有不同。本文考虑的问题是，一个都市区内学区间的竞争能否提高效率，使得学生和纳税人受益？</p>
<p>计量模型如下：</p>
<div class="figure"><span style="display:block;" id="fig:chap12fig1"></span>
<img src="figs/chap12-fig1.png" alt="Econometric model in Hoxby (2000)"  />
<p class="caption">
图 12.1: Econometric model in Hoxby (2000)
</p>
</div>
<p>其中，i index individual students and their associated households. k index school districts, and let m index educational markets (i.e., metropolitan areas in this paper)。<span class="math inline">\(C_m\)</span> measure how much Tiebout choice exists in educational market m (e.g., the number of districts per student in the metropolitan area)。简单说，它度量都市区内学区间竞争程度。最直接的一个度量指标是，生均学区数。因变量为反映公立学校绩效的指标。</p>
<p>由于担心可能遗漏了一些因素，这些因素与<span class="math inline">\(C_m\)</span>相关，导致<span class="math inline">\(C_m\)</span>为内生变量，作者使用了如下的工具变量：number of streams-that reflect the number of natural school district boundaries in a metropolitan area。作者陈述使用这一工具变量的理由如下：</p>
<p>Instrument relevance：</p>
<blockquote>
<p>The logic is that in the eighteenth and nineteenth centuries, when school district boundaries were initially set in America, an important consideration was students’ travel time to school. Natural barriers could significantly increase travel time. With automobiles, buses, paved roads, bridges, and flood controls, many of the barriers that would have caused students to travel miles out of their way are now hardly noticed. Yet, the vestigial importance of natural barriers is preserved because they determined initial school-district boundaries, which are the key supply-side factor that determines today’s boundaries. Thus, the number of school districts in a given land area at a given time of settlement was an increasing function of the number of natural barriers. I focus on streams, because they are the most common and most easily quantified natural barriers.</p>
</blockquote>
<p>文中这一段阐述了streams影响学区划分的逻辑。作者继续进行了第一阶段回归：因变量为<span class="math inline">\(C_m\)</span>，自变量为number of larger streams in metropolitan area、number of smaller streams in metropolitan area和控制变量。结果显示，number of larger streams in metropolitan area、number of smaller streams in metropolitan area的系数均显著为正（见文中表2），与所述逻辑一致。</p>
<p>Instrument exogeneity：</p>
<blockquote>
<p>What about the second condition for valid instrumental variables-that streams are exogenous to school productivity? The condition is highly plausible.</p>
</blockquote>
<p>对此作者未给出明确的解释。我们尝试把外生性的逻辑补全。首先，number of streams不会直接影响到公立学校的绩效如学生成绩，这一点当是合理的。然后，得说明number of streams跟其他影响学生成绩的指标不相关。想一想，有的同学家住在南京市区，从家驱车来校，途中你不会注意经过了多少条溪流？除非你喜欢钓鱼。也就是说，在你的观念里，溪流不会影响到我们的学习、工作以及商业活动等——溪流跟学习、工作以及商业活动不相关。既如此，它跟学生成绩也应不相关。</p>
<p>第二阶段回归的结果表明，学区间竞争越大，公立学校学生12年级阅读分数越高（见文中表3），per-pupil spending越小，share of students in private school越小（见文中表5），12年级阅读分数与log(per-pupil spending)的比值越大（见文中表7）。因此，学区间竞争提高了公立学校的效率。</p>
<p>在这篇文章中，学区间竞争程度的变异有很多来源。作者基于对学区制度的了解，追踪到地理信息这一学区间竞争程度变异的外生来源。基于这一外生来源分离学区间竞争程度的外生部分，从而识别其对公立学校绩效的因果影响。</p>
<p><strong><em>Acemoglu et al.（2001）</em></strong></p>
<p><a href="did.html#did-sec5">11.5</a>提供了人力资本积累促进经济增长的经验证据。Acemoglu et al.（2001）研究制度对经济发展的影响。</p>
<p>其计量模型如下:</p>
<p><span class="math display">\[
logy_i=\mu+\alpha R_i+X_i^{&#39;}\gamma+\epsilon_i
\]</span>
符号的含义:</p>
<ul>
<li>i指国家；</li>
<li><span class="math inline">\(y_i\)</span>是人均收入指标，具体指log GDP per capita in 1995或log output per worker in 1988；</li>
<li><span class="math inline">\(R_i\)</span> is the protection against expropriation measure，具体指average protection against expropriation risk during 1985-1995，即产权保护程度指标，反映制度水平；</li>
<li><span class="math inline">\(X_i\)</span> is a vector of other covariates；</li>
<li><span class="math inline">\(\epsilon_i\)</span> is a random error term.</li>
</ul>
<p>作者关注前被殖民的国家。这些国家的制度水平<span class="math inline">\(R_i\)</span>可能是内生变量。作者用工具变量法处理内生性。国家制度水平由很多因素决定，作者尝试从历史中寻找制度水平差异的外生来源。作者提出使用如下的工具变量:
Log European Mortality Settler，即19世纪初在殖民地定居的欧洲殖民者的死亡率的对数。</p>
<p>验证Instrument relevance：（1）逻辑上，“Europeans adopted very different colonization policies in different colonies, with different associated institutions. In places where Europeans faced high mortality rates, they could not settle and were more likely to set up extractive institutions. These institutions persisted to the present”；（2）如图<a href="iv.html#fig:chap12fig2">12.2</a>的Panel B所示，第一阶段回归的结果显示，此变量显著为负，与上述逻辑一致。</p>
<p>验证Instrument exogeneity：由于医疗卫生条件的飞速进步，两百年前致死的疟疾、黄热等病菌现在已不足为患，不会影响今日的经济绩效。</p>
<p>第二阶段回归的结果见图<a href="iv.html#fig:chap12fig2">12.2</a>的Panel A。前8列的因变量为log GDP per capita in 1995。第9列的因变量为log output per worker in 1988。在各列中，average protection against expropriation risk during 1985-1995的系数均显著为正，表明良好的产权保护促进了经济发展。</p>
<div class="figure"><span style="display:block;" id="fig:chap12fig2"></span>
<img src="figs/chap12-fig2.png" alt="Effect of institutions on economic performance"  />
<p class="caption">
图 12.2: Effect of institutions on economic performance
</p>
</div>
<p>资料来源：Acemoglu et al.（2001）表4。</p>
<p><strong>斯托克和沃森（2012）第12章对工具变量有更为详尽且的介绍，包括工具变量法的发明，请自行阅读。</strong></p>
<p><strong>参考文献</strong></p>
<ul>
<li>斯托克, 沃森. 计量经济学导论(第三版)[M]. 中国人民大学出版社, 2014, 第12章.</li>
<li>Acemoglu D, Johnson S, Robinson J A. The colonial origins of comparative development: An empirical investigation[J]. American economic review, 2001, 91(5): 1369-1401.</li>
<li>Hoxby C M. Does competition among public schools benefit students and taxpayers?[J]. American Economic Review, 2000, 90(5): 1209-1238.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="did.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exp.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-chinese/edit/master/012-iv.Rmd",
"text": "编辑"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
