<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 2 章 二元线性回归 | 财税计量应用讲义</title>
  <meta name="description" content="一个简单的中文书示例。" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="第 2 章 二元线性回归 | 财税计量应用讲义" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="一个简单的中文书示例。" />
  <meta name="github-repo" content="yihui/bookdown-chinese" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 2 章 二元线性回归 | 财税计量应用讲义" />
  
  <meta name="twitter:description" content="一个简单的中文书示例。" />
  

<meta name="author" content="叶兵" />


<meta name="date" content="2022-09-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="mlr.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">财税计量应用讲义</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>序言</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> 导论</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#intro-corr"><i class="fa fa-check"></i><b>1.1</b> 相关和因果关系</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#intro-esti"><i class="fa fa-check"></i><b>1.2</b> 估计总体均值</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#intro-nature"><i class="fa fa-check"></i><b>1.3</b> 计量经济学的性质与经济数据</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#intro-math"><i class="fa fa-check"></i><b>1.4</b> 数学知识复习</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="blr.html"><a href="blr.html"><i class="fa fa-check"></i><b>2</b> 二元线性回归</a>
<ul>
<li class="chapter" data-level="2.1" data-path="blr.html"><a href="blr.html#blr-sec1"><i class="fa fa-check"></i><b>2.1</b> 二元线性回归模型的定义</a></li>
<li class="chapter" data-level="2.2" data-path="blr.html"><a href="blr.html#blr-sec2"><i class="fa fa-check"></i><b>2.2</b> 普通最小二乘法的推导</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mlr.html"><a href="mlr.html"><i class="fa fa-check"></i><b>3</b> 多元线性回归：估计</a>
<ul>
<li class="chapter" data-level="3.1" data-path="mlr.html"><a href="mlr.html#mlr-sec1"><i class="fa fa-check"></i><b>3.1</b> 使用多元线性回归模型的动因</a></li>
<li class="chapter" data-level="3.2" data-path="mlr.html"><a href="mlr.html#mlr-sec2"><i class="fa fa-check"></i><b>3.2</b> 多元线性回归模型的定义</a></li>
<li class="chapter" data-level="3.3" data-path="mlr.html"><a href="mlr.html#mlr-sec3"><i class="fa fa-check"></i><b>3.3</b> OLS法的操作和解释</a></li>
<li class="chapter" data-level="3.4" data-path="mlr.html"><a href="mlr.html#mlr-sec4"><i class="fa fa-check"></i><b>3.4</b> OLS估计量的期望</a></li>
<li class="chapter" data-level="3.5" data-path="mlr.html"><a href="mlr.html#mlr-sec5"><i class="fa fa-check"></i><b>3.5</b> OLS估计量的方差</a></li>
<li class="chapter" data-level="3.6" data-path="mlr.html"><a href="mlr.html#mlr-sec6"><i class="fa fa-check"></i><b>3.6</b> OLS估计量的有效性</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mlrinf.html"><a href="mlrinf.html"><i class="fa fa-check"></i><b>4</b> 多元线性回归：统计推断</a>
<ul>
<li class="chapter" data-level="4.1" data-path="mlrinf.html"><a href="mlrinf.html#mlrinf-sec1"><i class="fa fa-check"></i><b>4.1</b> 引例</a></li>
<li class="chapter" data-level="4.2" data-path="mlrinf.html"><a href="mlrinf.html#mlrinf-sec2"><i class="fa fa-check"></i><b>4.2</b> OLS估计量的抽样分布</a></li>
<li class="chapter" data-level="4.3" data-path="mlrinf.html"><a href="mlrinf.html#mlrinf-sec3"><i class="fa fa-check"></i><b>4.3</b> 检验对单个总体参数的假设</a></li>
<li class="chapter" data-level="4.4" data-path="mlrinf.html"><a href="mlrinf.html#mlrinf-sec4"><i class="fa fa-check"></i><b>4.4</b> 多元回归能解决遗漏变量问题吗？</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dummy.html"><a href="dummy.html"><i class="fa fa-check"></i><b>5</b> 定性信息</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dummy.html"><a href="dummy.html#dummy-sec1"><i class="fa fa-check"></i><b>5.1</b> 二值变量</a></li>
<li class="chapter" data-level="5.2" data-path="dummy.html"><a href="dummy.html#dummy-sec2"><i class="fa fa-check"></i><b>5.2</b> 虚拟变量陷阱</a></li>
<li class="chapter" data-level="5.3" data-path="dummy.html"><a href="dummy.html#dummy-sec3"><i class="fa fa-check"></i><b>5.3</b> 分类、基准和虚拟变量</a></li>
<li class="chapter" data-level="5.4" data-path="dummy.html"><a href="dummy.html#dummy-sec4"><i class="fa fa-check"></i><b>5.4</b> 多个虚拟变量</a></li>
<li class="chapter" data-level="5.5" data-path="dummy.html"><a href="dummy.html#dummy-sec5"><i class="fa fa-check"></i><b>5.5</b> 更多例子</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="srdd.html"><a href="srdd.html"><i class="fa fa-check"></i><b>6</b> 清晰断点回归</a>
<ul>
<li class="chapter" data-level="6.1" data-path="srdd.html"><a href="srdd.html#srdd-sec1"><i class="fa fa-check"></i><b>6.1</b> 思路</a></li>
<li class="chapter" data-level="6.2" data-path="srdd.html"><a href="srdd.html#srdd-sec2"><i class="fa fa-check"></i><b>6.2</b> 估计</a></li>
<li class="chapter" data-level="6.3" data-path="srdd.html"><a href="srdd.html#srdd-sec3"><i class="fa fa-check"></i><b>6.3</b> 应用</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mech.html"><a href="mech.html"><i class="fa fa-check"></i><b>7</b> 机制和异质性分析</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mech.html"><a href="mech.html#mech-sec1"><i class="fa fa-check"></i><b>7.1</b> 机制分析</a></li>
<li class="chapter" data-level="7.2" data-path="mech.html"><a href="mech.html#mech-sec2"><i class="fa fa-check"></i><b>7.2</b> 异质性分析</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="cons.html"><a href="cons.html"><i class="fa fa-check"></i><b>8</b> 一致性</a></li>
<li class="chapter" data-level="9" data-path="misspe.html"><a href="misspe.html"><i class="fa fa-check"></i><b>9</b> 模型误设</a>
<ul>
<li class="chapter" data-level="9.1" data-path="misspe.html"><a href="misspe.html#misspe-sec1"><i class="fa fa-check"></i><b>9.1</b> 遗漏相关变量</a></li>
<li class="chapter" data-level="9.2" data-path="misspe.html"><a href="misspe.html#misspe-sec2"><i class="fa fa-check"></i><b>9.2</b> 包含无关变量</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="panel.html"><a href="panel.html"><i class="fa fa-check"></i><b>10</b> 面板数据模型：计量方法及应用</a>
<ul>
<li class="chapter" data-level="10.1" data-path="panel.html"><a href="panel.html#panel-sec1"><i class="fa fa-check"></i><b>10.1</b> 面板数据的定义</a></li>
<li class="chapter" data-level="10.2" data-path="panel.html"><a href="panel.html#panel-sec2"><i class="fa fa-check"></i><b>10.2</b> 差分法</a></li>
<li class="chapter" data-level="10.3" data-path="panel.html"><a href="panel.html#panel-sec3"><i class="fa fa-check"></i><b>10.3</b> 去均值法</a></li>
<li class="chapter" data-level="10.4" data-path="panel.html"><a href="panel.html#panel-sec4"><i class="fa fa-check"></i><b>10.4</b> 固定效应模型</a></li>
<li class="chapter" data-level="10.5" data-path="panel.html"><a href="panel.html#panel-sec5"><i class="fa fa-check"></i><b>10.5</b> LSDV法</a></li>
<li class="chapter" data-level="10.6" data-path="panel.html"><a href="panel.html#panel-sec6"><i class="fa fa-check"></i><b>10.6</b> 时间固定效应</a></li>
<li class="chapter" data-level="10.7" data-path="panel.html"><a href="panel.html#panel-sec7"><i class="fa fa-check"></i><b>10.7</b> 应用：财政联邦主义的文献</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="did.html"><a href="did.html"><i class="fa fa-check"></i><b>11</b> 基于面板数据的双重差分法：计量方法及应用</a>
<ul>
<li class="chapter" data-level="11.1" data-path="did.html"><a href="did.html#did-sec1"><i class="fa fa-check"></i><b>11.1</b> 双重差分法的思路</a></li>
<li class="chapter" data-level="11.2" data-path="did.html"><a href="did.html#did-sec2"><i class="fa fa-check"></i><b>11.2</b> 政策一次性实施</a></li>
<li class="chapter" data-level="11.3" data-path="did.html"><a href="did.html#did-sec3"><i class="fa fa-check"></i><b>11.3</b> 政策分多轮推进</a></li>
<li class="chapter" data-level="11.4" data-path="did.html"><a href="did.html#did-sec4"><i class="fa fa-check"></i><b>11.4</b> 外生事件</a></li>
<li class="chapter" data-level="11.5" data-path="did.html"><a href="did.html#did-sec5"><i class="fa fa-check"></i><b>11.5</b> 基于处理强度的双重差分法</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="iv.html"><a href="iv.html"><i class="fa fa-check"></i><b>12</b> 工具变量法：计量方法及应用</a>
<ul>
<li class="chapter" data-level="12.1" data-path="iv.html"><a href="iv.html#iv-sec1"><i class="fa fa-check"></i><b>12.1</b> 第一节</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="exp.html"><a href="exp.html"><i class="fa fa-check"></i><b>13</b> 专题：政府支出</a>
<ul>
<li class="chapter" data-level="13.1" data-path="exp.html"><a href="exp.html#exp-sec1"><i class="fa fa-check"></i><b>13.1</b> 第一节</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="rev.html"><a href="rev.html"><i class="fa fa-check"></i><b>14</b> 专题：政府收入</a>
<ul>
<li class="chapter" data-level="14.1" data-path="rev.html"><a href="rev.html#rev-sec1"><i class="fa fa-check"></i><b>14.1</b> 第一节</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="intgovt.html"><a href="intgovt.html"><i class="fa fa-check"></i><b>15</b> 专题：政府间关系（含模糊断点回归）</a>
<ul>
<li class="chapter" data-level="15.1" data-path="intgovt.html"><a href="intgovt.html#intgovt-sec1"><i class="fa fa-check"></i><b>15.1</b> 第一节</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="oth.html"><a href="oth.html"><i class="fa fa-check"></i><b>16</b> 其他财税问题</a>
<ul>
<li class="chapter" data-level="16.1" data-path="oth.html"><a href="oth.html#oth-sec1"><i class="fa fa-check"></i><b>16.1</b> 第一节</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="附录.html"><a href="附录.html"><i class="fa fa-check"></i>附录</a>
<ul>
<li class="chapter" data-level="" data-path="附录.html"><a href="附录.html#科学写作"><i class="fa fa-check"></i>科学写作</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书藉由bookdown编撰</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">财税计量应用讲义</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="blr" class="section level1" number="2">
<h1><span class="header-section-number">第 2 章</span> 二元线性回归</h1>
<div id="blr-sec1" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> 二元线性回归模型的定义</h2>
<p>见伍德里奇《计量经济学导论：现代观点》第五版第2.1节。</p>
</div>
<div id="blr-sec2" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> 普通最小二乘法的推导</h2>
<p><strong>最小二乘（OLS）法的直观理解</strong></p>
<p>从总体中随机抽取N个观测值。记号：{<span class="math inline">\(((x_i,y_i):i=1,...,N)\)</span>}。</p>
<p>画散点图。横轴表示受教育程度，纵轴表示工资。呈正向关系。</p>
<p>问题：基于这些数据，估计总体参数。之前，我们估计的总体参数只有总体均值一个；这里，有两个待估计的总体参数：<span class="math inline">\(\beta_0\)</span>和<span class="math inline">\(\beta_1\)</span>。怎么估计<span class="math inline">\(\beta_0\)</span>和<span class="math inline">\(\beta_1\)</span>？</p>
<p>记<span class="math inline">\(\beta_0\)</span>的估计量为<span class="math inline">\(\hat{\beta_0}\)</span>，<span class="math inline">\(\beta_1\)</span>的估计量记为<span class="math inline">\(\hat{\beta_1}\)</span>。如果确定了<span class="math inline">\(\hat{\beta_0}\)</span>和<span class="math inline">\(\hat{\beta_1}\)</span>，就可以确定一条直线：为<span class="math inline">\(y=\hat{\beta_0}+\hat{\beta_1}x\)</span>。<span class="math inline">\(\hat{\beta_0}\)</span>和<span class="math inline">\(\hat{\beta_1}\)</span>变化，直线也跟着变化。反过来，直线确定了，<span class="math inline">\(\hat{\beta_0}\)</span>和<span class="math inline">\(\hat{\beta_1}\)</span>也确定了。即：<span class="math inline">\({\hat{\beta_0},\hat{\beta_1}}\)</span>与直线是一一对应的关系。那么，确定<span class="math inline">\(\hat{\beta_0}\)</span>和<span class="math inline">\(\hat{\beta_1}\)</span>，等价于找直线为<span class="math inline">\(y=\hat{\beta_0}+\hat{\beta_1}x\)</span>。</p>
<p>问题：直线有无限条，需要我们找出其中一条，它在某种意义上是最优的。直观上，该怎么去找？</p>
<div class="figure"><span style="display:block;" id="fig:chap2fig1"></span>
<img src="figs/chap2-fig1.png" alt="wage and education" width="50%" height="50%" />
<p class="caption">
图 2.1: wage and education
</p>
</div>
<p>回忆：估计总体均值时，我们选择距观测值m（对应观测点）最近的数（对应一条水平线y=m），或者说选择距观测点最近的水平线。</p>
<p>类比：找一条离观测点最近的直线。但这里不必是一条水平线，可以是任意走向的直线。</p>
<p>严格地，定义一条给定的直线到各观测点的距离。一种（不是唯一的）定义距离的方法：如图<a href="blr.html#fig:chap2fig2">2.2</a>，三个观测点<span class="math inline">\((x_1,y_1),(x_2,y_2),(x_3,y_3)\)</span>，一条给定的直线<span class="math inline">\(y =\hat{\beta_0}+\hat{\beta_1}x\)</span>，做一条从点1出发的垂直线段，与该直线相交，定义该线段的平方为点1到该直线的距离。数学表达：<span class="math inline">\((y_1- \hat{\beta_0}-\hat{\beta_1}x_1)^2\)</span>。注意，<span class="math inline">\(y_1-\hat{\beta_0}-\hat{\beta_1}x\)</span>可能为负，求其平方，保证得到一个正数。类似可求其他点到该直线的距离。总距离为：</p>
<p><span class="math display" id="eq:2-1">\[\begin{align}
(y_1 - \hat{\beta_0} - \hat{\beta_1}x_1)^2 + (y_2 - \hat{\beta_0} - \hat{\beta_1}x_2)^2 +(y_3 - \hat{\beta_0} - \hat{\beta_1}x_3)^2 \tag{2.1}
\end{align}\]</span></p>
<p>选择直线与观测点的总距离最小，或者说选择<span class="math inline">\(\hat{\beta_0}\)</span>和<span class="math inline">\(\hat{\beta_1}\)</span>使得总距离最小：</p>
<p><span class="math display" id="eq:2-2">\[\begin{align}
Min_{\hat{\beta_0},\hat{\beta_1}} (y_1 - \hat{\beta_0} - \hat{\beta_1}x_1)^2 +(y_3 - \hat{\beta_0} - \hat{\beta_1}x_2)^2 + (y_2 - \hat{\beta_0} - \hat{\beta_1}x_3)^2 \tag{2.2}
\end{align}\]</span></p>
<div class="figure"><span style="display:block;" id="fig:chap2fig2"></span>
<img src="figs/chap2-fig2.png" alt="Illustration of the OLS method" width="75%" height="75%" />
<p class="caption">
图 2.2: Illustration of the OLS method
</p>
</div>
<p>定义：</p>
<p><span class="math display" id="eq:2-3">\[\begin{align}
\hat{y} = \hat{\beta_0} + \hat{\beta_1}x \\
\hat{u} =  y  - \hat{y} = y  - \hat{\beta_0} - \hat{\beta_1}x \tag{2.3}
\end{align}\]</span></p>
<p><span class="math inline">\(\hat{y}\)</span>就是直线的纵坐标，称为拟合值。<span class="math inline">\(\hat{u}\)</span>是图<a href="blr.html#fig:chap2fig2">2.2</a> 中线段，在直线上方记为正，在直线下方记为负，称为残差。可以把最小化问题表述为：</p>
<p><span class="math display" id="eq:2-4">\[\begin{align}
Min_{\hat{\beta_0},\hat{\beta_1}} (y_1 - \hat{y_1})^2 +(y_2 - \hat{y_2})^2 + (y_3 - \hat{y_3})^2 = \hat{u_1}^2 +\hat{u_2}^2 + \hat{u_3}^2 \tag{2.4}
\end{align}\]</span></p>
<p><strong>OLS估计量的推导</strong></p>
<p>一般地，有N个观测值，优化问题为：</p>
<p><span class="math display" id="eq:2-5">\[\begin{align}
Min_{\hat{\beta_0},\hat{\beta_1}} \sum_{i=1}^N  (y_i - \hat{\beta_0} - \hat{\beta_1}x_i)^2 \tag{2.5}
\end{align}\]</span></p>
<p>对择<span class="math inline">\(\hat{\beta_0}\)</span>和<span class="math inline">\(\hat{\beta_1}\)</span>求偏导，得到一阶条件：</p>
<p><span class="math display" id="eq:2-6">\[\begin{align}
\sum_{i=1}^N  (y_i - \hat{\beta_0} - \hat{\beta_1}x_i) = 0 \\
\sum_{i=1}^N  (y_i - \hat{\beta_0} - \hat{\beta_1}x_i) x_i = 0 \tag{2.6}
\end{align}\]</span></p>
<p>可以推出：</p>
<p><span class="math display" id="eq:2-7">\[\begin{align}
\hat{\beta_1} = \frac{\sum_{i=1}^N (x_i-\overline{x})(y_i-\overline{y})}{(x_i-\overline{x})^2} \\
\hat{\beta_0} = \overline{y} -  \hat{\beta_1}\overline{x} \tag{2.7}
\end{align}\]</span></p>
<p>推导见伍德里奇《计量经济学导论：现代观点》第五版式(2.16)-(2.19)。</p>
<p><span class="math inline">\(\hat{\beta_1}\)</span>和<span class="math inline">\(\hat{\beta_1}\)</span>的计算公式已经给出来了。两个估计量均是观测值{<span class="math inline">\(((x_i,y_i):i=1,...,N)\)</span>}的函数。由于我们把x,y视作随机变量，随机变量的函数依然是随机变量。</p>
<p><strong>程序模拟</strong></p>
<p>写了的一个Fortran小程序。它从总体中随机抽取一个样本，包含30个观测值，每个观测值包含x和y两个取值（可以将y理解成wage，x理解成education）。</p>
<p>一次随机抽样的结果如图<a href="blr.html#fig:chap2fig3">2.3</a>。抽到的第一个观测值的y是0.4187，x是0.1616。第二个观测值的y是0.2976,x是1.3366。因为是随机抽样，第二个观测值y和x的取值不同于第一个观测值的y和x的取值。其他观测值取值如图。基于这些观测值，我们计算了<span class="math inline">\(\hat{\beta_1}\)</span>，计算结果和详细的计算过程如图<a href="blr.html#fig:chap2fig3">2.3</a>。</p>
<div class="figure"><span style="display:block;" id="fig:chap2fig3"></span>
<img src="figs/chap2-fig3.png" alt="Calculation based on a random sample" width="100%" height="100%" />
<p class="caption">
图 2.3: Calculation based on a random sample
</p>
</div>
<p>把这个过程重复500遍，即进行500次抽样。在每一次抽样中，都随机抽取30个观测值，基于这些观测值重新计算<span class="math inline">\(\hat{\beta_1}\)</span>。</p>
<p>为便于理解，列出前两次抽样的观测值：图<a href="blr.html#fig:chap2fig4">2.4</a>左边是第一次抽样的观测值，右边是第二次抽样的观测值。左右两边的观测值不一样，因是随机抽取的。既如此，基于各样本计算的<span class="math inline">\(\hat{\beta_1}\)</span>也就不一样。</p>
<div class="figure"><span style="display:block;" id="fig:chap2fig4"></span>
<img src="figs/chap2-fig4.png" alt="Two random samples" width="100%" height="100%" />
<p class="caption">
图 2.4: Two random samples
</p>
</div>
<p>图<a href="blr.html#fig:chap2fig5">2.5</a>列出了由500次抽样计算出来的500个<span class="math inline">\(\hat{\beta_1}\)</span>。图中第一列表示抽样次数，第二列表示<span class="math inline">\(\hat{\beta_1}\)</span>。可以看到，各次抽样的<span class="math inline">\(\hat{\beta_1}\)</span>均不一样，这就是为什么我们说<span class="math inline">\(\hat{\beta_1}\)</span>是一个随机变量。</p>
<div class="figure"><span style="display:block;" id="fig:chap2fig5"></span>
<img src="figs/chap2-fig5.png" alt="500 estimates (only first 40 estimates displayed)" width="50%" height="50%" />
<p class="caption">
图 2.5: 500 estimates (only first 40 estimates displayed)
</p>
</div>
<p>总结：因为x和y是随机的，每次抽样得到了x和y不一样，基于这些x和y计算出来的<span class="math inline">\(\hat{\beta_1}\)</span>不一样，故<span class="math inline">\(\hat{\beta_1}\)</span>是一个随机变量。</p>
<p><strong>例：教育回报率</strong></p>
<p>见伍德里奇《计量经济学导论：现代观点》第五版例2.4。</p>
<p><strong>一阶条件的含义</strong></p>
<p>一阶条件也可写成：</p>
<p><span class="math display" id="eq:2-8">\[\begin{align}
\sum_{i=1}^N  u_i = 0 \\
\sum_{i=1}^N  u_i x_i = 0 \tag{2.8}
\end{align}\]</span></p>
<p>含义：（1）正负偏离相抵；（2）残差与自变量不相关。Q：为什么？[提示：想想相关系数的公式]。</p>
<p>一阶条件的直观展示如图<a href="blr.html#fig:chap2fig6">2.6</a>。仍然使用伍德里奇《计量经济学导论：现代观点》第五版例2.4的数据，绘制散点图，<span class="math inline">\(\hat{u_i}\)</span>作为纵轴，education作为横轴。</p>
<p>首先看第一个一阶条件：残差有正的也有负的，图<a href="blr.html#fig:chap2fig6">2.6</a>中正负偏差相抵。再看第二个一阶条件。图<a href="blr.html#fig:chap2fig6">2.6</a>中<span class="math inline">\(\hat{u_i}\)</span>和education之间没有明显的正的线性关系的或负的线性关系，它们的相关系数为0。</p>
<div class="figure"><span style="display:block;" id="fig:chap2fig6"></span>
<img src="figs/chap2-fig6.png" alt="Calculation based on a random sample" width="75%" height="75%" />
<p class="caption">
图 2.6: Calculation based on a random sample
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mlr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-chinese/edit/master/002-blr.Rmd",
"text": "编辑"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown.pdf", "bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
